<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">
  
  <meta name="generator" content="Hexo 5.4.0">

  

  

  
    <meta name="author" content="sterne">
  

  

  

  <title>计算机网络 | Welcome -Sterne&#39;s Blog-</title>

  

  
    <link rel="shortcut icon" href="/favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/monokai.css">
  

  
<link rel="stylesheet" href="/css/style.css">

<link rel="alternate" href="/atom.xml" title="Welcome -Sterne's Blog-" type="application/atom+xml">
</head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(/img/cover.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          Welcome -Sterne&#39;s Blog-
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">Home</a></li>
        
          <li class="navbar-list-item"><a href="/links">Links</a></li>
        
          <li class="navbar-list-item"><a href="/about">About</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap">计算机网络</h1>
          <h2 class="title-sub-wrap">
            <strong>sterne</strong>
            <span>发布于</span>
            <time  class="article-date" datetime="2022-11-22T07:31:56.000Z" itemprop="datePublished">2022-11-22</time>
          </h2>
          <ul class="wrap-list dark">
  
</ul>
          <ul class="wrap-list dark">
  
    <li><a href="/tags/review/">🏷️ review</a></li>
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  
</header>

    <!-- 文章 -->

<!-- 文章内容 -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <p>-1：寄——了——，虽然寄了，但是也挺喜欢这科的（</p>
<h1 id="Chapter1-概述"><a href="#Chapter1-概述" class="headerlink" title="Chapter1.概述"></a>Chapter1.概述</h1><p>1、理解边缘网络与核心网络、理解电路交换和分组交换、面向连<br>    接的服务与无连接、客户服务器方式与对等方式的概念。</p>
<p>2、理解协议与网络体系结构；</p>
<p>3、理解分层的网络体系结构，理解协议及服务的概念；</p>
<p>4、理解数据封装与拆装的过程；</p>
<p>5、理解TCP/IP体系结构及五层体系结构；</p>
<p>6、掌握衡量网络性能的几个指标：</p>
<p>  速率、带宽、吞吐量、时延（发送时延、传播时延、排队时延、处理时延）、往返时延、时延带宽积</p>
<h2 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h2><p>计算机网络发展：</p>
<ol>
<li>第一代，面向终端的计算机通信网络，首次将计算机与通信技术结合起来</li>
<li>第二代，初级计算机网络，实现交换：数据在网络节点之间转接的过程</li>
<li>第三代，</li>
</ol>
<p>交换方式：电路交换，报文交换，分组交换。</p>
<h3 id="电路交换"><a href="#电路交换" class="headerlink" title="电路交换"></a>电路交换</h3><p>circuit switching</p>
<img src="net/image-20230124155050371.png" alt="image-20230124155050371" style="zoom:67%;" />

<img src="net/image-20230124155100274.png" alt="image-20230124155100274" style="zoom:67%;" />

<img src="net/image-20230124160253737.png" alt="image-20230124160253737" style="zoom:67%;" />

<h3 id="报文交换"><a href="#报文交换" class="headerlink" title="报文交换"></a>报文交换</h3><img src="net/image-20230124160551812.png" alt="image-20230124160551812" style="zoom:67%;" />

<h3 id="分组交换"><a href="#分组交换" class="headerlink" title="分组交换"></a>分组交换</h3><p>对报文交换的优化，设置长度上限变为分组</p>
<img src="net/image-20230124160639629.png" alt="image-20230124160639629" style="zoom:67%;" />

<p>分组交换优点：</p>
<ol>
<li>高效，动态分配传输带宽，对通信链路逐段占用</li>
<li>灵活，以分组为传送单位独立路由</li>
<li>迅速，不必先建立连接就能向其他主机发送分组</li>
</ol>
<p>缺点：</p>
<ol>
<li>某些分组传丢，兜圈子等等，导致分组乱序到达</li>
<li>各分组携带的首部造成一定的开销</li>
<li>可靠性较电路交换较低</li>
</ol>
<img src="net/image-20230124160951855.png" alt="image-20230124160951855" style="zoom:67%;" />



<p>比较</p>
<ul>
<li>若要连续传送大量的数据，且其传送时间远大于连接建立时间，则电路交换的传输速率较快。</li>
<li>报文交换和分组交换不需要预先分配传输带宽，在传送突发数据时可提高整个网络的信道利用率。</li>
<li>由于一个分组的长度往往远小于整个报文的长度，因此分组交换比报文交换的时延小，同时也具有更好的灵活性。</li>
</ul>
<h2 id="体系结构"><a href="#体系结构" class="headerlink" title="体系结构"></a>体系结构</h2><p>两台或多台主机之间要想传递数据、彼此理解，需要解决复杂的问题。1将复杂问题分为若干层，2并定义每层解决哪些问题，就是体系结构需要解决的两个问题。</p>
<p>网络要划分为几层、以及每层功能的解释就是网络的体系结构</p>
<p>意义在于，如果任何两台计算机遵从相同的体系结构，那么两者间一定可以实现互连，反之成立</p>
<p>协议：进行网络中数据交换而建立的规则、标准或约定，即网络协议，简称协议</p>
<img src="net/image-20230124162545436.png" alt="image-20230124162545436" style="zoom:67%;" />

<h2 id="Internet"><a href="#Internet" class="headerlink" title="Internet"></a>Internet</h2><p>互连网：局部范围互连起来的网络，internet。</p>
<p>互联网：世界上最大的计算机网络，Internet。由数量极大的各种计算机网络互连起来</p>
<h2 id="互联网的组成"><a href="#互联网的组成" class="headerlink" title="互联网的组成"></a>互联网的组成</h2><img src="net/image-20230124163912449.png" alt="image-20230124163912449" style="zoom:67%;" />

<h3 id="边缘部分"><a href="#边缘部分" class="headerlink" title="边缘部分"></a>边缘部分</h3><p>由所有连接在互联网上的主机组成，又称端系统，在功能上可能存在很大差别。这部分是用户直接使用的，用来进行通信（传送数据、音频或视频）和资源共享</p>
<p>端系统之间通信：“主机 A 和主机 B 进行通信”实际上是指：“运行在主机 A 上的某个程序和运行在主机 B 上的另一个程序进行通信”。通过传输层和应用层的程序进行通信。</p>
<p>端系统两种通信方式：</p>
<p>客户-服务器方式C/S</p>
<p>客户软件：被用户调用后运行，在打算通信时主动向远地服务器发起通信（请求服务）。因此，客户程序必须知道服务器程序的地址。不需要特殊的硬件和很复杂的操作系统。</p>
<p>服务器软件：专门用来提供某种服务的程序，可同时处理多个远地或本地客户的请求。系统启动后即自动调用并一直不断地运行着，被动地等待并接受来自各地的客户的通信请求。因此，服务器程序不需要知道客户程序的地址。一般需要强大的硬件和高级的操作系统支持。客户与服务器的通信关系建立后，通信可以是双向的，客户和服务器都可发送和接收数据。</p>
<p>对等方式P2P</p>
<p>对等连接 (peer-to-peer，简写为 P2P) 是指两个主机在通信时并不区分哪一个是服务请求方还是服务提供方。只要两个主机都运行了对等连接软件 (P2P 软件) ，它们就可以进行平等的、对等连接通信。双方都可以下载对方已经存储在硬盘中的共享文档。对等连接工作方式可支持大量对等用户（如上百万个）同时工作。</p>
<h3 id="核心部分"><a href="#核心部分" class="headerlink" title="核心部分"></a>核心部分</h3><p>由大量网络和连接这些网络的路由器组成。这部分是为边缘部分提供服务的（提供连通性和交换）</p>
<p>路由器：实现分组交换，转发收到的分组，将网络互联起来。</p>
<p>计算机网络的定义：计算机网络主要是由一些通用的、可编程的硬件互连而成的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）。这些可编程的硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用。</p>
<p>根据这个定义：</p>
<p>(1) 计算机网络所连接的硬件，并不限于一般的计算机，而是包括了智能手机。</p>
<p>(2) 计算机网络并非专门用来传送数据，而是能够支持很多种的应用（包括今后可能出现的各种应用）。</p>
<h2 id="网络分类"><a href="#网络分类" class="headerlink" title="网络分类"></a>网络分类</h2><h3 id="作用范围-组网协议分类"><a href="#作用范围-组网协议分类" class="headerlink" title="作用范围/组网协议分类"></a>作用范围/组网协议分类</h3><img src="net/image-20230125112906854.png" alt="image-20230125112906854" style="zoom:67%;" />

<h3 id="网络使用者分类"><a href="#网络使用者分类" class="headerlink" title="网络使用者分类"></a>网络使用者分类</h3><p>公用网 (public network) ：按规定交纳费用的人都可以使用的网络。因此也可称为公众网。</p>
<p>专用网 (private network) ：为特殊业务工作的需要而建造的网络。</p>
<p>接入网 AN (Access Network)，它又称为本地接入网或居民接入网。</p>
<ul>
<li>接入网是一类比较特殊的计算机网络，用于将用户接入互联网。</li>
<li>接入网本身既不属于互联网的核心部分，也不属于互联网的边缘部分。</li>
<li>接入网是从某个用户端系统到互联网中的第一个路由器（也称为边缘路由器）之间的一种网络。</li>
<li>从覆盖的范围看，很多接入网还是属于局域网。</li>
<li>从作用上看，接入网只是起到让用户能够与互联网连接的“桥梁”作用。</li>
</ul>
<h2 id="网络性能指标"><a href="#网络性能指标" class="headerlink" title="网络性能指标"></a>网络性能指标</h2><h3 id="速率"><a href="#速率" class="headerlink" title="速率"></a>速率</h3><p>bit/s，单位时间内网络中的某信道所能通过的最高数据率。</p>
<h3 id="带宽"><a href="#带宽" class="headerlink" title="带宽"></a>带宽</h3><p>指信号具有的频带宽度，单位是赫。频域上的单位。</p>
<p>能够通过的最大频率是多少?</p>
<p>但是习惯上速率的定义也可以叫带宽，时域意义上。</p>
<h3 id="吞吐量"><a href="#吞吐量" class="headerlink" title="吞吐量"></a>吞吐量</h3><p>单位时间内通过某个网络（或信道、接口）的数据量。一般单位也是bit/s</p>
<h3 id="时延"><a href="#时延" class="headerlink" title="时延"></a>时延</h3><p>数据从一端传送到另一端所需的时间。是如下四种的和。</p>
<h4 id="发送时延"><a href="#发送时延" class="headerlink" title="发送时延"></a>发送时延</h4><p>通常为主要时延</p>
<p>也称传输时延，发送数据时，数据帧从节点接入到传输媒体所需要的时间。</p>
<p>从发送数据帧的第一个比特算起，到该帧的最后一个比特发送完毕所需的时间。</p>
<img src="net/image-20230126105320044.png" alt="image-20230126105320044" style="zoom:67%;" />

<h4 id="传播时延"><a href="#传播时延" class="headerlink" title="传播时延"></a>传播时延</h4><p>电磁波在信道中需要传播一定的距离而花费的时间。普通网络中可忽略不计，卫星中不能</p>
<img src="net/image-20230126105837163.png" alt="image-20230126105837163" style="zoom:67%;" />

<h4 id="处理时延"><a href="#处理时延" class="headerlink" title="处理时延"></a>处理时延</h4><p>主机或路由器在收到分组时，为处理分组（例如分析首部、提取数据、差错检验或查找路由）所花费的时间。</p>
<h4 id="排队时延"><a href="#排队时延" class="headerlink" title="排队时延"></a>排队时延</h4><p>分组在路由器输入输出队列中排队等待处理所经历的时延。排队时延的长短往往取决于网络中当时的通信量。</p>
<p>处理时延&amp;排队时延太长，数据拥堵，易丢包/超时，应当提升路由器性能。</p>
<img src="net/image-20230126110738204.png" alt="image-20230126110738204" style="zoom:67%;" />

<img src="net/image-20230126110833231.png" alt="image-20230126110833231" style="zoom:67%;" />

<h3 id="时延带宽积"><a href="#时延带宽积" class="headerlink" title="时延带宽积"></a>时延带宽积</h3><p>你是？</p>
<p>链路的时延带宽积又称为以比特为单位的链路长度</p>
<img src="net/image-20230126110930715.png" alt="image-20230126110930715" style="zoom:50%;" />

<h3 id="往返时间RTT"><a href="#往返时间RTT" class="headerlink" title="往返时间RTT"></a>往返时间RTT</h3><p>表示从发送方发送数据开始，到发送方收到来自接收方的确认，总共经历的时间。</p>
<p>往返时间包括各中间节点的处理时延、排队时延以及转发数据的发送时延。</p>
<h3 id="利用率"><a href="#利用率" class="headerlink" title="利用率"></a>利用率</h3><p>信道利用率并非越高越好。当某信道的利用率增大时，该信道引起的时延也就迅速增加。分以下两种</p>
<h4 id="信道利用率"><a href="#信道利用率" class="headerlink" title="信道利用率"></a>信道利用率</h4><p>指出某信道有百分之几的时间是被利用的（有数据通过）。完全空闲的信道的利用率是零。</p>
<h4 id="网络利用率"><a href="#网络利用率" class="headerlink" title="网络利用率"></a>网络利用率</h4><p>全网络的信道利用率的加权平均值。</p>
<h4 id="时延与网络利用率的关系"><a href="#时延与网络利用率的关系" class="headerlink" title="时延与网络利用率的关系"></a>时延与网络利用率的关系</h4><img src="net/image-20230126111518595.png" alt="image-20230126111518595" style="zoom: 50%;" />



<h3 id="各层主要功能"><a href="#各层主要功能" class="headerlink" title="各层主要功能"></a>各层主要功能</h3><h4 id="物理层"><a href="#物理层" class="headerlink" title="物理层"></a>物理层</h4><p>物理层的任务就是透明地传送比特流。</p>
<p>物理层所传数据的单位是比特。</p>
<p>物理层不是介质层。</p>
<h4 id="数据链路层"><a href="#数据链路层" class="headerlink" title="数据链路层"></a>数据链路层</h4><p>数据链路层的任务是在两个相邻结点间的线路上提供以帧为单位的可靠性数据传输。</p>
<p>数据链路层所传数据的单位是帧。</p>
<h4 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h4><p>网络层负责为互联网上的不同主机提供通信。</p>
<p>完成路由选择、拥塞控制和网络互连。</p>
<p>IP协议是网络互连的关键协议。</p>
<p>网络层所传数据的单位是分组/数据报。</p>
<h4 id="运输层"><a href="#运输层" class="headerlink" title="运输层"></a>运输层</h4><p>运输层的任务是负责主机中两个进程之间的通信。</p>
<p>运输层可使用面向连接的传输控制协议TCP和无连接的用户数据报协议UDP。 </p>
<p>运输层为应用层屏蔽下层的通信细节。</p>
<p>运输层所传数据的单位是数据报/报文段。</p>
<h4 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h4><p>应用层是体系结构中的最高层，直接为用户的应用进程提供服务。</p>
<p>应用层确定进程之间通信的性质以满足用户的需要（这反映在用户所产生的服务请求）。</p>
<p>应用层所传数据的单位是报文。</p>
<p>应用层协议很丰富，如：HTTP, SMTP, DNS, FTP etc.</p>
<h3 id="协议-amp-服务"><a href="#协议-amp-服务" class="headerlink" title="协议&amp;服务"></a>协议&amp;服务</h3><p>实体 (entity) 表示任何可发送或接收信息的硬件或软件进程。</p>
<p>协议（protocol）是控制两个对等实体进行通信的规则的集合。 协议的实现保证了能够向上一层提供服务。</p>
<p>服务(service)是本层的功能。</p>
<ul>
<li>协议是服务的实现。</li>
<li>本层协议，向上一层提供服务。</li>
<li>要实现本层协议，还需要使用下层所提供的服务。 </li>
</ul>
<p>本层的服务用户只能看见服务而无法看见下面的协议。即下面的协议对上面的服务用户是透明的。 </p>
<p>协议是“水平的”，即协议是控制对等实体之间通信的规则。</p>
<p>服务是“垂直的”，即服务是由下层向上层通过层间接口提供的。</p>
<p>同一系统相邻两层的实体进行交互的地方，称为服务访问点 SAP (Service Access Point)。 </p>
<p>服务访问点SAP是一个抽象的概念，它实际上就是一个逻辑接口。</p>
<p>OSI把层与层之间交换的数据的单位称为服务数据单元 SDU (Service Data Unit)。</p>
<img src="net/image-20230126115434481.png" alt="image-20230126115434481" style="zoom:67%;" />



<h1 id="Chapter2-物理层"><a href="#Chapter2-物理层" class="headerlink" title="Chapter2.物理层"></a>Chapter2.物理层</h1><p>本章要求：</p>
<ol>
<li><p>理解物理层的功能</p>
</li>
<li><p>掌握有关信道的几个基本概念</p>
</li>
<li><p>掌握信道的最高码元传输速率和极限信息传输速率</p>
</li>
<li><p>掌握物理层下面的传输媒体（双绞线、光纤）</p>
</li>
<li><p>掌握模拟传输与数字传输（几种调制方法）</p>
</li>
<li><p>掌握信道复用技术</p>
<p>频分复用、时分复用和统计时分复用、 波分复用、码分复用</p>
</li>
<li><p>了解同步光纤网 SONET 和同步数字系列 SDH</p>
</li>
<li><p>了解几种宽带接入技术：ADSL,HFC,FTTx</p>
</li>
</ol>
<h2 id="数据通信系统"><a href="#数据通信系统" class="headerlink" title="数据通信系统"></a>数据通信系统</h2><p>透明性：</p>
<ol>
<li>屏蔽掉不同传输媒体差异，使数据链路层感受不到这种差异。（物理层作用）</li>
<li>关心如何在传输媒体上传输bit流，而不关心具体的传输媒体/通信介质，不关心流的实际含义。（物理层关心的）</li>
</ol>
<p>物理层协议也叫物理层规程procedure</p>
<p>物理层的主要任务描述为确定与传输媒体的接口的一些特性：</p>
<ul>
<li>机械特性  指明接口所用接线器的形状和尺寸、引线数目和排列、固定和锁定装置等等。</li>
<li>电气特性  指明在接口电缆的各条线上出现的电压的范围。</li>
<li>功能特性  指明某条线上的某一电平的电压表示何种意义。</li>
<li>规程特性  指明对于不同功能的各种可能事件的出现顺序。 </li>
</ul>
<p>消息：语音、文字、图像…</p>
<p>数据：运送消息的实体。有意义的符号序列</p>
<p>信号：数据的电气的或电次的表现。分为：</p>
<ul>
<li>模拟信号：所代表消息的参数取值是连续的，例如语音（电话网络）</li>
<li>数字信号：所代表消息的参数取值是离散的，计算机中</li>
</ul>
<p>基带信号/基本频带信号：来自信源的信号。含有较多的低频部分，甚至直流成分。</p>
<p>调制：信号波形的变换，编码的过程</p>
<ul>
<li>基带调制：仅对基带信号的波形进行变换，把数字信号转换为另一种形式的<strong>数字信号</strong>。把这种过程称为编码 (coding)。</li>
<li>带通调制：使用载波 (carrier)进行调制，把基带信号的频率范围搬移到较高的频段，并转换为<strong>模拟信号</strong>。经过载波调制后的信号称为带通信号（即仅在一段频率范围内能够通过信道）。</li>
<li>脉冲编码调制：模拟信号-&gt;数字信号</li>
</ul>
<img src="net/image-20230126170242918.png" alt="image-20230126170242918" style="zoom:67%;" />

<p>信道：自信源到信宿之间传递信号的路径。一般指表示向某一个方向传送信息的媒体。信道是一个逻辑概念，不同于物理链路。1-2之间传递信息，可以有多条信道，同时传递信息。</p>
<p>单向通信（单工通信）：只能有一个方向的通信而没有反方向的交互。</p>
<p>双向交替通信（半双工通信）：通信的双方都可以发送信息，但<strong>不能双方同时</strong>发送(当然也就不能同时接收)。</p>
<p>双向同时通信（全双工通信）：通信的双方可以<strong>同时</strong>发送和接收信息。</p>
<p>码元(code)：在使用时间域（或简称为时域）的波形表示数字信号时，代表不同离散数值的基本波形。</p>
<p>码元传送速率（波特率）：单位时间内通过信道的波形数。单位：波特Baud (1 波特为每秒传送 1 个码元)。</p>
<img src="net/image-20230126173547324.png" alt="image-20230126173547324" style="zoom:67%;" />

<img src="net/image-20230126174338180.png" alt="image-20230126174338180" style="zoom:67%;" />



<p>提高数据率：提高k或B</p>
<h2 id="数据编码方法"><a href="#数据编码方法" class="headerlink" title="数据编码方法"></a>数据编码方法</h2><h3 id="1基带调制"><a href="#1基带调制" class="headerlink" title="1基带调制"></a>1基带调制</h3><h4 id="1-1不归零制"><a href="#1-1不归零制" class="headerlink" title="1.1不归零制"></a>1.1不归零制</h4><img src="net/image-20230127095639153.png" alt="image-20230127095639153" style="zoom:67%;" />

<h4 id="1-2归零制"><a href="#1-2归零制" class="headerlink" title="1.2归零制"></a>1.2归零制</h4><img src="net/image-20230127095844486.png" alt="image-20230127095844486" style="zoom: 67%;" />

<h4 id="1-3曼彻斯特编码"><a href="#1-3曼彻斯特编码" class="headerlink" title="1.3曼彻斯特编码"></a>1.3曼彻斯特编码</h4><img src="net/image-20230127095855416.png" alt="image-20230127095855416" style="zoom:67%;" />

<h4 id="1-4差分曼彻斯特编码"><a href="#1-4差分曼彻斯特编码" class="headerlink" title="1.4差分曼彻斯特编码"></a>1.4差分曼彻斯特编码</h4><img src="net/image-20230127095904073.png" alt="image-20230127095904073" style="zoom:67%;" />

<p>从信号波形中可以看出，曼彻斯特编码和差分曼彻斯特编码产生的信号频率比不归零制高。</p>
<p>从自同步能力来看，不归零制不能从信号波形本身中提取信号时钟频率（没有自同步能力），而曼彻斯特编码和差分曼彻斯特编码具有自同步能力。</p>
<h3 id="2带通调制"><a href="#2带通调制" class="headerlink" title="2带通调制"></a>2带通调制</h3><p>对选取的载波信号进行波形改变</p>
<img src="net/image-20230127144223587.png" alt="image-20230127144223587" style="zoom:67%;" />

<p>调幅(AM)：载波的振幅随基带数字信号而变化。 A</p>
<p>调频(FM)：载波的频率随基带数字信号而变化。ω</p>
<p>调相(PM)：载波的初始相位随基带数字信号而变化。φ </p>
<p>多相调制：同时改变相位、振幅或频率中的两个参数，形成多种波形，携带多位信息，提高数据率。</p>
<p>正交调制QAM</p>
<img src="net/image-20230127144954768.png" alt="image-20230127144954768" style="zoom:67%;" />

<p>不是码元越多越好。每个码元携带的比特数越多，则在接收端进行解调时要正确识别每一种状态就越困难，出错率增加。码元携带的比特数k的提升是有上限的。</p>
<h2 id="信道"><a href="#信道" class="headerlink" title="信道"></a>信道</h2><p>任何实际的信道都不是理想的，都不可能以任意高的速率进行传送。</p>
<p>码元传输的速率越高，或信号传输的距离越远，或噪声干扰越大，或传输媒体质量越差，在接收端的波形的失真就越严重。</p>
<img src="/2022/11/22/net/image-20230127145058560.png" class="" title="image-20230127145058560">

<h3 id="频率范围"><a href="#频率范围" class="headerlink" title="频率范围"></a>频率范围</h3><p>具体的信道所能通过的频率范围总是有限的。信号中的许多高频分量往往不能通过信道。</p>
<p>码间串扰：信号中的高频分量传输时受到衰减，接收端收到的波形的前沿和后沿不那么陡峭，每个码元所占的时间界限不再清晰明显，而是前后拖着“尾巴”，有一定的拖延，使得原本清晰的一串码元变得模糊而无法识别。</p>
<p>码间串扰与信道带宽有关，越宽，串扰越少；越窄，串扰越大。</p>
<h3 id="信噪比"><a href="#信噪比" class="headerlink" title="信噪比"></a>信噪比</h3><p>信号功率和噪音功率的比值。</p>
<h4 id="奈奎斯特准则"><a href="#奈奎斯特准则" class="headerlink" title="奈奎斯特准则"></a>奈奎斯特准则</h4><p>码元传输的最高速率=2W（码元/s）</p>
<p>在带宽为W（Hz）的低通信道中，若不考虑噪声影响，码元传输速率最高是2W。</p>
<p>适用条件：</p>
<ul>
<li>理想信道，不考虑任何噪声和干扰</li>
<li>低通信道，最低0Hz，最高W Hz。</li>
</ul>
<p>说明：</p>
<ul>
<li>在任何信道中，码元传输的速率是有上限的，否则就会出现码间串扰的问题，使接收端对码元的判决（即识别）成为不可能。</li>
<li>如果信道的频带越宽，也就是能够通过的信号高频分量越多，那么就可以用更高的速率传送码元而不出现码间串扰。 </li>
</ul>
<p>信噪比就是信号的平均功率和噪声的平均功率之比。常记为 <em>S</em>/<em>N</em>，并用分贝 (dB) 作为度量单位。即：</p>
<p>信噪比(dB) = 10 log10(<em>S</em>/<em>N</em>)  </p>
<p>S：信号的平均功率；N：噪声平均功率</p>
<p>例如，当 <em>S</em>/<em>N</em> = 10 时，信噪比为 10 dB，而当 <em>S</em>/<em>N</em> = 1000时，信噪比为 30 dB。 </p>
<ul>
<li>噪声是随机产生的，它的瞬时值有时会很大。因此噪声会使接收端对码元的判决产生错误。</li>
<li>但噪声的影响是相对的。如果信号相对较强，那么噪声的影响就相对较小。</li>
</ul>
<h3 id="极限信息传输速率"><a href="#极限信息传输速率" class="headerlink" title="极限信息传输速率"></a>极限信息传输速率</h3><p>香农公式：1948年，香农(Shannon)用信息论的理论推导出了带宽受限且有高斯白噪声干扰的信道的极限、无差错的信息传输速率。</p>
<p>信道的极限信息传输速率 <em>C</em> 可表达为：单位bit/s</p>
<img src="net/image-20230127151840674.png" alt="image-20230127151840674" style="zoom: 67%;" />

<p><em>W</em> 为信道的带宽（以 Hz 为单位）；<em>S</em> 为信道内所传信号的平均功率；<em>N</em> 为信道内部的高斯噪声功率。 </p>
<p>表明：</p>
<ul>
<li>信道的带宽或信道中的信噪比越大，则信息的极限传输速率就越高。 </li>
<li>若信道带宽 <em>W</em> 或信噪比 <em>S</em>/<em>N</em> 没有上限（当然实际信道不可能是这样的），则信道的极限信息传输速率 <em>C</em> 也就没有上限。</li>
<li>只要信息传输速率低于信道的极限信息传输速率，就一定可以找到某种办法来实现无差错的传输。</li>
<li>实际信道上能够达到的信息传输速率要比香农的极限传输速率低不少。 </li>
</ul>
<img src="net/image-20230127152250689.png" alt="image-20230127152250689" style="zoom:67%;" />

<h2 id="物理层下面的传输媒体"><a href="#物理层下面的传输媒体" class="headerlink" title="物理层下面的传输媒体"></a>物理层下面的传输媒体</h2><p>传输媒体也称为传输介质或传输媒介，它就是数据传输系统中在发送器和接收器之间的物理通路。</p>
<p>传输媒体可分为两大类：</p>
<ul>
<li>导引型传输媒体，常称为有线媒体。电磁波被导引沿着固体媒体（铜线或光纤）传播。</li>
<li>非导引型传输媒体，常称为无线媒体，指自由空间，电磁波的传输常称为无线传输。</li>
</ul>
<img src="net/image-20230127152731240.png" alt="image-20230127152731240" style="zoom:67%;" />

<h3 id="导引型传输媒体"><a href="#导引型传输媒体" class="headerlink" title="导引型传输媒体"></a>导引型传输媒体</h3><h4 id="1双绞线"><a href="#1双绞线" class="headerlink" title="1双绞线"></a>1双绞线</h4><p>最常用的引导型传输媒体。把两根互相绝缘的铜导线并排放在一起，然后用规则的方法绞合 (twist) 起来就构成了双绞线。绞合度越高，可用的数据传输率越高。</p>
<h5 id="无屏蔽双绞线UTP"><a href="#无屏蔽双绞线UTP" class="headerlink" title="无屏蔽双绞线UTP"></a>无屏蔽双绞线UTP</h5><p>UTP：Unshielded Twisted Pair</p>
<p>无屏蔽层，价格便宜，方便，常用</p>
<h5 id="屏蔽双绞线STP"><a href="#屏蔽双绞线STP" class="headerlink" title="屏蔽双绞线STP"></a>屏蔽双绞线STP</h5><p>Shielded Twisted Pair</p>
<p>有屏蔽层，需接地，更好屏蔽电磁干扰，重、粗</p>
<img src="/2022/11/22/net/image-20230127153340015.png" class="" title="image-20230127153340015">

<img src="net/image-20230127153332197.png" alt="image-20230127153332197" style="zoom:67%;" />

<p> x/UTP：对整条双绞线电缆进行屏蔽。</p>
<p> F/UTP (F=Foiled)：表明采用铝箔屏蔽层。</p>
<p> S/UTP (S=braid Screen)：表明采用金属编织层进行屏蔽。</p>
<p> SF/UTP：表明在铝箔屏蔽层外面再加上金属编织层的屏蔽。</p>
<p> FTP 或 U/FTP：把电缆中的每一对双绞线都加上铝箔屏蔽层。U表明对整条电缆不另增加屏蔽层</p>
<p> F/FTP：在 FTP 基础上对整条电缆再加上铝箔屏蔽层。</p>
<p> S/FTP：在 FTP 基础上对整条电缆再加上金属编织层的屏蔽。</p>
<img src="net/image-20230127153509425.png" alt="image-20230127153509425" style="zoom:50%;" />

<h5 id="双绞线标准"><a href="#双绞线标准" class="headerlink" title="双绞线标准"></a>双绞线标准</h5><img src="/2022/11/22/net/image-20230127153607631.png" class="" title="image-20230127153607631">

<p>更常用568B型。B型中，12负责发送数据，36接收数据，其他是冗余，负责校验等？</p>
<p>B-B两头一样：直通线，主机—路由器/交换机</p>
<p>A-B两头不一样：交叉线，主机—主机，交换机—交换机</p>
<p>？还挺重要</p>
<img src="/2022/11/22/net/image-20230127153901515.png" class="" title="image-20230127153901515">

<h4 id="2同轴电缆"><a href="#2同轴电缆" class="headerlink" title="2同轴电缆"></a>2同轴电缆</h4><p>由内导体铜质芯线（单股实心线或多股绞合线）、绝缘层、网状编织的外导体屏蔽层（也可以是单股的）以及保护塑料外层所组成。</p>
<p>主要用于有线电视、较高速率数据传输</p>
<img src="net/image-20230127154014136.png" alt="image-20230127154014136" style="zoom:67%;" />

<p>性能评价：成本比双绞线高、易安装性比双绞线差、抗干扰性低比双绞线强，最大带宽接近1GHz</p>
<h4 id="3光纤"><a href="#3光纤" class="headerlink" title="3光纤"></a>3光纤</h4><p>光纤是光纤通信的传输媒体通过传递光脉冲来进行通信。</p>
<p>其传输带宽远远大于目前其他各种传输媒体的带宽。</p>
<p>一个完整的光传输系统：</p>
<ul>
<li>发送端：光源 （发光二极管、半导体激光器）          </li>
<li>接收端：检测器（光电二极管）</li>
</ul>
<p>工作原理：高折射率介质到低折射率介质，入射角小，折射角大，在一定角度下发生全反射，不断地全反射以传递信息。</p>
<img src="net/image-20230127154303897.png" alt="image-20230127154303897" style="zoom: 50%;" />

<img src="net/image-20230127154315331.png" alt="image-20230127154315331" style="zoom:67%;" />

<h5 id="多模光纤"><a href="#多模光纤" class="headerlink" title="多模光纤"></a>多模光纤</h5><p>只要入射角大于临界角度，可以存在多条不同角度入射的光线在一条光纤中传输。</p>
<p>光脉冲在多模光纤中传输时会逐渐展宽，造成失真，只适合于近距离传输。</p>
<img src="net/image-20230127154353407.png" alt="image-20230127154353407" style="zoom:67%;" />

<h5 id="单模光纤"><a href="#单模光纤" class="headerlink" title="单模光纤"></a>单模光纤</h5><p>将纤芯直径减小到只有一个光的波长（几个微米），可使光线一直向前传播，而不会产生多次反射。</p>
<p>制造成本较高，但衰耗较小。</p>
<p>光源要使用昂贵的半导体激光器，不能使用较便宜的发光二极管。</p>
<img src="net/image-20230127154419888.png" alt="image-20230127154419888" style="zoom:67%;" />

<img src="net/image-20230127154451893.png" alt="image-20230127154451893" style="zoom:67%;" />

<p>优点：</p>
<p>（1）通信容量非常大</p>
<p>（2）传输损耗小，中继距离长，对远距离传输特别经济。</p>
<p>（3）抗雷电和电磁干扰性能好。这在有大电流脉冲干扰的环境下尤为重要。</p>
<p>（4）无串音干扰，保密性好，也不易被窃听或截取数据。</p>
<p>（5）体积小，重量轻。</p>
<p>缺点：成本高。但目前工艺成熟，价格降低，已经普遍采用</p>
<h3 id="非导引型传输媒体"><a href="#非导引型传输媒体" class="headerlink" title="非导引型传输媒体"></a>非导引型传输媒体</h3><p>（无线介质、自由介质）不能够将信号约束在某个固定的媒体中，就是无线传输捏。主要使用微波波段</p>
<p><strong>多径效应</strong>：基站发出的信号可以经过多个障碍物的数次反射，从多条路径、按不同时间等到达接收方。多条路径的信号叠加后一般都会产生很大的失真。</p>
<p>特点：</p>
<p>(1) 微波波段频率很高，频段范围很宽，其通信信道的容量很大。</p>
<p>(2) 工业干扰和天电干扰对微波通信的危害小，微波传输质量较高。</p>
<p>(3) 与相同容量和长度的电缆载波通信比较，微波接力通信建设投资少，见效快，易于实施。</p>
<p>缺点：</p>
<p>(1) 相邻站之间必须直视（常称为视距 LOS (Line Of Sight)），不能有障碍物，存在多径效应。</p>
<p>(2) 有时会受到恶劣气候的影响。</p>
<p>(3) 与电缆通信系统比较，微波通信的隐蔽性和保密性较差。</p>
<p>(4) 对大量中继站的使用和维护要耗费较多的人力和物力。</p>
<p>卫星通信：</p>
<ol>
<li>通信容量大，通信距离远，通信比较稳定，通信费用与通信距离无关。</li>
<li>但传播时延较大：在 250~300 ms之间。</li>
<li>请注意：“卫星信道的传播时延较大”并不等于“用卫星信道传送数据的时延较大”。</li>
<li>保密性相对较差。</li>
<li>造价较高。</li>
</ol>
<h2 id="信道复用技术"><a href="#信道复用技术" class="headerlink" title="信道复用技术"></a>信道复用技术</h2><p>允许用户使用一个共享信道进行通信</p>
<h3 id="频分复用"><a href="#频分复用" class="headerlink" title="频分复用"></a>频分复用</h3><p>频率不同</p>
<p>将信道的可用频带分为若干子频带。相邻子频带之间留有临界保护频带。将不同用户的信号分别调制到这些子频带上。信道上同时传输多路信号。所有用户在同样的时间占用不同的带宽资源。频分复用适用于模拟传输。</p>
<h3 id="时分复用TDM"><a href="#时分复用TDM" class="headerlink" title="时分复用TDM"></a>时分复用TDM</h3><p>时隙，交替</p>
<p>将信道的可用时间分为若干时隙;将这些时隙平分给不同用户的信号;每路信号交替占用信道资源;所有用户在不同的时间占用同样的频带宽度;TDM 信号也称为等时 (isochronous) 信号;时分复用适用于数字传输</p>
<img src="net/image-20230127160156351.png" alt="image-20230127160156351" style="zoom:67%;" />

<p>导致信道利用率不高，有些人占地方不发信息</p>
<img src="/2022/11/22/net/image-20230127160334491.png" class="" title="image-20230127160334491">

<h3 id="统计时分复用STDM"><a href="#统计时分复用STDM" class="headerlink" title="统计时分复用STDM"></a>统计时分复用STDM</h3><p>统计时分复用 STDM 是对时分复用的一种改进。使用统计时分复用 STDM帧传送复用数据；时隙数可以不同于用户数。用户有了数据即发往集中器缓存（队列），集中器扫描缓存，将其中数据放入STDM帧，放满即可发送出去。</p>
<img src="/2022/11/22/net/image-20230127161156528.png" class="" title="image-20230127161156528">

<ul>
<li> 统计时分复用不是平均分配时隙，而是按需分配时隙，明显提高信道的利用率。</li>
<li> STDM帧的时隙中包括用户地址信息，集中器的设计为具有更多智能性，加入许多控制信息，开销增大。</li>
<li> STDM不适合于用户数据均衡且重负载的通信。</li>
<li> 统计复用又称为异步时分复用，而普通的时分复用称为同步时分复用。</li>
</ul>
<h3 id="波分复用WDM"><a href="#波分复用WDM" class="headerlink" title="波分复用WDM"></a>波分复用WDM</h3><p>光纤使用不同的波长，是光的频分复用</p>
<h3 id="码分复用CDM-码分多址CDMA"><a href="#码分复用CDM-码分多址CDMA" class="headerlink" title="码分复用CDM/码分多址CDMA"></a>码分复用CDM/码分多址CDMA</h3><p>重要，但是想找题理解一下</p>
<img src="net/image-20230128112900474.png" alt="image-20230128112900474" style="zoom:67%;" />

<img src="net/image-20230128112923064.png" alt="image-20230128112923064" style="zoom:67%;" />

<img src="net/image-20230128112932589.png" alt="image-20230128112932589" style="zoom:67%;" />



<h2 id="数字传输系统"><a href="#数字传输系统" class="headerlink" title="数字传输系统"></a>数字传输系统</h2><h3 id="脉码调制PCM"><a href="#脉码调制PCM" class="headerlink" title="脉码调制PCM"></a>脉码调制PCM</h3><img src="net/image-20230128114458412.png" alt="image-20230128114458412" style="zoom:67%;" />

<h3 id="同步光纤网SONET-amp-同步数字系列SDH"><a href="#同步光纤网SONET-amp-同步数字系列SDH" class="headerlink" title="同步光纤网SONET&amp;同步数字系列SDH"></a>同步光纤网SONET&amp;同步数字系列SDH</h3><p>各级网络时钟均来自一个精确的主时钟，以51.84Mb/s为基础，必须是其整数倍（什么战力单位）</p>
<p>后来定义SDH=3xSONET=155.52Mb/s</p>
<ul>
<li>使北美、日本、欧洲三个地区的数字传输体制在STM-1等级获得统一。</li>
<li>真正实现了数字体制的世界性标准。</li>
<li>也适用于微波和卫星传输技术体制。</li>
</ul>
<h3 id="宽带接入技术"><a href="#宽带接入技术" class="headerlink" title="宽带接入技术"></a>宽带接入技术</h3><p>分为有线宽带接入、无线宽带接入</p>
<h1 id="Chapter3-数据链路层"><a href="#Chapter3-数据链路层" class="headerlink" title="Chapter3.数据链路层"></a>Chapter3.数据链路层</h1><p>本章要求</p>
<p>一、使用点对点链路的数据链路层</p>
<ol>
<li>理解数据链路层的功能。<ol>
<li>封装成帧</li>
<li>透明传输</li>
<li>差错控制</li>
</ol>
</li>
<li>掌握循环冗余校验的方法。</li>
<li>理解PPP协议的工作原理。</li>
</ol>
<p>二、使用广播信道的数据链路层</p>
<ol>
<li>掌握CSMA/CD协议的工作原理。</li>
<li>掌握传统以太网（主要是10BASE-T）的连接方法。</li>
<li>理解MAC地址及DIX Ethernet V2 帧格式 。</li>
<li>掌握使用集线器、交换器扩展以太网的方法。</li>
<li>交换机的自学习算法和优点。</li>
<li>了解虚拟局域网和高速以太网的基本原理。</li>
</ol>
<h2 id="3-1-概述"><a href="#3-1-概述" class="headerlink" title="3.1 概述"></a>3.1 概述</h2><p>透明性；等效于本层间进行数据传递</p>
<p>使用两种类型的信道：点对点信道，广播信道。</p>
<h3 id="数据链路和帧"><a href="#数据链路和帧" class="headerlink" title="数据链路和帧"></a>数据链路和帧</h3><p>链路link：一条无源的点到点的物理线路段，中间没有任何其他的交换节点。链路是一条通路的一个组成部分。</p>
<p>数据链路data link：除了物理线路外，还必须有通信协议来控制这些数据的传输，把实现这些协议的硬件和软件加到链路上，就构成了数据链路。使用适配器（即网卡）来实现这些协议的硬件和软件。一般的适配器都包括了数据链路层和物理层这两层的功能。</p>
<p>帧：数据链路层传送单位。</p>
<h3 id="封装成帧"><a href="#封装成帧" class="headerlink" title="封装成帧"></a>封装成帧</h3><p>最大传送单元MTU：规定了所能传送的帧的<strong>数据部分</strong>长度上限。不含数据链路层帧首尾！</p>
<p>封装成帧(framing)：在一段数据的前后分别添加首部和尾部，然后就构成了一个帧。</p>
<p>帧定界：首部和尾部的作用，确定帧的界限。<strong>只有数据链路层帧有尾部</strong></p>
<img src="net/image-20230128143319529.png" alt="image-20230128143319529" style="zoom:67%;" />

<p>控制字符 SOH (Start Of Header) 放在一帧的最前面，表示帧开始。帧开始符</p>
<p>控制字符 EOT (End Of Transmission) 放在一帧的末尾，表示帧结束。帧结束符</p>
<h3 id="透明传输"><a href="#透明传输" class="headerlink" title="透明传输"></a>透明传输</h3><p>含义：无论发送什么样的比特组合的数据，这些数据都能够按照原样没有差错地通过这个数据链路层，且不会产生误解。</p>
<p>如果数据中某个字节的二进制代码恰好和SOH或EOT一样，数据链路层就会错误地找到帧边界，导致错误。因此，要避免出现与定界符相同的bit组合。</p>
<img src="net/image-20230128145324801.png" alt="image-20230128145324801" style="zoom:67%;" />

<h4 id="字节填充-字符填充"><a href="#字节填充-字符填充" class="headerlink" title="字节填充/字符填充"></a>字节填充/字符填充</h4><p>发送方在数据中出现SOH或EOT的前面，插入一个转义字符，比如ESC（0x1B）（虽然转义字符和ESC不同义，但是ESC感觉更好理解？所以下面写的ESC）</p>
<p>接收方收到后，去掉ESC。如果ESC也出现在数据当中，则在ESC前面再加一个ESC。接收方连续收到两个ESC时，删除前面的一个。</p>
<img src="net/image-20230128151253242.png" alt="image-20230128151253242" style="zoom:67%;" />

<h3 id="差错控制"><a href="#差错控制" class="headerlink" title="差错控制"></a>差错控制</h3><p>传输中可能产生比特差错，1变0,0变1（0异事件（</p>
<p>误码率BER（bit error rate）：一段时间内，传输错误的bit所占总bit的比例。与信噪比有很大关系。</p>
<p>为了保证数据传输的可靠性，在计算机网络传输数据时，必须采用各种差错检测措施。主要分两种：</p>
<ul>
<li>检错法，检出错误后丢弃重传，简单易行，适用于重传代价低，距离近的一般通信</li>
<li>纠错法，检出错误后改正错误，方法复杂，适用于重传代价高的，例如卫星通信</li>
</ul>
<p>几种校验：</p>
<ul>
<li>奇偶校验，最简单，错奇数位能检出，错偶数位不能检出</li>
<li>CRC循环冗余校验</li>
<li>还有个啥</li>
</ul>
<h4 id="循环冗余检验CRC"><a href="#循环冗余检验CRC" class="headerlink" title="循环冗余检验CRC"></a>循环冗余检验CRC</h4><p>在发送端，先把数据划分为组，假定每组 <em>k</em> 个比特。</p>
<p>假设待传送的一组数据 <em>M</em> = 101001（现在 <em>k</em> = 6）。我们在 <em>M</em> 的后面再添加供差错检测用的 <em>n</em> 位冗余码一起发送。 </p>
<img src="net/image-20230128152117137.png" alt="image-20230128152117137" style="zoom:67%;" />

<img src="net/image-20230128160623919.png" alt="image-20230128160623919" style="zoom:67%;" />

<img src="net/image-20230128160641746.png" alt="image-20230128160641746" style="zoom:67%;" />

<p>在数据后面添加上的冗余码称为帧检验序列 FCS (Frame Check Sequence)。</p>
<p>循环冗余检验 CRC 和帧检验序列 FCS并不等同。</p>
<ul>
<li>CRC 是一种常用的检错方法，而 FCS 是添加在数据后面的冗余码。</li>
<li>FCS 可以用 CRC 这种方法得出，但 CRC 并非用来获得 FCS 的唯一方法。 </li>
</ul>
<p>总而言之差不多！混用吧！</p>
<p>有差错，但是不知道具体哪里出错了，闭卷考试只出分现状</p>
<p>差错检测≠可靠传输：</p>
<ul>
<li>凡是接收的帧，都能以非常接近1的概率认为这些帧在传输过程中没有出错。</li>
<li>要做到可靠传输，还需要确认和重传机制。</li>
</ul>
<h2 id="3-2-点对点协议PPP"><a href="#3-2-点对点协议PPP" class="headerlink" title="3.2 点对点协议PPP"></a>3.2 点对点协议PPP</h2><p>使用最广泛的数据链路层协议Point to Point Protocol</p>
<p>是用户计算机和ISP进行通信时所使用的数据链路层协议。</p>
<p>PPP协议有三个组成部分：</p>
<ul>
<li>一个将 IP 数据报封装到串行链路的方法。</li>
<li>一个链路控制协议 LCP (Link Control Protocol)：用来建立、配置、测试数据链路连接，通信双方协商一些选项。协商数据链路层</li>
<li>一套网络控制协议 NCP (Network Control Protocol) ：每一个协议支持不同的网络层协议。协商网络层</li>
</ul>
<h3 id="PPP帧格式"><a href="#PPP帧格式" class="headerlink" title="PPP帧格式"></a>PPP帧格式</h3><p>PPP帧是面向字节的，所有的PPP帧都是整数字节B</p>
<img src="/2022/11/22/net/image-20230128164437482.png" class="" title="image-20230128164437482">

<p>标志字段F=0x7E，是帧定界符，首尾都有</p>
<p>地址字段A=0xFF，保留字段</p>
<p>控制字段C=0x03，保留字段</p>
<p>协议：2B</p>
<ul>
<li>协议字段=0x0021，则信息部分是IP数据报</li>
<li>0xC021，PPP链路控制数据</li>
<li>0x8021，网络控制数据</li>
</ul>
<p>FCS：CRC-16的16位冗余码</p>
<h3 id="PPP透明传输问题"><a href="#PPP透明传输问题" class="headerlink" title="PPP透明传输问题"></a>PPP透明传输问题</h3><h4 id="异步传输"><a href="#异步传输" class="headerlink" title="异步传输"></a>异步传输</h4><p>PPP 用在异步传输（？低速网使用）时，使用字符填充法。</p>
<p>将信息字段中出现的每一个 0x7E 字节转变成为 2 字节序列 (0x7D, 0x5E)。</p>
<p>若信息字段中出现一个 0x7D 的字节, 则将其转变成为 2 字节序列(0x7D, 0x5D)。</p>
<p>若信息字段中出现 ASCII 码的控制字符（即数值小于 0x20 的字符），则在该字符前面要加入一个 0x7D 字节，同时改变该字符的编码。</p>
<h4 id="同步传输"><a href="#同步传输" class="headerlink" title="同步传输"></a>同步传输</h4><p>PPP 协议用在 SONET/SDH 链路时，使用同步传输（一连串的比特连续传送）。这时 PPP 协议采用零比特填充方法来实现透明传输。</p>
<p>为避免帧定界符F=0x7E=01111110连续6个1的情况</p>
<p>在发送端，只要发现有 5 个连续 1，则立即填入一个 0。</p>
<p>接收端对帧中的比特流进行扫描。每当发现 5 个连续1时，就把这 5 个连续 1 后的一个 0 删除。</p>
<p>如果存在7个连续1，铁传错</p>
<h3 id="PPP工作状态"><a href="#PPP工作状态" class="headerlink" title="PPP工作状态"></a>PPP工作状态</h3><img src="net/image-20230128165722385.png" alt="image-20230128165722385" style="zoom:80%;" />

<p>当用户拨号接入 ISP 时，调制解调器对拨号做出确认，并建立一条物理连接。</p>
<p>PC 机向路由器发送一系列的 LCP 分组（封装成多个 PPP 帧）这些分组及其响应选择一些 PPP 参数，和进行网络层配置，NCP 给新接入的 PC机分配一个临时的 IP 地址，使 PC 机成为因特网上的一个主机。</p>
<p>通信完毕时，NCP 释放网络层连接，收回分配出去的 IP 地址。接着LCP 释放数据链路层连接；最后释放的是物理层的连接。  </p>
<h2 id="3-3-使用广播信道的数据链路层"><a href="#3-3-使用广播信道的数据链路层" class="headerlink" title="3.3 使用广播信道的数据链路层"></a>3.3 使用广播信道的数据链路层</h2><h3 id="局域网"><a href="#局域网" class="headerlink" title="局域网"></a>局域网</h3><p>特点：</p>
<ol>
<li>网络为一个单位拥有，便于管理</li>
<li>拓扑结构规整（最主要特点）</li>
<li>地理范围和站点数目均有限，一般不涉及远程通信。</li>
<li>网络速率高，传输可靠性好。</li>
</ol>
<p>局域网物理拓扑：</p>
<img src="net/image-20230128172327117.png" alt="image-20230128172327117" style="zoom:67%;" />



<p>优点：具有广播功能、便于系统扩展、提高可靠性</p>
<p>媒体共享技术</p>
<p>静态划分信道：和物理层一样，频分、时分、波分、码分</p>
<p>动态媒体接入控制（多点接入）</p>
<ul>
<li>随机接入：争用网，总线网采用，需要解决碰撞</li>
<li>受控接入：轮询网，环网采用，需考虑轮询时令牌的分配</li>
</ul>
<h3 id="数据链路层两个子层"><a href="#数据链路层两个子层" class="headerlink" title="数据链路层两个子层"></a>数据链路层两个子层</h3><p>为使数据链路层能更好地适应多种局域网标准，802 委员会就将局域网的数据链路层拆成两个子层：</p>
<p>逻辑链路控制 LLC (Logical Link Control)子层；</p>
<p>媒体接入控制 MAC (Medium Access Control)子层。</p>
<p>与接入到传输媒体有关的内容都放在 MAC子层，而 LLC 子层则与传输媒体无关，不管采用何种协议的局域网对 LLC 子层来说都是透明的。 </p>
<p>但由于时代原因，一般不考虑LLC子层</p>
<img src="net/image-20230128175651444.png" alt="image-20230128175651444" style="zoom:67%;" />

<h4 id="MAC层"><a href="#MAC层" class="headerlink" title="MAC层"></a>MAC层</h4><p>数据链路层两个子层之MAC层</p>
<p>硬件地址/物理地址/MAC地址/MAC-48/EUI-48，固化在适配器的ROM中，不会改变</p>
<h5 id="MAC帧格式"><a href="#MAC帧格式" class="headerlink" title="MAC帧格式"></a>MAC帧格式</h5><p>有两种标准DIX Ethernet V2；IEEE 802.3，这是V2的格式</p>
<img src="net/image-20230129120316894.png" alt="image-20230129120316894" style="zoom:67%;" />

<img src="net/image-20230129120514001.png" alt="image-20230129120514001" style="zoom:67%;" />

<h5 id="无效的MAC帧"><a href="#无效的MAC帧" class="headerlink" title="无效的MAC帧"></a>无效的MAC帧</h5><ul>
<li>帧的长度不是整数个字节；如17bit</li>
<li>用收到的帧检验序列 FCS 查出有差错；</li>
<li>数据字段的长度不在 46 ~ 1500 字节之间。（有效的 MAC 帧长度为 64 ~ 1518 字节之间）</li>
</ul>
<img src="net/image-20230129164859488.png" alt="image-20230129164859488" style="zoom:67%;" />









<h3 id="适配器"><a href="#适配器" class="headerlink" title="适配器"></a>适配器</h3><p>网络接口板又称为通信适配器(adapter)或网络接口卡 NIC (Network Interface Card)，或“网卡”。 </p>
<p>适配器的重要功能：</p>
<ul>
<li>进行串行/并行转换。</li>
<li>对数据进行缓存。</li>
<li>实现以太网协议。</li>
<li>在计算机的操作系统安装设备驱动程序。</li>
</ul>
<p>适配器检查MAC地址</p>
<p>适配器从网络上每收到一个 MAC 帧就首先用硬件检查 MAC 帧中的 MAC 地址.（过滤功能）如果是发往本站的帧则收下，然后再进行其他的处理。否则就将此帧丢弃，不再进行其他的处理。</p>
<p>“发往本站的帧”包括以下三种帧： </p>
<ul>
<li>单播(unicast)帧（一对一）</li>
<li>广播(broadcast)帧（一对全体）</li>
<li>多播(multicast)帧（一对多）</li>
</ul>
<p>适配器的“混杂模式”：数据全收，用于数据分析，嗅探</p>
<h3 id="总线拓扑-CSMA-CD"><a href="#总线拓扑-CSMA-CD" class="headerlink" title="总线拓扑 CSMA/CD"></a>总线拓扑 CSMA/CD</h3><p>以太网核心协议 载波侦听多路访问/冲突检测detection</p>
<p>“载波监听”是指每一个站在发送数据之前先要检测一下总线上是否有其他计算机在发送数据，如果有，则暂时不要发送数据，以免发生冲突。总线上并没有什么“载波”。因此，“载波监听”就是用电子技术检测总线上有没有其他计算机发送的数据信号。 </p>
<p>“多点接入”表示许多计算机以多点接入的方式连接在一根总线上。</p>
<p>“冲突检测”就是计算机边发送数据边检测信道上的信号电压大小。</p>
<img src="net/image-20230128180832858.png" alt="image-20230128180832858" style="zoom:67%;" />

<p>B广播方式发送，总线上的每一个工作的计算机都能检测到 B 发送的数据信号，由于只有计算机 D 的地址与数据帧首部写入的地址一致，因此只有 D 才接收这个数据帧。 其他所有的计算机（A, C 和 E）都检测到不是发送给它们的数据帧，因此就丢弃这个数据帧而不能够收下来。具有广播特性的总线上实现了一对一的通信。 </p>
<p>两个措施：无连接、尽最大努力交付。不编号，不确认，不重传</p>
<p>工作原理：</p>
<ul>
<li>站点在发送数据帧之前，先侦听总线是否忙，只有总线空闲时方可发送；</li>
<li>发送过程中边侦听边发送;</li>
<li>若出现冲突，则停止发送当前数据帧，向总线发送强化冲突的干扰串;</li>
<li>待冲突退避时间之后再侦听总线，重新发送。 </li>
</ul>
<img src="net/image-20230128181552335.png" alt="image-20230128181552335" style="zoom:67%;" />

<h4 id="1-如何冲突检测"><a href="#1-如何冲突检测" class="headerlink" title="1.如何冲突检测"></a>1.如何冲突检测</h4><p>当几个站同时在总线上发送数据时，总线上的信号电压摆动值将会增大（互相叠加）。<strong>当一个站检测到的信号电压摆动值超过一定的门限值时</strong>，就认为总线上至少有两个站同时在发送数据，表明产生了冲突。所谓“冲突”就是发生了碰撞，因此“冲突检测”也称“碰撞检测”。</p>
<ul>
<li>超过高低电平极限值</li>
<li>曼彻斯特编码下，跳变的时钟发生偏移-&gt;冲突</li>
</ul>
<h4 id="2-检测到冲突后"><a href="#2-检测到冲突后" class="headerlink" title="2.检测到冲突后"></a>2.检测到冲突后</h4><p>一旦检测到冲突，立即停止发送</p>
<p>等待？随机时间后，再次发送</p>
<h4 id="3-何时检测到冲突"><a href="#3-何时检测到冲突" class="headerlink" title="3.何时检测到冲突"></a>3.何时检测到冲突</h4><p>当某个站监听到总线是空闲时，也可能总线并非真正是空闲的。 </p>
<p>A 向 B 发出的信息，要经过一定的时间后才能传送到 B。B 若在 A 发送的信息到达 B 之前发送自己的帧(因为这时 B 的载波监听检测不到 A 所发送的信息)，则必然要在某个时间和 A 发送的帧发生冲突。</p>
<p>t：单程端到端传播时延；A-B，2t时间内若有冲突，A一定能发现</p>
<p>δ：数据发完还需要的时间</p>
<img src="net/image-20230129105200530.png" alt="image-20230129105200530" style="zoom:80%;" />



<h4 id="4-争用期"><a href="#4-争用期" class="headerlink" title="4.争用期"></a>4.争用期</h4><p>最先发送数据帧的站，在发送数据帧后至多经过时间 2t （两倍的端到端往返时延）就可知道发送的数据帧是否遭受了冲突。经过这段时间还没有检测到冲突，才能肯定这次发送不会发生冲突。</p>
<p>以太网的端到端往返时延 <strong>2t</strong> 称为<strong>争用期</strong>，或冲突窗口。或<strong>512比特时间</strong>，或<strong>64字节时间</strong></p>
<p>取 51.2 ms 为争用期的长度。</p>
<p>对于 10 Mb/s 以太网，在争用期内可发送512 bit，即 64 字节。因此，争用期的长度也表达为512比特时间。</p>
<h4 id="5-最短有效帧长"><a href="#5-最短有效帧长" class="headerlink" title="5.最短有效帧长"></a>5.最短有效帧长</h4><p>如果发生冲突，就一定是在发送的前 64 字节之内。 争用期内</p>
<p>由于一检测到冲突就立即中止发送，这时已经发送出去的数据一定小于 64 字节。 </p>
<p>以太网<strong>规定了最短有效帧长为 64 字节</strong>，凡长度小于 64 字节的帧都是由于冲突而异常中止的<strong>无效帧</strong>。</p>
<p>发送帧最短要达到64B，不足用0补齐</p>
<h4 id="6-强化冲突"><a href="#6-强化冲突" class="headerlink" title="6.强化冲突"></a>6.强化冲突</h4><p>当发送数据的站一旦发现发生了冲突时，除了立即停止发送数据外，双方都要再继续发送若干比特的人为干扰信号(jamming signal)，以便让所有用户都知道现在已经发生了冲突。 </p>
<p>强化冲突原因：设冲突点离A很远，离B很近，即B发送很少的数据后冲突，后停发，少量的叠加数据远距离传到A，可能被A忽略。A继续发送，浪费时间。</p>
<p>强化冲突的违规码长度介于32-64比特之间，不易被忽略。</p>
<h4 id="7-退避算法"><a href="#7-退避算法" class="headerlink" title="7.退避算法"></a>7.退避算法</h4><p>发生冲突的站在停止发送数据后，要推迟（退避）一个随机时间才能再发送数据。</p>
<img src="net/image-20230129110651961.png" alt="image-20230129110651961" style="zoom:67%;" />

<h4 id="8-帧间隔"><a href="#8-帧间隔" class="headerlink" title="8.帧间隔"></a>8.帧间隔</h4><p>帧间最小间隔为9.6微秒，相当于<strong>96比特时间</strong>。</p>
<p>这样做是为了使刚刚收到数据帧的站的接收缓存来得及清理，做好接收下一帧的准备。</p>
<p>若适配器检测到信道空闲（即在96比特时间内没有检測到信道上有信号），就发送这个帧。若检测到信道忙，则继续检测并等待信道转为空闲（加上96比特时间），然后发送个帧。 </p>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><p>不是全双工，只能进行半双工通信</p>
<p>每个站在发送数据后的争用期内，均存在冲突的可能性，使以太网的平均通信量远小于最高数据率。</p>
<h3 id="星形拓扑"><a href="#星形拓扑" class="headerlink" title="星形拓扑"></a>星形拓扑</h3><p>采用双绞线的星形以太网初期的最大传输速率为10Mb/s，称为10BASE-T</p>
<p>星形的中心设备为集线器</p>
<p>使用集线器的以太网<strong>在逻辑上仍是一个总线网</strong>，各工作站使用的还是 CSMA/CD 协议，并共享逻辑上的总线。</p>
<p>集线器很像一个多接口的转发器，工作在物理层。 又称盒中总线。</p>
<img src="net/image-20230129111915113.png" alt="image-20230129111915113" style="zoom:67%;" />

<p>10BASE-T使用无屏蔽双绞线。</p>
<p>每个站需要用两对双绞线，分别用于发送和接收。</p>
<p>集线器使用了大规模集成电路芯片，因此这样的硬件设备的可靠性已大大提高了。 </p>
<p>10BASE-T 的通信距离稍短，每个站到集线器的距离不超过 100 m。</p>
<h3 id="信道利用率-1"><a href="#信道利用率-1" class="headerlink" title="信道利用率"></a>信道利用率</h3><p>看ppt吧如果重要的话</p>
<h2 id="3-4-扩展的以太网"><a href="#3-4-扩展的以太网" class="headerlink" title="3.4 扩展的以太网"></a>3.4 扩展的以太网</h2><p>以太网是一种计算机局域网技术</p>
<h3 id="1在物理层扩展以太网"><a href="#1在物理层扩展以太网" class="headerlink" title="1在物理层扩展以太网"></a>1在物理层扩展以太网</h3><p>主机使用光纤和一堆光纤调制解调器连接到集线器，用集线器扩展局域网</p>
<img src="net/image-20230129170809036.png" alt="image-20230129170809036" style="zoom:67%;" />

<p>碰撞率/冲突域：网络中一个站点发出的帧会与其他站点发出的帧产生碰撞或冲突的那部分网络。碰撞域越大，发生碰撞的概率越高。</p>
<h3 id="2在数据链路层扩展以太网"><a href="#2在数据链路层扩展以太网" class="headerlink" title="2在数据链路层扩展以太网"></a>2在数据链路层扩展以太网</h3><p>更常用。早期使用网桥，现在使用以太网交换机</p>
<p>网桥：工作在数据链路层。根据 MAC 帧的目的地址对收到的帧进行转发和过滤。或者转发，或者丢弃。</p>
<p>交换机：工作在数据链路层。实质是多端口的网桥。可明显地提高以太网的性能。可以全双工。</p>
<h4 id="交换机"><a href="#交换机" class="headerlink" title="交换机"></a>交换机</h4><p>交换机的自学习功能：</p>
<img src="net/image-20230129181316326.png" alt="image-20230129181316326" style="zoom:67%;" />

<p>第一次发送数据，A-&gt;B：</p>
<ol>
<li><p>A 先向 B 发送一帧。该帧从接口 1 进入到交换机。</p>
</li>
<li><p>交换机把这个帧的源地址 A 和接口 1 写入交换表中。</p>
</li>
<li><p>交换机收到帧后，先查找交换表。没有查到应从哪个接口转发这个帧给 B，于是向除接口 1 以外的所有的接口<strong>广播</strong>这个帧。</p>
</li>
<li><p>B,C,D均收到广播，由于与该帧的目的地址不相符，C 和 D 将丢弃该帧。</p>
</li>
</ol>
<p>第二次发送数据，B-&gt;A：</p>
<ol>
<li>B 向 A 发送一帧。该帧从接口 3 进入到交换机。</li>
<li>交换机把这个帧的源地址 B 和接口 3 写入交换表中。</li>
<li>交换机收到帧后，先查找交换表。发现交换表中的 MAC 地址有 A，表明要发送给 A 的帧应从接口 1 转发出去。于是就把这个帧传送到接口 1 转发给 A。</li>
</ol>
<p>考虑到可能有时要在交换机的接口更换主机，或者主机要更换其网络适配器，这就需要更改交换表中的项目。为此，在交换表中每个项目都设有一定的有效时间。过期的项目就自动被删除。</p>
<p>这种自学习方法使得以太网交换机能够即插即用，不必人工进行配置。</p>
<h4 id="两台交换机"><a href="#两台交换机" class="headerlink" title="两台交换机"></a>两台交换机</h4><img src="net/image-20230131092734592.png" alt="image-20230131092734592" style="zoom:67%;" />

<p>不能出现回路</p>
<img src="net/image-20230131092746858.png" alt="image-20230131092746858" style="zoom:67%;" />

<p> 消除回路：使用生成树协议STP：不改变网络实际拓扑，但在逻辑上切断某些链路，使得一台主机到所有其他主机的路径是无环路的树状结构，从而消除兜圈子现象。</p>
<ul>
<li>以太网交换机具有并行性。</li>
<li>能同时连通多对接口，使多对主机能同时通信。</li>
<li>相互通信的主机都独占传输媒体，无碰撞地传输数据。</li>
<li>每一个端口和连接到端口的主机构成了一个碰撞域。</li>
</ul>
<img src="net/image-20230131093316096.png" alt="image-20230131093316096" style="zoom:67%;" />

<img src="net/image-20230131093335928.png" alt="image-20230131093335928" style="zoom:67%;" />

<h4 id="从总线以太网到星形以太网"><a href="#从总线以太网到星形以太网" class="headerlink" title="从总线以太网到星形以太网"></a>从总线以太网到星形以太网</h4><img src="net/image-20230131093547087.png" alt="image-20230131093547087" style="zoom:67%;" />

<img src="net/image-20230131093554302.png" alt="image-20230131093554302" style="zoom:67%;" />

<h3 id="3虚拟局域网VLAN"><a href="#3虚拟局域网VLAN" class="headerlink" title="3虚拟局域网VLAN"></a>3虚拟局域网VLAN</h3><p>以太网存在的问题：</p>
<ul>
<li>广播风暴：广播太多，占用太多带宽，导致单播无法传递。程度收到主机数量影响</li>
<li>安全问题：广播，不安全，不能隔绝不同部门的通信</li>
<li>管理问题</li>
</ul>
<p>广播域：指这样一部分网络，其中任何一台设备发出的广播通信都能被该部分网络中的所有其他设备所接收。一个以太网就是一个广播域，交换机间的冗余链路易形成广播风暴。</p>
<p>VLAN</p>
<ul>
<li>由一些局域网网段构成的与物理位置无关的逻辑组。</li>
<li>这些网段具有某些共同的需求。</li>
<li>每一个 VLAN 的帧都有一个明确的标识符，指明发送这个帧的工作站是属于哪一个 VLAN。</li>
<li>虚拟局域网其实只是局域网给用户提供的一种服务，而并不是一种新型局域网。 </li>
</ul>
<p>划分VLAN后，同VLAN 内能接收广播，不同的广播会被隔绝；若不同域想发送消息，需要通过路由器。</p>
<h4 id="基于交换机端口划分"><a href="#基于交换机端口划分" class="headerlink" title="基于交换机端口划分"></a>基于交换机端口划分</h4><p>属于在第 1 层划分虚拟局域网的方法</p>
<p>最简单、常用。缺点：不允许用户移动端口。</p>
<p>有实验来着？</p>
<h4 id="基于网卡的MAC地址划分"><a href="#基于网卡的MAC地址划分" class="headerlink" title="基于网卡的MAC地址划分"></a>基于网卡的MAC地址划分</h4><p>属于在第 2 层划分虚拟局域网的方法</p>
<p>根据用户计算机的 MAC 地址划分虚拟局域网。允许移动端口</p>
<p>缺点：需要输入和管理大量的 MAC 地址。如果用户的 MAC 地址改变了，则需要管理员重新配置VLAN。</p>
<h4 id="基于IP子网地址的方法"><a href="#基于IP子网地址的方法" class="headerlink" title="基于IP子网地址的方法"></a>基于IP子网地址的方法</h4><p>根据以太网帧的第三个字段“类型”和 IP 分组首部中的源 IP 地址字段确定该 IP 分组属于哪一个虚拟局域网。</p>
<p>属于在第 3 层划分虚拟局域网的方法。</p>
<h4 id="基于高层应用或服务的方法"><a href="#基于高层应用或服务的方法" class="headerlink" title="基于高层应用或服务的方法"></a>基于高层应用或服务的方法</h4><p>可以基于协议，FTP，QQ等。</p>
<p>更灵活，但也更复杂。</p>
<img src="net/image-20230131095325769.png" alt="image-20230131095325769" style="zoom:67%;" />

<h4 id="帧格式"><a href="#帧格式" class="headerlink" title="帧格式"></a>帧格式</h4><img src="net/image-20230131095543188.png" alt="image-20230131095543188" style="zoom: 80%;" />

<img src="net/image-20230131095603193.png" alt="image-20230131095603193" style="zoom:80%;" />

<img src="net/image-20230131095613095.png" alt="image-20230131095613095" style="zoom:80%;" />



<h2 id="3-5-高速以太网"><a href="#3-5-高速以太网" class="headerlink" title="3.5 高速以太网"></a>3.5 高速以太网</h2><h3 id="100BASE-T"><a href="#100BASE-T" class="headerlink" title="100BASE-T"></a>100BASE-T</h3><p>速率达到或超过 100 Mb/s 的以太网称为高速以太网。采用双绞线的 100 Mb/s 星型拓扑以太网，仍使用 IEEE 802.3 的CSMA/CD 协议。100BASE-T 以太网又称为快速以太网(Fast Ethernet) IEEE802.3u；更换100Mb/s的适配器和集线器，网络拓扑结构、软件可保持不变。（不需要换网卡）可在全双工方式下工作而无冲突发生。此时不使用 CSMA/CD 协议。</p>
<p>当速率增加到10倍时，可将帧长增加10倍或电缆线减为原来的1/10.</p>
<p>100Mb/s以太网的方法是:</p>
<ul>
<li>保持最短帧长64字节保持不变;</li>
<li>将一个网段的最大电缆长度减小到 100 m;</li>
<li>争用期为5.12 ms（512b）</li>
<li>帧间时间间隔为 0.96 ms。</li>
</ul>
<img src="net/image-20230131155953942.png" alt="image-20230131155953942" style="zoom:67%;" />

<h3 id="1000BASE-T"><a href="#1000BASE-T" class="headerlink" title="1000BASE-T"></a>1000BASE-T</h3><p>Gbit以太网</p>
<p>允许在 1 Gb/s 下全双工和半双工两种方式工作。使用 802.3 协议规定的帧格式，IEEE802.3z 。在半双工方式下使用 CSMA/CD 协议。与 10BASE-T 和 100BASE-T 技术向后兼容。</p>
<p>吉比特以太网仍然保持一个网段的最大长度为 100 m，但采用了“载波延伸”的办法，使最短帧长仍为 64 字节（这样可以保持兼容性），同时将争用时间增大为 512 字节。（原来是512b）（实际最短帧512B）</p>
<h4 id="载波延伸"><a href="#载波延伸" class="headerlink" title="载波延伸"></a>载波延伸</h4><p>凡发送的 MAC 帧长不足 512 字节时，就用一些特殊字符填充在帧的后面，使MAC 帧的发送长度增大到 512 字节，但这对有效载荷并无影响。</p>
<p>接收端在收到以太网的 MAC 帧后，要将所填充的特殊字符删除后才向高层交付。 </p>
<img src="net/image-20230131160216245.png" alt="image-20230131160216245" style="zoom:67%;" />

<h4 id="分组突发"><a href="#分组突发" class="headerlink" title="分组突发"></a>分组突发</h4><p>当很多短帧要发送时，第一个短帧要采用上面所说的载波延伸的方法进行填充。</p>
<p>随后的一些短帧则可一个接一个地发送，只需留有必要的帧间最小间隔即可。这样就形成可一串分组的突发，直到达到 1500 字节或稍多一些为止。</p>
<img src="/2022/11/22/net/image-20230131160945225.png" class="" title="image-20230131160945225">

<h3 id="10G-100Gbit以太网"><a href="#10G-100Gbit以太网" class="headerlink" title="10G/100Gbit以太网"></a>10G/100Gbit以太网</h3><p>10 吉/100 吉比特以太网与 10 Mb/s，100 Mb/s 和 1 Gb/s 以太网的帧格式完全相同，IEEE802.3ae10 吉比特以太网还保留了 802.3 标准规定的以太网最小和最大帧长，便于升级。10 吉比特以太网使用光纤作为传输媒体。10 吉比特以太网只工作在全双工方式，因此没有争用问题，也不使用 CSMA/CD 协议。  </p>
<h3 id="以太网宽带接入-PPPoE"><a href="#以太网宽带接入-PPPoE" class="headerlink" title="以太网宽带接入-PPPoE"></a>以太网宽带接入-PPPoE</h3><p>PPPoE (PPP over Ethernet) ：在以太网上运行 PPP。将 PPP 帧封装到以太网中来传输。</p>
<p>现在的光纤宽带接入 FTTx 都要使用 PPPoE 的方式进行接入。</p>
<h1 id="Chapter4-网络层"><a href="#Chapter4-网络层" class="headerlink" title="Chapter4.网络层"></a>Chapter4.网络层</h1><ol>
<li>理解数据报服务与虚电路服务</li>
<li>掌握分类的IP地址无分类编址、路由聚合、地址块划分</li>
<li>掌握分组的转发流程。</li>
<li>掌握IP协议 (数据报结构、分片方法)。</li>
<li>掌握ARP协议和ICMP协议的工作原理。</li>
<li>掌握RIP、OSPF 、BGP路由协议工作原理。</li>
<li>理解路由器的结构和作用。</li>
<li>理解IPv6</li>
<li>理解多播地址（包括IP多播地址和局域网多播地址）、IGMP协议、<br> 反向路径广播机制，多播转发树。</li>
<li>理解NAT协议、VPN以及专网的概念。</li>
<li>理解MPLS的原理</li>
<li>理解SDN基本概念</li>
</ol>
<h2 id="4-1-网络层提供的两种服务"><a href="#4-1-网络层提供的两种服务" class="headerlink" title="4.1 网络层提供的两种服务"></a>4.1 网络层提供的两种服务</h2><h3 id="虚电路服务"><a href="#虚电路服务" class="headerlink" title="虚电路服务"></a>虚电路服务</h3><ul>
<li>思路：可靠通信应当由网络来保证</li>
<li>面向连接的通信方式-可靠交付</li>
<li>虚电路表示建立一条逻辑上连接，分组都沿逻辑连接按照存储转发方式传送</li>
</ul>
<h3 id="数据报服务"><a href="#数据报服务" class="headerlink" title="数据报服务"></a>数据报服务</h3><ul>
<li>思路：可靠通信由用户主机来保证</li>
<li>无连接的通信方式-尽最大努力的交付</li>
<li>直接发送数据报，每个分组独立路由，与前后分组无关</li>
<li>路由器结构简单，价格低；由传输层负责差错等；生存性好（存在通路就有可能发出数据）</li>
</ul>
<h2 id="4-2-IP"><a href="#4-2-IP" class="headerlink" title="4.2 IP"></a>4.2 IP</h2><h3 id="1-虚拟互连网络"><a href="#1-虚拟互连网络" class="headerlink" title="1.虚拟互连网络"></a>1.虚拟互连网络</h3><p>网络互连中间设备/中继系统：</p>
<ul>
<li>转发器（repeater）：物理层中继系统</li>
<li>网桥或桥接器（bridge）：数据链路层<ul>
<li>交换机是一种网桥</li>
</ul>
</li>
<li>路由器（router）（有时称网关（易混，蛮怪的））：网络层</li>
<li>桥路器（brouter）：网桥x路由器</li>
<li>网关（gateway）：网络层以上的中继系统，目前使用较少</li>
</ul>
<p>同构网络：物理层/数据链路层不相同，而其他部分相同；这种情况不称之为网络互连，仅是将一个网络扩大，但仍是一个网络。</p>
<p>异构网络：其他的不相同的；使用路由器的（个人理解）</p>
<p>互联网（Internet）：指用路由器进行互连的网络</p>
<p>虚拟互连网络：使用IP协议则简称IP网，是逻辑互连网络；当互联网上的主机进行通信时，就好像在一个网络上通信一样，看不见互连的各具体的网络异构细节。</p>
<p>直接交付：通过同构网络交付；相同网络号地址的主机</p>
<p>间接交付：需要通过路由器交付；不同网络号地址的主机</p>
<p>网络（网段）：是具有相同网络号的主机的集合<br>$$<br>Everyting \space over \space IP \<br>IP \space over \space everything<br>$$<br>与IP配套使用的协议：</p>
<ol>
<li>地址解析协议ARP（MAC地址）</li>
<li>逆地址解析协议RARP</li>
<li>网际控制报文协议ICMP（出错通知）</li>
<li>网际组管理协议IGMP（多播）</li>
</ol>
<img src="net/F7248935D82BFBB0C8DFB236DB2B0B7A.png" alt="img" style="zoom:50%;" />

<h3 id="2-IP地址划分"><a href="#2-IP地址划分" class="headerlink" title="2.IP地址划分"></a>2.IP地址划分</h3><h4 id="IP地址表示法"><a href="#IP地址表示法" class="headerlink" title="IP地址表示法"></a>IP地址表示法</h4><p>点 分 十 进 制 记 法（别看见不知道是啥）</p>
<h4 id="分类的IP"><a href="#分类的IP" class="headerlink" title="分类的IP"></a>分类的IP</h4><p>IP地址::={&lt;net-id&gt;,&lt;host-id&gt;}</p>
<p>规定：</p>
<ol>
<li>net-id不能全0</li>
<li>host-id全0，代表一个网段/网络/网络地址</li>
<li>host-id全1，代表一个广播</li>
</ol>
<p>分类IP也有掩码</p>
<h5 id="A类"><a href="#A类" class="headerlink" title="A类"></a>A类</h5><p>net-id第一位标记0，0开头即A类地址</p>
<p>环回地址，用于网络测试，只有A类有好像</p>
<p>掩码255.0.0.0</p>
<table>
<thead>
<tr>
<th>8位net-id</th>
<th>24位host-id</th>
</tr>
</thead>
<tbody><tr>
<td><del><strong>0</strong>000 0000</del> （全0）</td>
<td></td>
</tr>
<tr>
<td><strong>0</strong>000 0001.    1.x.x.x</td>
<td></td>
</tr>
<tr>
<td>…        （共126个）</td>
<td>共2^24-2（全0全1）个</td>
</tr>
<tr>
<td><strong>0</strong>111 1110.    126.x.x.x</td>
<td></td>
</tr>
<tr>
<td>0111 1111.（环回地址）</td>
<td></td>
</tr>
</tbody></table>
<h5 id="B类"><a href="#B类" class="headerlink" title="B类"></a>B类</h5><p>标记10，掩码255.255.0.0</p>
<table>
<thead>
<tr>
<th>16位net-id</th>
<th>16位host-id</th>
</tr>
</thead>
<tbody><tr>
<td><strong>10</strong>00 0000.0000 0001    128.1.x.x</td>
<td></td>
</tr>
<tr>
<td>…                      共2^14-1个</td>
<td>共2^16-2个</td>
</tr>
<tr>
<td>1011 1111.1111 1111    191.255.x.x</td>
<td></td>
</tr>
</tbody></table>
<h5 id="C类"><a href="#C类" class="headerlink" title="C类"></a>C类</h5><p>标记110，掩码255.255.255.0</p>
<table>
<thead>
<tr>
<th>24位net-id</th>
<th>8位host-id</th>
</tr>
</thead>
<tbody><tr>
<td><strong>110</strong>0 0000.0000 0000.0000 0001.    192.0.1.x</td>
<td></td>
</tr>
<tr>
<td>…                                                           共2^21-1个</td>
<td>共2^8-2个，254</td>
</tr>
<tr>
<td>1101 1111.1111 1111.1111 1111.    223.255.255.x</td>
<td></td>
</tr>
</tbody></table>
<h5 id="D类"><a href="#D类" class="headerlink" title="D类"></a>D类</h5><p>多播地址，标记1110</p>
<h5 id="E类"><a href="#E类" class="headerlink" title="E类"></a>E类</h5><p>保留，标记1111</p>
<h5 id="特殊IP"><a href="#特殊IP" class="headerlink" title="特殊IP"></a>特殊IP</h5><ul>
<li>0.0.0.0，表示本网络上的主机，相当于“我”；源地址可使用，目的不可用</li>
<li>网络号全0，主机号x，表示本网络上主机号为x的主机，“我们班的第几位同学”，但并未具体指明是什么班，只能在本网络通信；源不可用，目的可用</li>
<li>1.1.1.1，表示本网络上的广播；源不可用，目的可用</li>
<li>网络号y，主机号全1，表示网络号为y上的广播；源不可用，目的可用；（源地址写主机自己，目的写广播）</li>
<li>网络号127，主机号非全0全1，用于本地软件环回测试；源、目的均可用</li>
</ul>
<h5 id="IP地址特点"><a href="#IP地址特点" class="headerlink" title="IP地址特点"></a>IP地址特点</h5><ol>
<li>每个IP地址都由网络号和主机号两部分构成。</li>
<li>IP是标志一台主机（路由器）和一条链路的接口。多归属主机（就是路由器）：具有至少两个网络号不同的IP地址</li>
<li>转发器/交换机连接的若干局域网仍为一个网络。他们的网络号均相同，具有不同网络号的网络必须使用路由器互连。</li>
<li>在IP地址中，所有分配到网络号的网络是平等的。</li>
</ol>
<h5 id="分类IP优缺点"><a href="#分类IP优缺点" class="headerlink" title="分类IP优缺点"></a>分类IP优缺点</h5><p>优点：</p>
<ol>
<li>管理简单</li>
<li>使用方便</li>
<li>转发分组迅速</li>
<li>划分子网，灵活使用</li>
</ol>
<p>缺点：设计不合理</p>
<ol>
<li>大地址块，浪费地址资源</li>
<li>即使采用划分子网，也无法解决IP枯竭</li>
</ol>
<h4 id="子网划分"><a href="#子网划分" class="headerlink" title="子网划分"></a>子网划分</h4><p>似乎没细讲，对最基本编址方法的改进，把基于每类的IP网络进一步分成更小的网络。</p>
<h4 id="无分类编址CIDR"><a href="#无分类编址CIDR" class="headerlink" title="无分类编址CIDR"></a>无分类编址CIDR</h4><p>CIDR（Classless Inter-Domain Routing）：无分类域间路由选择</p>
<p>有时称CIDR为构造超网/网络聚合</p>
<h5 id="网络前缀"><a href="#网络前缀" class="headerlink" title="网络前缀"></a>网络前缀</h5><p>IP地址::={&lt;网络前缀&gt;,&lt;主机号&gt;}，CIDR中必须指明前缀</p>
<p>前缀：位数不固定，采用斜线记法；如114.51.4.0/20，前20位是前缀</p>
<p>连续的0可以省略：10.0.0.0/10—-10/10（192.0/10前面x位，后面n位，使x&gt;=n位？老师好像这么讲）</p>
<h5 id="地址块-网络-网段"><a href="#地址块-网络-网段" class="headerlink" title="地址块/网络/网段"></a>地址块/网络/网段</h5><p>网络前缀都相同的所有IP地址组成一个CIDR地址块</p>
<p>前缀n位，主机号m=32-n位：</p>
<ol>
<li>共有$2^m$个地址，<strong>可分配/指派的地址</strong>$2^m-2$个（总之好几种说法，但是看清是总的地址还是分配的！）</li>
<li>主机号全0为网络地址，全1为广播地址</li>
<li>特例？/31地址块中主机号可以是0或1，通常用于连接两个路由器</li>
</ol>
<h5 id="地址掩码-子网掩码-掩码"><a href="#地址掩码-子网掩码-掩码" class="headerlink" title="地址掩码/子网掩码/掩码"></a>地址掩码/子网掩码/掩码</h5><p>address mark/subnet mark</p>
<p>一串1+一串0，1的个数是网络前缀的长度</p>
<p>用于让机器从IP迅速算出网络地址（进行按位与运算即可）</p>
<p>所以这个可以理解为网络前缀的另一种表达方式</p>
<h5 id="常用CIDR地址块"><a href="#常用CIDR地址块" class="headerlink" title="常用CIDR地址块"></a>常用CIDR地址块</h5><p>有啥用啊</p>
<img src="net/CC2787196936A9BB69A9FFB0898AA953.png" alt="img" style="zoom: 50%;" />

<h5 id="构造超网-路由聚合"><a href="#构造超网-路由聚合" class="headerlink" title="构造超网/路由聚合"></a>构造超网/路由聚合</h5><p>每一个CIDR地址块中的地址数一定是2的整数次幂。除最后几行，CIDR地址块都包含了多个C类地址（是一个C类地址的$2^n$倍）</p>
<p><del>你说这个我也不懂啊</del>具体做法：求同存异</p>
<p><del>你说这个也不具体啊</del>一堆xxx/24，若前面n位相同，就可以变成xxx/n，构造一个大网络</p>
<h5 id="CIDR地址块划分"><a href="#CIDR地址块划分" class="headerlink" title="CIDR地址块划分"></a>CIDR地址块划分</h5><p>做题吧</p>
<p>平均划分：主机号借位划分，前缀变长</p>
<p>按需划分：二叉树划分</p>
<p>无论哪种方法，划分后总地址数量减少（需要扣掉网络地址和广播地址）</p>
<img src="net/5A47296151C37B7F3213D6B050852F08.png" alt="img" style="zoom:67%;" />

<h5 id="特殊CIDR块"><a href="#特殊CIDR块" class="headerlink" title="特殊CIDR块"></a>特殊CIDR块</h5><ul>
<li>/32 全是网络号，255.255.255.255：就是一个IP地址，这个特殊地址用于主机路由（？）</li>
<li>/31 只有两个IP地址，255.255.255.254：主机号0和1。用于点对点链路/链路路由（两个路由器之间）</li>
<li>/0 全是主机号，同时IP地址全0，0.0.0.0/0：用于默认路由（？）</li>
</ul>
<p>下面路由表里面还有讲，别急</p>
<blockquote>
<p>主机路由/网络路由</p>
<p>直连路由和网关路由是由下一跳区分的，而主机路由和网络路由是由目的地址的完整度区分的；</p>
<p>主机路由的目的地址是一个完整的主机地址。网络路由目的地址是一个网络地址（主机号部分为0）。</p>
<p>当为某个目的I P地址搜索路由表时，主机地址项必须与目的地址完全匹配，</p>
<p>而网络地址项只需要匹配目的地址的网络号和子网号就可以了。</p>
</blockquote>
<blockquote>
<p>默认路由（缺省路由）</p>
<p>这个路由将匹配所有的包. 能帮助减少路由条目</p>
<p>配置一条默认静态路由和静态路由相似，但IP地址和子网掩码全部是零</p>
<p>例如:ip route 0.0.0.0 0.0.0.0 [网关ip或接口]</p>
<p>子网掩码 0.0.0.0 代表匹配所有网络</p>
</blockquote>
<h3 id="3-IP地址与硬件地址"><a href="#3-IP地址与硬件地址" class="headerlink" title="3.IP地址与硬件地址"></a>3.IP地址与硬件地址</h3><p>无法描述，看ppt</p>
<p>透明</p>
<p>IP数据报向下封装成MAC帧；网络层使用IP，数据链路层使用硬件地址</p>
<p>注意帧格式，MAC-目的-源，IP-源-目的</p>
<p>路由器的IP地址并不出现在主机-主机的IP数据报首部中，但在MAC帧中出现</p>
<h3 id="4-ARP协议与RARP协议"><a href="#4-ARP协议与RARP协议" class="headerlink" title="4.ARP协议与RARP协议"></a>4.ARP协议与RARP协议</h3><p>Address Resolution Protocol 从IP地址解析出MAC地址</p>
<p>MAC地址/硬件地址/物理地址</p>
<p>ARP分组封装在<strong>以太网帧</strong>中，只解决同一局域网上的主机或路由器的IP/MAC映射问题</p>
<h4 id="工作过程"><a href="#工作过程" class="headerlink" title="工作过程"></a>工作过程</h4><ol>
<li><p>ARP高速缓存</p>
<p>存放IP到MAC的映射表，动态更新</p>
</li>
<li><p>ARP工作</p>
<p>概括讲，通过IP查映射表找MAC，找到即写入MAC帧目的地址，找不到就运行ARP获取MAC，并更新高速缓存</p>
</li>
<li><p>ARP查找IP地址对应的MAC地址</p>
<ol>
<li><p>主机A在本局域网广播发送ARP请求分组</p>
<p>路由器不转发ARP请求</p>
<p>其他主机重写A的MAC地址，更新ARP高速缓存</p>
</li>
<li><p>主机B向A单播发送ARP响应分组</p>
<p>主机A更新缓存</p>
</li>
</ol>
</li>
</ol>
<h4 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h4><ol>
<li>发送方是主机，要把 IP 数据报发送到本网络上的另一个主机。这时用 ARP 找到目的主机的硬件地址。 </li>
<li>发送方是主机，要把 IP 数据报发送到另一个网络上的一个主机。这时用 ARP 找到本网络上的一个路由器的硬件地址。剩下的工作由这个路由器来完成。 </li>
<li>发送方是路由器，要把 IP 数据报转发到本网络上的一个主机。这时用 ARP 找到目的主机的硬件地址。</li>
<li>发送方是路由器，要把 IP 数据报转发到另一个网络上的一个主机。这时用 ARP 找到本网络上另一个路由器的硬件地址。剩下的工作由这个路由器来完成。 </li>
</ol>
<h3 id="5-IP数据报格式"><a href="#5-IP数据报格式" class="headerlink" title="5.IP数据报格式"></a>5.IP数据报格式</h3><img src="net/3B97B9D13257055D818B3DE1389C736D.png" alt="img" style="zoom:67%;" />

<p>非常的必考，非常的必考</p>
<p>首部：固定长度/固定部分20Bytes，160bit；可变部分/可选字段最大40B；整个首部不超过60B</p>
<p>版本：4b，IP协议的版本，IPv4-0100，IPv6-0110</p>
<p>首部长度：4b，表示范围0101-1111（5-15)（一个单位表示4字节，所以20-60字节），因此首部长度最大值60B</p>
<p>区分服务：8b，用来获得更好的服务。IPv4没用，v6很有用（流媒体传输QoS等）</p>
<p>总长度：16b，指<strong>首部+数据部分</strong>总的长度，单位是字节，最大2^16-1=65535B，总长度必须不超过最大传送单元MTU。（MTU：Maxium Transfer Unit，规定所能传送的MAC帧的<strong>数据部分</strong>长度上限，IP封装成MAC帧时<strong>首部+数据部分</strong>不能超过MTU）</p>
<p>标识：16b，计数器，用来产生数据报的标识（用于分片，分片的各个数据报标识都一样）</p>
<p>标志：3b</p>
<p>​        第一位：MF More Fragment，MF=1表示后面还有分片，MF=0表示最后一个分片。</p>
<p>​        第二位：DF Dont Fragment，DF=0时允许分片，DF=1不允许分片。</p>
<p>​        第三位：目前无意义</p>
<p>片偏移：13b，分片后，某片在原分组中的相对位置。以8B为单位。（做题）</p>
<p>生存时间TTL(Time To live)：8b，数据报在网络中可通过的路由器数的最大值。跳数上限</p>
<p>协议：8b，指出数据报携带的数据使用何种协议，便于目的主机IP层将数据部分上交给哪个处理进程(ICMP/IGMP/OSPF/TCP/UDP)</p>
<p>首部检验和：16b，只检验首部，不检验数据部分。采用反码求和算法（具体怎么算没看懂）</p>
<p>源地址：32b</p>
<p>目的地址：32b</p>
<p>可选字段：最大40B（320b），用来支持排错、测量、安全措施；但会增加每个路由器处理数据报的开销。</p>
<h2 id="4-3-IP转发分组的过程"><a href="#4-3-IP转发分组的过程" class="headerlink" title="4.3 IP转发分组的过程"></a>4.3 IP转发分组的过程</h2><h3 id="1-基于终点的转发"><a href="#1-基于终点的转发" class="headerlink" title="1.基于终点的转发"></a>1.基于终点的转发</h3><p>分组在互联网中是逐跳转发的，基于终点，基于分组首部中的目的地址传送和转发。（？）</p>
<p>路由表（目的网络地址，下一跳地址）</p>
<p>特殊的路由：</p>
<ul>
<li>默认路由0.0.0.0/0：不在路由表中详细指明目的网络的，采用默认路由，默认通过某个端口转发。放在路由表最后面</li>
<li>主机路由x.x.x.x/32：对特定目的主机的IP地址专门指明的一个路由。放在路由表最前面，多为管理员/防火墙使用。</li>
<li>链路路由x.x.x.x/31：点对点链路，路由器之间</li>
</ul>
<p>转发过程：</p>
<ol>
<li>主机H1掩码按位与，获得目的地址的网络号，若在本网络上，直接交付；否则向其他路由器R1转发。</li>
<li>ARP匹配MAC地址</li>
<li>R1查找路由表，匹配到之后直接（通过接口直达）/间接交付（给下一个路由器）</li>
<li>ARP匹配MAC地址</li>
<li>…</li>
</ol>
<h3 id="2-最长前缀匹配"><a href="#2-最长前缀匹配" class="headerlink" title="2.最长前缀匹配"></a>2.最长前缀匹配</h3><p>使用CIDR时，可能得到不止一个匹配结果。</p>
<p>最长前缀匹配原则：选择前缀最长的一个作为匹配的前缀。网络前缀越长，地址块越小，路由越具体。</p>
<p>将前缀最长的排在路由表第一行。</p>
<p>注：直接交付也应当符合最长前缀匹配。</p>
<h3 id="3-使用二叉线索查找路由表"><a href="#3-使用二叉线索查找路由表" class="headerlink" title="3.使用二叉线索查找路由表"></a>3.使用二叉线索查找路由表</h3><p>二叉线索 (binary trie)：一种特殊结构的树，可以快速在路由表中找到匹配的叶节点。</p>
<p>从二叉线索的根节点自顶向下的深度最多有 32 层，每一层对应于 IP 地址中的一位。</p>
<p>为简化二叉线索的结构，可以用唯一前缀 (unique prefix) 来构造二叉线索。</p>
<p>为了提高二叉线索的查找速度，广泛使用了各种压缩技术。</p>
<p>构建：</p>
<p>规则：先检查 IP 地址左边的第一位，如为 0，则第一层的节点就在根节点的左下方；如为 1，则在右下方。然后再检查地址的第二位，构造出第二层的节点。依此类推，直到唯一前缀的最后一位。每个叶节点代表一个唯一前缀。</p>
<p>为检查网络前缀是否匹配，必须使二叉线索中的每一个叶节点包含所对应的网络前缀和掩码。</p>
<p>查找：</p>
<ol>
<li><p>找到了一个叶节点。</p>
<p>将目的 IP 地址和该叶节点的掩码进行按位 AND 运算，看结果是否与叶节点的网络前缀相匹配。</p>
<p>若匹配，就按下一跳的接口转发该分组。</p>
</li>
<li><p>查到第三个字符 0 时，在二叉线索中找不到匹配的。说明这个地址不在这个二叉线索中。</p>
<p>检查是否存在默认路由。若有，把分组传送到指明的默认路由器，否则丢弃该分组。</p>
</li>
</ol>
<h2 id="4-4-ICMP"><a href="#4-4-ICMP" class="headerlink" title="4.4 ICMP"></a>4.4 ICMP</h2><p>网际控制报文协议Internet Control Message Protocol</p>
<p>允许主机或路由器报告差错情况和提供有关异常情况的报告。</p>
<p>种类：ICMP差错报告报文；ICMP询问报文</p>
<p>（报文一般为应用层称呼，但出于习惯…）</p>
<img src="net/492482A4A33B80ADBEA0482967A384DE.png" alt="img" style="zoom:67%;" />

<img src="net/97BC0C39B1D09DABEFDC186967A71E76.png" alt="img" style="zoom:67%;" />



<h3 id="差错报告报文"><a href="#差错报告报文" class="headerlink" title="差错报告报文"></a>差错报告报文</h3><img src="net/BB82F03D1A5350190C09C8BE8901CB44.png" alt="img" style="zoom: 50%;" />

<p>抽象图解释：A-R-B发送数据，然后到R出错了，应当由R向A发送ICMP差错报告报文，此时源地址R，目的地址A</p>
<p>不发送ICMP差错报告报文的情况：</p>
<ol>
<li>对 ICMP 差错报告报文不再发送 ICMP 差错报告报文。（loop差错）</li>
<li>对第一个分片的数据报片的所有后续数据报片都不发送 ICMP 差错报告报文。（发了第一个不对-那么所有报片都会被重发）</li>
<li>对具有多播地址的数据报都不发送 ICMP 差错报告报文。（不知道要发给谁）（？IP多播有吧）</li>
<li>对具有特殊地址（如127.0.0.0 （环回地址）或 0.0.0.0（主机我））的数据报不发送 ICMP 差错报告报文。（话说CIDR有环回地址吗）</li>
</ol>
<h3 id="询问报文"><a href="#询问报文" class="headerlink" title="询问报文"></a>询问报文</h3><p>(1) 回送请求和回答</p>
<p>由主机或路由器向一个特定的目的主机发出的询问。</p>
<p>收到此报文的主机必须给源主机或路由器发送 ICMP 回送回答报文。</p>
<p>这种询问报文用来测试目的站是否可达，以及了解其有关状态。了解对方是否开机；探路；排错；定位到主机/路由器等。</p>
<p>(2) 时间戳请求和回答</p>
<p>请某台主机或路由器回答当前的日期和时间。</p>
<p>时间戳回答报文中有一个 32 位的字段，其中写入的整数代表从1900 年 1 月 1 日起到当前时刻一共有多少秒。</p>
<p>时间戳请求与回答可用于时钟同步和时间测量，测试网络延迟等。</p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>PING packet internet grope</p>
<p>Traceroute</p>
<h2 id="4-5-Internet路由选择协议"><a href="#4-5-Internet路由选择协议" class="headerlink" title="4.5 Internet路由选择协议"></a>4.5 Internet路由选择协议</h2><p>理想的路由算法：正确、完整、简单、自适应（适应通信量和网络拓扑变化）、稳定、公平、最佳</p>
<p>不存在绝对最佳，最佳只是相对于某一种特定要求下得出的较为合理的选择。尽可能接近理想情况。</p>
<p>从路由算法的自适应性考虑：</p>
<ol>
<li>静态路由选择策略（已废弃）</li>
<li>动态路由选择策略：自适应路由选择，能够适应网络状态变化，但是实现起来较为复杂，开销较大。</li>
</ol>
<p>分层次的路由选择协议</p>
<h3 id="自治系统AS"><a href="#自治系统AS" class="headerlink" title="自治系统AS"></a>自治系统AS</h3><p>Autonomous System</p>
<p>​    定义：在单一的技术管理</p>
<ul>
<li>Internet将整个互联网划分成较小的AS</li>
<li>一个AS 是一个互联网，特点：AS有权自主地决定在本系统内使用何种路由协议（有且仅有一个，RIP/OSPF；路由选择评价标准一致）</li>
</ul>
<p>自治系统内的路由选择-域内路由选择，使用IGP</p>
<p>自制系统外的路由选择-域间路由选择，使用EGP</p>
<h3 id="内部网关协议IGP"><a href="#内部网关协议IGP" class="headerlink" title="内部网关协议IGP"></a>内部网关协议IGP</h3><h4 id="RIP-路由信息协议"><a href="#RIP-路由信息协议" class="headerlink" title="RIP 路由信息协议"></a>RIP 路由信息协议</h4><p>router information protocol</p>
<p>应用层协议</p>
<h5 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h5><p>RIP协议认为距离最短的就是最优的路径。</p>
<p>距离的定义：从⼀路由器到直接连接的⽹络的距离定义为1，从⼀个路由器到⾮直接连接的⽹络的距离定义为所经过的路由器数加1。距离也称为跳数(hop count)，因为每经过⼀个路由器，跳数+1。</p>
<p>RIP协议允许⼀条路径最多只能包含15个路由器，距离为<strong>16</strong>时相当于不可达（代码中置为inf，⼀个⼤整型），因此RIP仅适⽤于⼩型互联⽹。</p>
<p>RIP按照固定的时间间隔（如30s）与相邻的路由器交换路由信息（双⽅交换整个的路由表）。</p>
<p>路由器在刚刚开始⼯作时，只知道到直接连接的⽹络的距离（距离定义为1，下⼀跳为直接交付），之后每⼀个路由器也只和相邻路由器交换并更新路由信息。经过若⼲次更新后，所有的路由器最终都会直到到达本⾃制系统中任何⼀个⽹络的最短距离和下⼀跳路由器的地址。</p>
<h5 id="算法描述"><a href="#算法描述" class="headerlink" title="算法描述"></a>算法描述</h5><p>路由器A接收到来自B的路由表后，做出如下之⼀操作：</p>
<p>寻找B能够到达，而自身不能到达的目的网络。此时更新A路由表，增加新的一行，目的网络为这⼀新的目的网络，距离=B距离+1，下⼀跳为B。</p>
<p>寻找自身和B都到达的目的网络，且B是A的下⼀跳。此时⽆论⽹络状态变好或变差，更新距离=B 距离+1。</p>
<p>寻找自身和B都到达的目的网络，且B到达这⼀⽬的⽹络的距离&lt;A到达这⼀目的网络的距离，更新距离=B距离+1。</p>
<p>⼀定时间后，若B未向A发送路由表，认为B 不可达。A路由表中下⼀跳为B的信息，其距离=16（即不可达）。</p>
<h5 id="报文格式"><a href="#报文格式" class="headerlink" title="报文格式"></a>报文格式</h5><img src="net/8AA658C6E4FC6E168E9704510AC5AAA0.png" alt="img" style="zoom: 50%;" />

<h5 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h5><p>优点：实现简单，开销小</p>
<p>缺点：</p>
<ol>
<li>没有负载均衡机制。RIP协议认为距离最短的就是最优的路径，即便在实际使⽤中还存在⼀条⾼速（低时延）但路由器较多的路由。并且RIP不能在两个⽹络之间同时使⽤多条路由。</li>
<li>限制了网络规模。最大16跳</li>
<li>“好消息传得快，坏消息传得慢”。在⽹络所有路由器都正常⼯作的情况下（好消息），此时RIP收敛速度较快；但⽹络中一旦出现某台路由器由于某些原因导致故障（不可达），故障信息（坏消息）的传递会受到协议⾃⾝的限制出现两个路由器之间递归，到达最⼤跳数16时才能检出故障。</li>
<li>随着网络规模扩大，开销也将增加（路由器之间交换完整路由表的开销）</li>
</ol>
<h4 id="OSPF-开放最短路优先"><a href="#OSPF-开放最短路优先" class="headerlink" title="OSPF 开放最短路优先"></a>OSPF 开放最短路优先</h4><p>open shortest path first</p>
<p>网际层协议~~</p>
<h5 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h5><p>open：开放的协议，不受厂商控制</p>
<p>SPF：dijkstra算法</p>
<p>ospf是一个分布式的链路状态协议，每个路由器都维护一个链路状态数据库，数据库实际上就是本自治系统的网络拓扑结构图。各路由器频繁交换信息，实现链路状态数据库在全网范围内的一致（称为链路状态数据库的同步）。路由器基于此数据库，采用dijkstra算法生成路由表。</p>
<h5 id="信息交换"><a href="#信息交换" class="headerlink" title="信息交换"></a>信息交换</h5><p>使用洪泛法向本AS所有路由器发送信息（直接向邻居，间接向其他所有路由器）</p>
<p>信息是与本路由器相邻的所有路由器的链路状态/对当前网络拓扑的认知（说明本路由器与谁相邻，以及该相邻链路上的代价/度量）</p>
<p>只有链路状态发生变化时，路由器才发送信息。</p>
<p>五种信息分组</p>
<img src="net/image-20221220180345578.png" alt="image-20221220180345578" style="zoom: 67%;" />

<ol>
<li>相邻路由器每10s交换一次问候分组，若超过40s没有受到，认为其不可达。</li>
<li>摘要信息：有哪些路由器的链路状态信息已写入数据库。降低开销。</li>
<li>没有注释</li>
<li>只要链路状态发生变化，路由器就使用链路状态更新分组，采用可靠的洪泛法向全网更新链路状态。</li>
<li>没有注释</li>
</ol>
<p>可靠的洪泛法：有限的确认，不会出现大量无效信息（A发给B，B洪泛时不再发给A）</p>
<h5 id="OSPF的区域"><a href="#OSPF的区域" class="headerlink" title="OSPF的区域"></a>OSPF的区域</h5><p>使OSPF能作用于规模很大的网络，在AS下划分更小的范围，叫做区域。区域使用32位标识符（点分十进制表示）</p>
<p>一个区域内路由器最好不超过200个。</p>
<p>体现分层设计的思想（主干区域-其他在下层的区域，2层）</p>
<p>主干区域专用于连接下层区域、其他自治系统，标识符规定为0.0.0.0</p>
<p>一个区域的内部路由器只知道本区域的完整网络拓扑，而不知道其他区域网络拓扑情况。</p>
<p>优点：将洪泛的范围局限于每一个区域，而不是整个AS，使通信量减小。</p>
<p>缺点：交换信息的种类增加，更加复杂（但是值得）</p>
<h5 id="报文格式-1"><a href="#报文格式-1" class="headerlink" title="报文格式"></a>报文格式</h5><img src="net/image-20221220185125194.png" alt="image-20221220185125194" style="zoom:67%;" />

<p>运输层协议，使用IP数据报传送。构成的数据报很短，减少路由信息的通信量，可以不必将长数据报分片传送，一定程度上避免分片出错重传。</p>
<h5 id="优缺点-1"><a href="#优缺点-1" class="headerlink" title="优缺点"></a>优缺点</h5><p>优点</p>
<ul>
<li>更新过程收敛快</li>
<li>多种度量，可设置不同的代价</li>
<li>适合大型互联网</li>
<li>多路径负载平衡：如果同一个目的网络有多条相同代价的路径，可以将通信量分配给这几条路径。</li>
<li>OSPF分组具有鉴别功能，安全</li>
</ul>
<p>缺点：实现复杂</p>
<h3 id="外部网关协议EGP"><a href="#外部网关协议EGP" class="headerlink" title="外部网关协议EGP"></a>外部网关协议EGP</h3><h4 id="BGP"><a href="#BGP" class="headerlink" title="BGP"></a>BGP</h4><p>是<strong>不同AS</strong>的路由器之间交换路由信息的协议。</p>
<p>只保证可达，不考虑最佳</p>
<p>采用路径向量路由选择协议</p>
<p>应用层协议</p>
<h5 id="边界路由器"><a href="#边界路由器" class="headerlink" title="边界路由器"></a>边界路由器</h5><p>BGP speaker</p>
<p>每一个自制系统的管理员至少选择一个路由器作为边界路由器</p>
<p>一个边界路由器与其他AS的边界路由器交换信息，要先建立TCP连接，然后在此连接上交换BGP报文以建立BGP会话，利用BGP会话交换路由信息。使用TCP能够提供可靠服务，也简化了路由选择协议。</p>
<h5 id="目标前缀"><a href="#目标前缀" class="headerlink" title="目标前缀"></a>目标前缀</h5><p>就是目的网络的意思，不要混淆</p>
<h5 id="eBGP"><a href="#eBGP" class="headerlink" title="eBGP"></a>eBGP</h5><p>external BGP</p>
<p>边界路由器在AS之间建立的半永久性TCP连接，eBGP在不同AS间交换路由信息</p>
<h5 id="iBGP"><a href="#iBGP" class="headerlink" title="iBGP"></a>iBGP</h5><p>internal BGP</p>
<p>在AS内部，任何互相通信的路由器之间必须有一个逻辑连接（也使用TCP），在AS内部的路由器之间交换BGP路由信息。</p>
<p>BGP协议不仅运行在AS之间，也运行在AS内部。</p>
<p>因此：</p>
<ul>
<li>在AS内部运行的协议：IGP（OSPF/RIP）、iBGP</li>
<li>在AS之间运行的协议：eBGP</li>
</ul>
<p>eBGP&amp;iBGP使用的报文类型、属性、状态机等都完全一致，在通报前缀（目的网络）时，使用的规则不同：</p>
<ul>
<li>在eBGP连接的对等端得知的目的网络信息，可以通报给一个iBGP连接的对等端</li>
<li>在iBGP中，不通报给另一个iBGP连接的对等端</li>
</ul>
<img src="net/image-20221226105807534.png" alt="image-20221226105807534" style="zoom: 80%;" />

<h5 id="BGP路由信息"><a href="#BGP路由信息" class="headerlink" title="BGP路由信息"></a>BGP路由信息</h5><p>BGP路由=[前缀(目的网络)，BGP属性]=[前缀，AS-PATH，NEXT-HOP]   即路由表一行中的信息</p>
<img src="net/image-20221226110058665.png" alt="image-20221226110058665" style="zoom:80%;" />

<img src="net/image-20221226110323140.png" alt="image-20221226110323140" style="zoom:80%;" />

<img src="net/image-20221226110722429.png" alt="image-20221226110722429" style="zoom:80%;" />

<h5 id="BGP路由选择策略"><a href="#BGP路由选择策略" class="headerlink" title="BGP路由选择策略"></a>BGP路由选择策略</h5><ol>
<li><p>本地偏好(local preference)值最高的路由</p>
<img src="net/image-20221226111200984.png" alt="image-20221226111200984" style="zoom: 67%;" /></li>
<li><p>AS跳数最小的路由</p>
<p>字面意思，仅考虑AS数量最少，即便可能在AS4中会经过更多次数的转发</p>
</li>
<li><p>热土豆路由选择算法</p>
<p>选择能最快离开本AS的路径</p>
</li>
<li><p>路由器BGP ID数值最小的路由</p>
<p>这位更是()，R1c序号比1d小，所以选1c</p>
</li>
</ol>
<p>避免兜圈子：在属性AS-PATH中，不允许出现相同的AS号。</p>
<img src="net/image-20221226111446415.png" alt="image-20221226111446415" style="zoom:80%;" />

<p>三种AS：</p>
<ul>
<li>末梢AS：不转发来自其他AS的分组，自身向所连接的AS付费</li>
<li>穿越AS：为其他AS转发分组，其他AS付费</li>
<li>对等AS：事先协商的两个AS，彼此之间的发送或接收分组都不付费</li>
</ul>
<h5 id="BGP报文"><a href="#BGP报文" class="headerlink" title="BGP报文"></a>BGP报文</h5><ul>
<li>(1) 打开(OPEN)报文，用来与相邻边界路由器建立关系。</li>
<li>(2) 更新(UPDATE)报文，用来发送某一路由的信息，以及列出要撤消的多条路由。</li>
<li>(3) 保活(KEEPALIVE)报文，用来确认打开报文和周期性地证实邻站关系。</li>
<li>(4) 通知(NOTIFICATION)报文，用来发送检测到的差错。</li>
<li>在 RFC 2918 中增加了 ROUTE-REFRESH 报文，用来请求对等端重新通告。</li>
</ul>
<p>报文格式</p>
<img src="net/image-20221226111819911.png" alt="image-20221226111819911" style="zoom:67%;" />

<h5 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h5><ol>
<li>BGP协议交换路由信息的节点数是自制系统数，维护路由表开销不大</li>
<li>每个AS的边界路由器数目很少，使自制系统之间的路由选择不会过分复杂</li>
<li>BGP支持CIDR，因此BGP的路由表包括<u>目的网络前缀</u>、下一跳路由器，以及到达该目的网络所要经过的各个自制系统序列</li>
<li>BGP刚刚运行时，BGP交换整个路由表；之后只需要在发生变化时更新有变化的部分</li>
</ol>
<h3 id="路由器的构成"><a href="#路由器的构成" class="headerlink" title="路由器的构成"></a>路由器的构成</h3><p>功能：接收数据、转发数据，隔绝广播</p>
<h4 id="物理结构"><a href="#物理结构" class="headerlink" title="物理结构"></a>物理结构</h4><p>路由器是一种具有多个输入端口和多个输出端口的专用计算机，其任务是转发分组。即，路由器某个输入端口收到的分组，按照分组的目的网络，把该分组从路由器的某个合适的输出端口转发给下一跳。下一跳的路由器递归进行这种处理，直到分组到达终点。</p>
<img src="net/image-20221226114154366.png" alt="image-20221226114154366" style="zoom:80%;" />

<p>转发和路由选择的区别</p>
<p>转发forwarding：路由器根据路由表将用户IP数据报从合适的端口转发出去。</p>
<p>路由选择routing：按照路由协议/算法，动态改变所选择的路由。</p>
<p>路由表是根据路由算法得出的，转发表是从路由表得出的。</p>
<p>输入端口的处理：数据链路层剥去帧首部和尾部后，将分组送到网络层的队列中排队等待处理，这会产生一定时延</p>
<img src="net/image-20230104102833270.png" alt="image-20230104102833270" style="zoom:80%;" />

<p>输出端口的处理：与输入类似的反过程，先缓存，然后数据链路层加帧首尾，交给物理层后转发给外部线路。</p>
<img src="net/image-20230104102948665.png" alt="image-20230104102948665" style="zoom:80%;" />

<p>分组丢弃：队列缓存空间耗尽，后面再进入队列的分组由于没有存储空间被丢弃，是造成分组丢失的重要原因，根本原因之一。</p>
<p>丢弃最主要发生在输入端口缓存</p>
<h4 id="交换结构"><a href="#交换结构" class="headerlink" title="交换结构"></a>交换结构</h4><p>这是什么？</p>
<h5 id="通过存储器交换"><a href="#通过存储器交换" class="headerlink" title="通过存储器交换"></a>通过存储器交换</h5><img src="net/image-20230104103705321.png" alt="image-20230104103705321" style="zoom:67%;" />

<h5 id="通过总线交换"><a href="#通过总线交换" class="headerlink" title="通过总线交换"></a>通过总线交换</h5><img src="net/image-20230104103719935.png" alt="image-20230104103719935" style="zoom:67%;" />

<h5 id="纵横交换结构"><a href="#纵横交换结构" class="headerlink" title="纵横交换结构"></a>纵横交换结构</h5><img src="net/image-20230104103730552.png" alt="image-20230104103730552" style="zoom:67%;" />



<h2 id="4-6-IP多播"><a href="#4-6-IP多播" class="headerlink" title="4.6 IP多播"></a>4.6 IP多播</h2><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p>多播multicast</p>
<p>单播 一对一，广播 一对多，多播介于两者之间，一对n</p>
<p>可以大大节约网络资源</p>
<p>在互联网上进行多播叫IP多播，能够运行多播协议的路由器叫多播路由器</p>
<h4 id="多播IP地址"><a href="#多播IP地址" class="headerlink" title="多播IP地址"></a>多播IP地址</h4><p>IP多播所传送的分组需要使用多播IP地址作为目的地址</p>
<p>IPv4中，多播地址就是IP地址中的D类地址</p>
<p>每一个D类地址标志一个多播组224.0.0.0-239.255.255.255</p>
<h4 id="多播数据报"><a href="#多播数据报" class="headerlink" title="多播数据报"></a>多播数据报</h4><p>尽最大努力的交付，不保证能够播到所有成员</p>
<p>不产生ICMP差错报文</p>
<h3 id="局域网上的硬件多播"><a href="#局域网上的硬件多播" class="headerlink" title="局域网上的硬件多播"></a>局域网上的硬件多播</h3><p>IP-&gt;MAC不使用ARP，使用简单换算的以太网多播地址块(?)</p>
<img src="net/image-20230104120918907.png" alt="image-20230104120918907" style="zoom:67%;" />

<img src="net/image-20230104152356465.png" alt="image-20230104152356465" style="zoom:67%;" />

<h3 id="IGMP网际组管理协议-amp-多播路由选择协议"><a href="#IGMP网际组管理协议-amp-多播路由选择协议" class="headerlink" title="IGMP网际组管理协议&amp;多播路由选择协议"></a>IGMP网际组管理协议&amp;多播路由选择协议</h3><h4 id="IGMP"><a href="#IGMP" class="headerlink" title="IGMP"></a>IGMP</h4><p>网际组管理协议Internet Group Management Protocol</p>
<p>多播路由选择协议：协同工作，路由选择，转发数据</p>
<p>IGMP使多播路由器知道多播组成员信息，只知道有没有，不知道是谁，不知道成员分布在哪些网络上</p>
<p>IP在多播的扩展：IGMP报文加上IP首部构成IP数据报。IGMP也向IP提供服务，因此把IGMP看作IP的一个组成部分</p>
<p>IGMP工作可分为两阶段：1加入多播组；2探询组成员变化情况。</p>
<p>使用范围：</p>
<ul>
<li>多播路由器必须动态适应多播组成员的变化，因为每一台主机可以随时加入和离开。</li>
<li>多播数据报可以由没有加入多播组的主机发出，也可以通过没有组成员的接入网络。</li>
</ul>
<p>IGMP采用一些措施，避免增加大量开销</p>
<ul>
<li>所有通信都使用IP多播(?)，并尽可能使用硬件多播</li>
<li>对所有的组只发送一个请求信息的询问（询问：有组成员吗-&gt;回答：组x有）（而不是，询问：组x有吗-&gt;回答有）（节省开销，只收一条有无的回复）</li>
<li>当同一个网络上连接有多个多播路由器时，能迅速选择其中的一个来探询主机的成员关系</li>
<li>分散响应。采用随机数，让主机顺序发言（</li>
<li>抑制机制。同一组内每一个主机都要监听响应，只要有本组的其他主机先发送响应，自己就不再发送。</li>
</ul>
<h4 id="多播路由选择"><a href="#多播路由选择" class="headerlink" title="多播路由选择"></a>多播路由选择</h4><img src="net/image-20230104165420601.png" alt="image-20230104165420601" style="zoom:67%;" />

<img src="net/image-20230104165459198.png" alt="image-20230104165459198" style="zoom:67%;" />

<p>多播路由选择方法：</p>
<ol>
<li>反向路径广播RPB（检查是否经最短路径传送来的，查单播表，若到达反向主机，看下一跳是否为R1，若是，是来自R1的最优路径，转发；否，不转发）</li>
<li>洪泛与减除</li>
<li>隧道技术（在不支持多播的网络中封装成单播IP数据报传送）</li>
<li>基于核心的发现技术（对每个多播组指定核心路由器，为每一个多播组构建一个转发树，而不是每个源构建。开销较小，扩展性较好）</li>
</ol>
<h2 id="4-7-IPv6"><a href="#4-7-IPv6" class="headerlink" title="4.7 IPv6"></a>4.7 IPv6</h2><h3 id="IPv6基本首部"><a href="#IPv6基本首部" class="headerlink" title="IPv6基本首部"></a>IPv6基本首部</h3><h4 id="主要变化"><a href="#主要变化" class="headerlink" title="主要变化"></a>主要变化</h4><ol>
<li>更大的地址空间。地址增大到128位，2^128</li>
<li>扩展的地址层次结构。不进行地址块划分</li>
<li>灵活的首部格式。定义了许多可选的扩展首部</li>
<li>改进的选项。允许数据报包含有选项的控制信息，可根据自身需求增加字段（可编程的）</li>
<li>允许协议继续扩充</li>
<li>支持自动配置。不需要使用DHCP</li>
<li>支持资源预分配。QoS使用</li>
<li>IPv6首部改为8字节对齐。首部长度必须是8B的整数倍</li>
</ol>
<h4 id="数据报一般格式"><a href="#数据报一般格式" class="headerlink" title="数据报一般格式"></a>数据报一般格式</h4><p>由两大部分组成：基本首部+有效载荷</p>
<p>基本首部40B</p>
<p>有效载荷payload，也称净负荷，不超过65535B，有效载荷允许0-n个扩展首部，在后面是数据部分</p>
<img src="net/image-20230108173259228.png" alt="image-20230108173259228" style="zoom:67%;" />

<p>版本：4b，IPv6该字段为6</p>
<p>通信量类traffic class/服务类型：8b，为了区分不同的IPv6数据报的类别或优先级，与QoS（quality of service？）有关</p>
<p>流标号flow label：20b，“流”是互联网络上从特定源点到特定终点的一系列数据报，“流”所经过的路径上的路由器都保证指明的服务质量。所有属于同一个流的数据报都具有同样的流标号。</p>
<p><strong>流</strong>：源到目的地的一批数据，标号相同则属于同一段流，同一段流各种传输、各种属性都一致</p>
<p>有效载荷长度payload length：16b，指明IPv6数据报除基本首部以外的字节数（所有扩展首部都计算在有效载荷之内），最长64KB的扩展首部</p>
<p>下一个首部next header：8b，相当于IPv4协议字段或可选字段？</p>
<p>跳数限制：8b，数据报发出时设置跳数限制，路由器每次转发时-1，值为0时丢弃数据报，防止兜圈子</p>
<p>源地址，目的地址：128b</p>
<p>有效载荷/扩展首部：IPv6将原来IPv4中选项功能放在扩展首部中，且扩展首部在中间路由不处理，只在两端的源站和目的站处理（特例：逐跳选项扩展首部）。提高了路由器的处理效率</p>
<img src="net/image-20230109095649190.png" alt="image-20230109095649190" style="zoom:67%;" />

<img src="net/image-20230109095757164.png" alt="image-20230109095757164" style="zoom:67%;" />

<h3 id="IPv6的地址"><a href="#IPv6的地址" class="headerlink" title="IPv6的地址"></a>IPv6的地址</h3><p>目的地址可以是：</p>
<ol>
<li>单播unicast：传统的点对点通信</li>
<li>多播multicast：一对多的通信</li>
<li>任播anycast：IPv6增加的类型；DNS是一种任播<ul>
<li>任播的目的站是一组计算机，但数据报在交付时只交付其中的一个，通常是距离最近的一个</li>
<li>任播地址不能做报文源地址</li>
<li>任播地址只能分配给路由器，不能分配给主机</li>
</ul>
</li>
<li>IPv6没有定义广播地址，认为广播是多播特例</li>
</ol>
<h4 id="节点与接口"><a href="#节点与接口" class="headerlink" title="节点与接口"></a>节点与接口</h4><p>IPv6将实现IPv6的主机和路由器均称为节点</p>
<p>一个节点可能有多个与链路相连的接口，IPv6地址分配给节点上面的接口。（和实验中分配IPv4的一样）</p>
<h4 id="冒号十六进制记法"><a href="#冒号十六进制记法" class="headerlink" title="冒号十六进制记法"></a>冒号十六进制记法</h4><p>每16位的值用1位十六进制值表示，各值之间用冒号分割，如</p>
<p>68E6:8C64:FFFF:FFFF:0:1180:960A:FFFF</p>
<p>8段，4(一个字母4b)x4(4个16进制一段)x8(8段)=128b</p>
<p>允许把数字前的0省略，例如0000可以写成0</p>
<h5 id="零压缩"><a href="#零压缩" class="headerlink" title="零压缩"></a>零压缩</h5><p>一串连续的0可以省略，写两个冒号</p>
<p>FF05:0:0:0:0:0:0:B3-&gt;FF05**::**B3</p>
<p>注意：只能用一次零压缩</p>
<p>12AB:0:0:CD30:0:0:0:0/60 压缩为</p>
<p>12AB**::**CD30:0:0:0:0/60 或</p>
<p>12AB:0:0:CD30**::**/60</p>
<h5 id="点分十进制法的后缀"><a href="#点分十进制法的后缀" class="headerlink" title="点分十进制法的后缀"></a>点分十进制法的后缀</h5><p>可结合使用点分十进制，将IPv4转换为IPv6地址。如</p>
<p>0:0:0:0:0:0:128.10.2.1-&gt;::128.10.2.1</p>
<p>后面128.10.2.1是十进制的，不需要再转换16进制的意思吧</p>
<p>CIDR斜线记法仍然可用</p>
<p>IPv6不再使用掩码（没必要使用）</p>
<h4 id="IPv6常用地址"><a href="#IPv6常用地址" class="headerlink" title="IPv6常用地址"></a>IPv6常用地址</h4><img src="net/image-20230109103748473.png" alt="image-20230109103748473" style="zoom:67%;" />

<p>全球单播地址 详细的在ppt有，有点乱</p>
<h3 id="从IPv4向IPv6过渡"><a href="#从IPv4向IPv6过渡" class="headerlink" title="从IPv4向IPv6过渡"></a>从IPv4向IPv6过渡</h3><p>IPv6要兼容IPv4，能够为v4提供路由服务。</p>
<h4 id="使用双协议栈"><a href="#使用双协议栈" class="headerlink" title="使用双协议栈"></a>使用双协议栈</h4><p>双协议栈dual stack：在完全过渡到IPv6之前，使一部分主机/路由器装两个协议栈，一个v4一个v6</p>
<p>双协议栈主机记为IPv6/IPv4，表明它同时具有两种IP地址，一个v4地址，一个v6地址。</p>
<img src="net/image-20230109160756046.png" alt="image-20230109160756046" style="zoom:67%;" />

<h4 id="使用隧道技术"><a href="#使用隧道技术" class="headerlink" title="使用隧道技术"></a>使用隧道技术</h4><p>在IPv6数据报要进入IPv4网络时，把IPv6数据报封装成IPv4数据报，整个的IPv6数据报变成了IPv4的数据部分</p>
<p>当v4数据报离开v4网络的隧道进入v6网络时，再把数据部分（即v6数据报）交给主机的v6协议栈</p>
<img src="net/image-20230109161044955.png" alt="image-20230109161044955" style="zoom:67%;" />



<h3 id="ICMPv6"><a href="#ICMPv6" class="headerlink" title="ICMPv6"></a>ICMPv6</h3><p>IPv6也不保证数据报可靠交付，路由器也可能丢弃数据报，因此使用ICMP来反馈一些差错信息，新版本称为ICMPv6。</p>
<p>此外，地址解析协议ARP和网际组管理协议IGMP（多播管理）的功能都被合并到ICMPv6中</p>
<img src="net/image-20230109161649754.png" alt="image-20230109161649754" style="zoom:67%;" />

<h4 id="ICMPv6报文的分类"><a href="#ICMPv6报文的分类" class="headerlink" title="ICMPv6报文的分类"></a>ICMPv6报文的分类</h4><img src="net/image-20230109161704569.png" alt="image-20230109161704569" style="zoom:67%;" />





<h2 id="4-8-VPN-amp-NAT"><a href="#4-8-VPN-amp-NAT" class="headerlink" title="4.8 VPN&amp;NAT"></a>4.8 VPN&amp;NAT</h2><h3 id="虚拟专用网VPN"><a href="#虚拟专用网VPN" class="headerlink" title="虚拟专用网VPN"></a>虚拟专用网VPN</h3><p>virtual private network</p>
<p>核心原理：数据加密</p>
<p>节省IP地址的策略：</p>
<ol>
<li>无分类划分CIDR</li>
<li>VPN</li>
<li>NAT</li>
</ol>
<p>由于IPv4地址紧缺，一个机构能申请到的IP地址数往往小于本机构主机数。考虑到安全性，也并不需要将所有主机接入到外部互联网。假定机构内部的计算机通信也是采用TCP/IP协议，仅在机构内部使用的计算机就可以自行分配其IP地址。通过这一原理可以设置网络防火墙，外部无法得知内部主机IP，但不防内部攻击。</p>
<p>本地地址：仅在机构内使用的IP，可以由本机构自行分配</p>
<p>全球地址：全球唯一的IP地址，必须向互联网的管理机构申请</p>
<p>但会出现本地地址和全球地址重复，产生二义性。因此制定了一些专用地址，只能用作本地地址，在互联网中的所有路由器都不转发目的地址是专用地址的数据报</p>
<p>三个专用IP地址块：</p>
<ul>
<li>A类，10.0.0.0-10.255.255.255。或记为10.0.0.0/8，又称为24位块（前缀网络号8位，主机号24位）</li>
<li>B类，172.16.0.0-172.31.255.255。或记为172.16.0.0/12，又称为20位块</li>
<li>C类，192.168.0.0/16-192.168.255.255。或记为192.168.0.0/16，又称为16位块（常用作FTP服务器）</li>
</ul>
<p>专用互联网/本地互联网/专用网：采用这样专用IP地址的互联网络</p>
<p>可重用地址resuable address：这些专用地址仅在本机构内部使用，并且可以在物理上集中/分散，在其他机构可以重用</p>
<p><strong>虚拟专用网VPN</strong>：利用公用的互联网作为本机构各专用网之间的通信载体，这样的专用网称为虚拟专用网。专用网专用于机构内部的通信；虚拟表示 好像是 但实际不是，因为没有真正使用通信专线，而VPN只是在效果上和真正的专用网一样。</p>
<p>如果专用网不同网点之间的通信必须经过公用的互联网，但又有保密要求，那么所有通过互联网传送的数据都必须加密。构建VPN，需要机构为每个场所购买专门的硬件和软件并配置，使每个场所的VPN系统都知道其他场所的地址。</p>
<h4 id="用隧道技术实现虚拟专用网"><a href="#用隧道技术实现虚拟专用网" class="headerlink" title="用隧道技术实现虚拟专用网"></a>用隧道技术实现虚拟专用网</h4><img src="net/image-20230109171653095.png" alt="image-20230109171653095" style="zoom:67%;" />

<img src="net/image-20230109171706846.png" alt="image-20230109171706846" style="zoom:67%;" />

<h4 id="内联网-amp-外联网"><a href="#内联网-amp-外联网" class="headerlink" title="内联网&amp;外联网"></a>内联网&amp;外联网</h4><p>内联网intranet：由部门A和B的内部网络所构成的虚拟专用网VPN，表示部门A和B都是在一个机构的内部。</p>
<p>外联网extranet：一个机构和某些外部机构共同建立的VPN。</p>
<h4 id="远程接入VPN"><a href="#远程接入VPN" class="headerlink" title="远程接入VPN"></a>远程接入VPN</h4><p>remote access VPN</p>
<p>满足外部流动员工访问公司网络的需求。</p>
<p>在外地工作的员工拨号接入互联网，在员工PC机中的VPN软件可在PC机和公司的主机之间建立VPN隧道，外地员工与公司通信的内容是保密的，员工感觉好像在使用公司内部的本地网络。</p>
<h3 id="网络地址转换NAT"><a href="#网络地址转换NAT" class="headerlink" title="网络地址转换NAT"></a>网络地址转换NAT</h3><p>在专用网上，使用专用地址的主机与互联网上的主机通信–NAT</p>
<p>路由器需安装NAT软件，称为NAT路由器，至少有一个全球IP地址。使用本地地址的主机与外界通信时，都要在NAT路由器上将其本地地址转换成全球地址，才能与互联网连接。</p>
<img src="net/image-20230110113306479.png" alt="image-20230110113306479" style="zoom:80%;" />

<ol>
<li>内部主机 A 用本地地址 IPA 和互联网上主机 B 通信所发送的数据报必须经过 NAT 路由器。</li>
<li>NAT 路由器将数据报的源地址 IPA 转换成全球地址 IPG，并把转换结果记录到NAT地址转换表中，目的地址 IPB 保持不变，然后发送到互联网。</li>
<li>NAT 路由器收到主机 B 发回的数据报时，知道数据报中的源地址是 IPB 而目的地址是 IPG。</li>
<li>根据 NAT 转换表，NAT 路由器将目的地址 IPG 转换为 IPA，转发给最终的内部主机 A。 </li>
</ol>
<img src="net/image-20230110120344407.png" alt="image-20230110120344407" style="zoom:80%;" />

<p>NAT路由器有n个全球IP地址时，专用网内最多有n台主机接入到互联网，主机可以轮流使用优先数量的全球IP地址。通过NAT的通信必须由专用网内的主机发起，内部的主机不能充当服务器，因为互联网上的客户无法请求专用网内的主机。</p>
<h4 id="网络地址与端口号转换NAPT"><a href="#网络地址与端口号转换NAPT" class="headerlink" title="网络地址与端口号转换NAPT"></a>网络地址与端口号转换NAPT</h4><p>为了更加有效地利用 NAT 路由器上的全球IP地址，现在常用的 NAT 转换表把运输层的端口号也利用上。这样，就可以使多个拥有本地地址的主机，共用一个 NAT 路由器上的全球 IP 地址，因而可以同时和互联网上的不同主机进行通信。</p>
<p>使用端口号的 NAT 叫做网络地址与端口号转换NAPT (Network Address and Port Translation)，而不使用端口号的 NAT 就叫做传统的 NAT (traditional NAT)。</p>
<h2 id="4-9-MPLS多协议标签转换"><a href="#4-9-MPLS多协议标签转换" class="headerlink" title="4.9 MPLS多协议标签转换"></a>4.9 MPLS多协议标签转换</h2><p>多协议标签转换Multi-Protocol Label Switching</p>
<p>更快的转发分组，不查路由表即可转发</p>
<p>作用在网络层-数据链路层之间</p>
<p>是一种IP增强技术，路由器通过一次快速查表完成数据转发</p>
<p>多协议：MPLS的上层可以采用多种协议，例如IP，IPX；可以使用多种数据链路层协议，例如PPP，以太网，ATM（千兆以太网-异步传输）等</p>
<p>标签：给每个分组打上一个标签，根据该标签对分组进行转发。根据短而定长的标签转发报文，省去了通过软件查找IP路由的繁琐过程，数据传输更高速高效。</p>
<img src="net/image-20230110160432488.png" alt="image-20230110160432488" style="zoom:80%;" />

<h3 id="MPLS工作原理"><a href="#MPLS工作原理" class="headerlink" title="MPLS工作原理"></a>MPLS工作原理</h3><p>利用面向连接的概念，使每个分组携带一个叫做标签的小整数。当分组到达标签交换路由器时，标签交换路由器读取分组的标签，用标签值来检索分组转发表。这样比查找路由表来转发分组快得多。</p>
<p>MPLS域：该域中所有的路由器都是支持MPLS技术的<strong>标签交换路由器</strong>LSR(label switching router)。</p>
<p>LSR：同时具有标签交换和路由选择功能，标签交换是为了快速转发，但在这之前LSR需要使用路由选择功能构建转发表。</p>
<img src="net/image-20230110163023190.png" alt="image-20230110163023190" style="zoom:80%;" />

<p>特点：</p>
<ol>
<li>支持面向连接的服务质量；支持流量工程，平衡网络负载；支持VPN</li>
<li>把IP的路由和转发分离，在源路由（入口处）就可以决定数据报将要走的整条路经（传统的IP路由转发，每一跳都需要查找路由表），可以为不同入口的IP数据报打不同标签</li>
</ol>
<p>工作过程：</p>
<ol>
<li><p>找出标签交换路径 LSP</p>
<p>各 LSR 使用标签分配协议 LDP (Label Distribution Protocol) 交换报文，找出和标签相对应的标签交换路径 LSP (Label Switched Path)。整个标签交换路径就像一条虚连接一样（-&gt;支持面向连接）。</p>
<p>MPLS的主干网基本不变，完成1需要对网络情况的足够了解。</p>
</li>
<li><p>打标签，然后转发</p>
<p>入口节点 (ingress node) 给进入 MPLS 域的 IP 数据报打上标签（实际上是插入一个 MPLS 首部），并按照转发表把它转发给下一个 LSR。以后的所有 LSR 都按照标签进行转发。</p>
<p>给 IP 数据报打标签的过程叫做分类 (classification)。</p>
</li>
<li><p>标签对换。</p>
<p>一个标签仅在两个 LSR 之间才有意义。</p>
<p>LSR 要做两件事：转发，更新标签。</p>
<p>更新标签：把入标签更换成为出标签。称之为标签对换 (label swapping)。</p>
<img src="net/image-20230110164734416.png" alt="image-20230110164734416" style="zoom: 50%;" /></li>
<li><p>去除标签</p>
<p>当分组离开 MPLS 域时，MPLS 出口节点 (egress node) 把分组的标签去除。</p>
<p>把 IP 数据报交付给非 MPLS 的主机或路由器。</p>
</li>
</ol>
<p>显式路由选择explicit routing：由入口LSR确定进去MPLS域之后的转发路径。和传统的每一个路由器逐跳进行路由选择存在很大不同。</p>
<h4 id="转发等价类FEC"><a href="#转发等价类FEC" class="headerlink" title="转发等价类FEC"></a>转发等价类FEC</h4><p>forwarding equivalence class，MPLS的重要概念，即，路由器按照同样方式对待的分组的集合。</p>
<p>按照同样方式对待：从同样接口转发到同样的下一跳地址并且具有同样服务类别和同样丢弃优先级等。</p>
<ul>
<li>分类由服务商/网络管理员定义。</li>
<li>入口节点并不是给每一个分组指派一个不同的标签，而是将属于同样 FEC 的分组都指派同样的标签。</li>
<li>FEC 和标签是一一对应的关系。</li>
</ul>
<p>FEC用于负载平衡：</p>
<img src="net/image-20230110165921451.png" alt="image-20230110165921451" style="zoom:67%;" />

<p>流量工程TE：traffic engineering：采用FEC，更好的管理网络资源，均衡网络负载的工程。</p>
<h3 id="MPLS首部的位置与格式"><a href="#MPLS首部的位置与格式" class="headerlink" title="MPLS首部的位置与格式"></a>MPLS首部的位置与格式</h3><p>在把IP数据报封装成以太网帧之前，需要先插入一个MPLS首部。因此MPLS位于网络层-数据链路层之间。</p>
<img src="net/image-20230110170158190.png" alt="image-20230110170158190" style="zoom:80%;" />

<p>标签值（占 20 位）</p>
<ul>
<li>可以同时容纳高达 220 个流（即 1048576 个流）</li>
<li>实际上几乎没有哪个 MPLS 实例会使用很大数目的流，通常需要管理员人工管理和设置每条交换路径。</li>
</ul>
<p>试验（占 3 位）：目前保留用作试验。</p>
<p>栈S（占 1 位）：在有“标签栈”时使用。</p>
<p>生存时间TTL（占 8 位）：用来防止 MPLS 分组在 MPLS 域中兜圈子。</p>
<h3 id="新一代的MPLS"><a href="#新一代的MPLS" class="headerlink" title="新一代的MPLS"></a>新一代的MPLS</h3><p>MPLS 存在的问题，缺点：</p>
<ul>
<li>控制协议（如 LDP）比较复杂，扩展性差，运行维护较困难。</li>
<li>协议 LDP 无法做到基于时延或带宽等要求的流量调度。</li>
</ul>
<p>新一代的 MPLS：段路由选择协议 SR (Segment Routing)</p>
<p>保留了MPLS的主要特点，更简单。</p>
<p>段 (segment)：网络分为多个段，每个段有一个标识符，标签。</p>
<p>SR 基本工作原理：</p>
<ul>
<li>基于标签交换，但不需要使用协议 LDP。</li>
<li>由源节点为发送的报文指定路径，并将路径转换成有序的段列表 (Segment List)，即 MPLS 标签栈，它被封装在分组首部。</li>
<li>网络中的其他节点基于标签进行转发。</li>
<li>网络设有SDN控制器，收集并掌握全网的拓扑信息和链路状态信息，计算出分组的整个传输路径。</li>
</ul>
<h2 id="4-10-SDN软件定义网络"><a href="#4-10-SDN软件定义网络" class="headerlink" title="4.10 SDN软件定义网络"></a>4.10 SDN软件定义网络</h2><p>software defined network</p>
<p>网络层的两个层面：控制层面，数据层面。在逻辑上是分离的</p>
<p>在软件定义网络中，把控制层面和数据层面分离，让控制层面利用软件控制数据层面中的设备。控制层面/远程控制器负责计算最佳路由，在每一个路由器中生成其正确的转发表。</p>
<img src="net/image-20230110171916776.png" alt="image-20230110171916776" style="zoom:67%;" />

<p>优点：</p>
<ul>
<li>提高网络带宽利用率。完全SDN环境下各路由器不需交换路由表等信息，节省开销，提高利用率</li>
<li>网络运行更加稳定。</li>
<li>管理更加高效简化。进行集中管理</li>
<li>运行费用明显降低。路由器的控制层面被移走，实质上类似于交换机</li>
</ul>
<p>缺点：</p>
<ul>
<li>互联网精神——分布式，打破了这种体系，变为集中式</li>
<li>路由器生产厂家利润低，不愿生产支持SDN的路由器</li>
</ul>
<h3 id="SDN与OpenFlow"><a href="#SDN与OpenFlow" class="headerlink" title="SDN与OpenFlow"></a>SDN与OpenFlow</h3><p>SDN是一种新的<strong>体系结构</strong>，是一种设计、构建和管理网络的新方法或新概念。</p>
<p>OpenFlow是SDN体系结构中控制层面与数据层面之间的通信接口，是交换信息的<strong>协议</strong>。使控制层面的控制器可以对数据层面中的物理或虚拟设备进行直接访问和操纵，在逻辑上是集中式的、基于流的。</p>
<p>注：SDN未规定必须使用OpenFlow（体系结构和协议之间并无硬性规定）。</p>
<img src="net/image-20230110173124482.png" alt="image-20230110173124482" style="zoom:67%;" />

<h4 id="OpenFlow协议"><a href="#OpenFlow协议" class="headerlink" title="OpenFlow协议"></a>OpenFlow协议</h4><p>怎么就架构了呢？应该是SDN体系结构下openflow协议的使用架构？</p>
<p>OpenFlow架构的三个组成部分：</p>
<ul>
<li>流表：指示OpenFlow交换机如何进行流的处理，每个动作关联一个流表项</li>
<li>安全通道：负责控制器与交换机之间的交互，通过安全通道与远端控制器连接</li>
<li>OpenFlow协议：南向接口标准（控制器与交换机之间通信的开放标准）</li>
</ul>
<img src="net/image-20230110173737753.png" alt="image-20230110173737753" style="zoom:67%;" />

<p>数据层面：流表</p>
<p>流表 (flow table)：规定“匹配 + 动作”。</p>
<p>流：穿过网络的一种分组序列，而在此序列中的分组都共享分组首部某些字段的值。</p>
<img src="net/image-20230110174542375.png" alt="image-20230110174542375" style="zoom:67%;" />

<p>流表结构</p>
<p>与转发表不同，可以基于更多信息进行转发。</p>
<img src="net/image-20230110174744354.png" alt="image-20230110174744354" style="zoom:80%;" />

<p>首部字段值：一组字段（12 个），用来使入分组的对应首部与之相匹配。</p>
<ul>
<li>匹配不上的分组被丢弃，或发送到远程控制器做更多的处理。涉及三个层， Openflow的匹配抽象与之前的分层匹配完全不同。</li>
</ul>
<p>计数器：一组计数器，可包括已经与该表项匹配的分组数量，以及从该表项上次更新到现在经历的时间。</p>
<ul>
<li>输入缓存 目前计时数/时间，统计出数据xxx操作用的时间</li>
</ul>
<p>动作：广义转发。当分组匹配某个流表项时，把分组转发到指明的端口，或丢弃该分组，或把分组进行复制后再从多个端口转发出去，或重写分组的首部字段（第二、三和四层的首部字段）等。</p>
<img src="net/image-20230110175118035.png" alt="image-20230110175118035" style="zoom:80%;" />

<img src="net/image-20230110175145289.png" alt="image-20230110175145289" style="zoom:80%;" />

<img src="net/image-20230110175203813.png" alt="image-20230110175203813" style="zoom:80%;" />

<h3 id="SDN特征"><a href="#SDN特征" class="headerlink" title="SDN特征"></a>SDN特征</h3><ul>
<li>基于流的转发，流表定义转发规则</li>
<li>数据层面与控制层面分离，二者不在同一设备中</li>
<li>网络控制功能位于数据层面交换机之外，用软件实现</li>
<li>可编程的网络，不会受限于路由器算法固定</li>
</ul>
<h3 id="SDN控制器"><a href="#SDN控制器" class="headerlink" title="SDN控制器"></a>SDN控制器</h3><img src="/2022/11/22/net/image-20230111100026702.png" class="" title="image-20230111100026702">

<p>通信层：完成SDN控制器与受控网络设备之间的通信。通信层与数据层面的接口叫做南向接口，基本上采用OpenFlow</p>
<p>SNMP：简单网络管理协议，获取各种设备状态</p>
<p>状态管理层：完成核心功能</p>
<ul>
<li>管理和维护链路、主机、交换机等网络状态；</li>
<li>确定和维护流表，对生成流表的设施进行管理。</li>
</ul>
<p>最上面：SDN控制器与网络控制应用程序交互的接口称为北向接口，该API接口允许网络控制应用程序对状态管理层里的网络状态和流表进行读写操作。</p>
<p>SDN与传统网络的差别：</p>
<p>SDN</p>
<ul>
<li>功能分散。交换机、SDN 控制器、网络控制应用程序都是可以分开的实体。</li>
<li>可以由不同的厂商和机构来提供。</li>
</ul>
<p>传统网络</p>
<ul>
<li>控制层面、数据层面、协议的实现都垂直集成在一个机器里。</li>
<li>由单独的厂商提供。</li>
</ul>
<img src="net/image-20230111102404345.png" alt="image-20230111102404345" style="zoom:67%;" />



<h1 id="Chapter5-传输层"><a href="#Chapter5-传输层" class="headerlink" title="Chapter5.传输层"></a>Chapter5.传输层</h1><p>1、理解传输层的作用；</p>
<p>2、理解端口与插口的概念；</p>
<p>3、理解TCP协议与UDP协议区别；</p>
<p>4、掌握UDP数据报和TCP报文段的首部格式；</p>
<p>5、掌握TCP协议的可靠性控制机制：</p>
<p>  拥塞控制（慢启动，拥塞避免，快重传，快恢复）</p>
<p>  流量控制（滑动窗口协议）</p>
<p>  确认机制（最大重传时间的确定方法）</p>
<p>  连接管理（连接建立与释放）</p>
<h2 id="5-1传输层协议概述"><a href="#5-1传输层协议概述" class="headerlink" title="5.1传输层协议概述"></a>5.1传输层协议概述</h2><h3 id="进程之间的通信"><a href="#进程之间的通信" class="headerlink" title="进程之间的通信"></a>进程之间的通信</h3><p>运输层向应用层提供服务，它属于面向通信部分的最高层，同时也是用户功能中的最低层。</p>
<p>应用进程之间的通信又称为端到端的通信。网络边缘部分-端系统</p>
<p>当两个主机进行端到端通信时，只有位于网络边缘部分的主机的协议栈才有运输层，网络核心部分的路由器在转发分组时豆豆只用到下三层的功能（路由器只有三层）。</p>
<img src="net/image-20230112103651208.png" alt="image-20230112103651208" style="zoom:67%;" />

<h3 id="运输层主要功能"><a href="#运输层主要功能" class="headerlink" title="运输层主要功能"></a>运输层主要功能</h3><ol>
<li><p>为应用进程之间提供端到端的逻辑通信。（对比网络层，为主机之间提供逻辑通信）</p>
<p>运输层向下屏蔽了底层结构，只关心进程，不需了解网络下层的核心细节。</p>
</li>
<li><p>对收到的报文进行差错检测</p>
</li>
<li><p>UDP&amp;TCP提供的服务也存在差别</p>
</li>
</ol>
<h3 id="两个主要协议"><a href="#两个主要协议" class="headerlink" title="两个主要协议"></a>两个主要协议</h3><p>UDP(user datagram protocol)用户数据报协议（区分UTP：无屏蔽双绞线）</p>
<p>TCP(transmission control protocol)传输控制协议</p>
<p>TPDU(transport protocol data unit)运输协议数据单元：两个对等运输实体在通信时传送的数据单位</p>
<p>TCP的TPDU是<strong>TCP报文段</strong></p>
<p>UDP的TPDU是<strong>UDP报文</strong>或<strong>用户数据报</strong></p>
<p>一些对比：</p>
<ul>
<li>UDP提供无连接服务，尽最大努力交付，在网络状况较好时非常高效</li>
<li>TCP提供面向连接的可靠服务，不提供广播/多播服务。因为可靠（差错、流量、重传、拥塞）所以不可避免地增加了许多开销，不仅使TPDU首部增大、复杂，还要占用许多的处理机资源。</li>
</ul>
<p>使用UDP和TCP的典型应用和应用层协议</p>
<img src="net/image-20230112105722440.png" alt="image-20230112105722440" style="zoom:67%;" />

<h3 id="应用进程-端口"><a href="#应用进程-端口" class="headerlink" title="应用进程-端口"></a>应用进程-端口</h3><p>端口是运输层与应用层的服务接口。运输层的复用和分用功能都要通过端口才能实现。</p>
<p>运输层从IP层收到发送给应用进程的数据后，必须分别交付给指明的各应用进程。</p>
<p>协议端口号protocol port number，简称端口port</p>
<p>端口用一个16位端口号进行标志，只具有本地意义，标志本计算机应用层中各进程，在互联网中没有联系。</p>
<h4 id="三类端口"><a href="#三类端口" class="headerlink" title="三类端口"></a>三类端口</h4><ul>
<li>熟知端口，0-1023</li>
<li>登记端口，1024-49151，使用这个范围的端口号必须在IANA登记，防止重复</li>
<li>客户端口号/短暂端口号，49152-65535，留给客户进程选择暂时使用。当服务器进程收到客户进程的报文时，就知道了客户进程所使用的动态端口号。通信结束后，这个端口号可供其他客户进程以后使用。</li>
</ul>
<p>因此，<strong>客户机一般是大端口，服务器是小端口</strong></p>
<img src="net/image-20230112112238084.png" alt="image-20230112112238084" style="zoom:67%;" />

<img src="net/image-20230112112253038.png" alt="image-20230112112253038" style="zoom:67%;" />

<h4 id="软件端口-amp-硬件端口"><a href="#软件端口-amp-硬件端口" class="headerlink" title="软件端口&amp;硬件端口"></a>软件端口&amp;硬件端口</h4><p>软件端口：在协议栈层间的抽象协议端口，是应用层的各种协议进程与运输实体进行层间交互的一种地址</p>
<p>硬件端口：在路由器或交换机上的端口，是不同硬件设备进行交互的接口</p>
<p>？</p>
<h2 id="5-2-UDP用户数据报协议"><a href="#5-2-UDP用户数据报协议" class="headerlink" title="5.2 UDP用户数据报协议"></a>5.2 UDP用户数据报协议</h2><p>UDP只在IP数据报服务之上增加了很少一点功能，虽然UDP用户数据报只能提供不可靠的交付，但UDP在某些方面有其优点。</p>
<ul>
<li>复用：将UDP用户数据报组装成不同的IP数据报，发送到互联网</li>
<li>分用：根据UDP用户数据报首部中的目的端口号，将数据报分别传送到相应端口，以便应用进程到端口读取数据。</li>
<li>差错检测：检出错误，丢弃，不再占用资源传递，采用反码求和方法</li>
</ul>
<p>主要特点：无连接；尽最大努力交付；无拥塞控制；支持广播/多播；首部开销小；面向报文</p>
<h3 id="面向报文"><a href="#面向报文" class="headerlink" title="面向报文"></a>面向报文</h3><ul>
<li>发送方 UDP 对应用程序交下来的报文，在添加首部后就向下交付 IP 层。UDP 对应用层交下来的报文，既不合并，也不拆分，而是保留这些报文的边界。</li>
<li>应用层交给 UDP 多长的报文，UDP 就照样发送，即一次发送一个报文。</li>
<li>接收方 UDP 对 IP 层交上来的 UDP 用户数据报，在去除首部后就原封不动地交付上层的应用进程，一次交付一个完整的报文。</li>
<li>应用程序必须选择合适大小的报文。<ul>
<li>若报文太长，IP 层在传送时可能要进行分片，降低 IP 层的效率。</li>
<li>若报文太短，会使 IP 数据报的首部的相对长度太大，降低 IP 层的效率。</li>
</ul>
</li>
</ul>
<h3 id="UDP首部格式"><a href="#UDP首部格式" class="headerlink" title="UDP首部格式"></a>UDP首部格式</h3><img src="net/image-20230112115321237.png" alt="image-20230112115321237" style="zoom:67%;" />

<p>首部字段8B，由四个字段组成（源端口、目的端口、长度、检验和），每个字段都是2B。</p>
<p>计算检验和时，临时把12B“伪首部”和UDP用户数据报连接在一起。伪首部仅为了计算检验和，无其他含义</p>
<img src="net/image-20230112161622459.png" alt="image-20230112161622459" style="zoom:67%;" />

<img src="net/image-20230112161722315.png" alt="image-20230112161722315" style="zoom:67%;" />

<h3 id="UDP基于端口的分用"><a href="#UDP基于端口的分用" class="headerlink" title="UDP基于端口的分用"></a>UDP基于端口的分用</h3><img src="net/image-20230112161118709.png" alt="image-20230112161118709" style="zoom:67%;" />

<p>接收方UDP根据首部中的目的端口号，把报文通过相应的端口上交给应用进程。如果接收方UDP发现收到的报文中的目的端口号不正确（不存在该端口号的进程），就丢弃该报文，并由ICMP发送“端口不可达”差错报文给传送方。</p>
<h2 id="5-3-TCP传输控制协议"><a href="#5-3-TCP传输控制协议" class="headerlink" title="5.3 TCP传输控制协议"></a>5.3 TCP传输控制协议</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>TCP主要特点</p>
<ul>
<li>面向连接</li>
<li>面向字节流</li>
<li>点对点的连接，只有两个端点</li>
<li>提供可靠交付服务</li>
<li>提供全双工通信</li>
</ul>
<img src="net/image-20230112171024085.png" alt="image-20230112171024085" style="zoom:67%;" />

<p>面向字节流：相较于UDP面向报文，面向字节指最小传送单位是字节，字节在缓存中排队等待，达到一定数量后成组传送，不考虑字节组成报文的含义。对应用进程一次把多长的报文发送到TCP缓存中并不关心。</p>
<p>TCP根据对方给出的窗口值和当前网络拥塞的程度来决定一个报文段应包含多少字节，可以把太长的数据分片传送，也可以等待积累足够多的字节再构成报文传送。对比UDP，报文长度由应用进程给出，一次发送整个报文段。</p>
<h3 id="TCP的连接"><a href="#TCP的连接" class="headerlink" title="TCP的连接"></a>TCP的连接</h3><p>TCP 连接有两个端点，连接的端点叫<strong>套接字socket</strong>/插口=IP地址+端口号。</p>
<p>socket = （IP地址:端口号）</p>
<p>socket = （192.168.1.1:2028）</p>
<p>每一条TCP连接唯一地被通信两端（两个套接字）所确定；一对socket唯一定义一个连接。</p>
<h2 id="5-4-TCP报文段的首部格式"><a href="#5-4-TCP报文段的首部格式" class="headerlink" title="5.4 TCP报文段的首部格式"></a>5.4 TCP报文段的首部格式</h2><img src="net/image-20230117103152658.png" alt="image-20230117103152658" style="zoom:67%;" />

<p>MSS（maximum segment size）：TCP报文段中的<strong>数据字段</strong>的最大长度。数据字段+TCP首部=TCP报文段。</p>
<p>源端口、目的端口：各占2B</p>
<p>序号：4B，TCP连接中传送的数据流中的每一个<strong>字节</strong>都编上一个序号，序号字段的值则指的是本报文段所发送的数据的<strong>第一个字节</strong>的序号。（可以康康ppt35/172）</p>
<p>确认：4B，是期望收到对方的下一个报文段数据的第一个字节的序号。全双工，双方可以同时发送和确认。</p>
<img src="net/image-20230117105634582.png" alt="image-20230117105634582" style="zoom:67%;" />

<p>数据偏移/<strong>首部长度</strong>：4b，指出TCP报文段的数据起始处距离TCP报文段的起始处有多远。单位是32b=4B。最大1111-&gt;60B的首部长度</p>
<p>保留：6b，空</p>
<p>下面都是关键校验位，全部都是1位</p>
<p>URG紧急：URG=1时有效，此报文段中有紧急数据，是高优先级的数据，不排队直接传送。</p>
<p>ACK确认：ACK=1时前面的确认号才有效，ACK=0时确认号无效。</p>
<p>PSH推送：PSH=1有效，类似URG，接收端尽快交付不排队直接交付。</p>
<p>RST复位：RST=1有效，表示TCP连接出现严重差错，如由于主机崩溃或其他原因，必须释放连接，然后再重新建立连接。</p>
<p>SYN同步：SYN=1表示连接请求或连接接受报文，握手阶段。</p>
<p>FIN终止：FIN=1表示此报文段的发送端的数据已完成发送，要求释放连接。</p>
<p>窗口：16b，是发送方的接收窗口，从确认号算起，允许对方发送的数据量。</p>
<p>紧急指针：16b，指出在本报文段中紧急数据共有多少字节（紧急数据放在本报文段数据的最前面）。窗口为0也可以发送紧急数据。</p>
<p>选项：长度可变</p>
<ul>
<li>窗口扩大选项 ——占 3 字节，其中有一个字节表示移位值 S。新的窗口值等于TCP 首部中的窗口位数增大到(16 + S)，相当于把窗口值向左移动 S 位后获得实际的窗口大小。</li>
<li>时间戳选项——占10 字节，其中最主要的字段时间戳值字段（4 字节）和时间戳回送回答字段（4 字节）。<ul>
<li>用来计算往返时间RTT</li>
<li>用来防治序号绕回</li>
</ul>
</li>
<li>选择确认选项——见5.6TCP可靠传输</li>
</ul>
<p>填充字段：使整个首部长度是4B的整数倍的填充，无实际意义。</p>
<h2 id="5-5-可靠传输的工作原理"><a href="#5-5-可靠传输的工作原理" class="headerlink" title="5.5 可靠传输的工作原理"></a>5.5 可靠传输的工作原理</h2><h3 id="停止等待协议"><a href="#停止等待协议" class="headerlink" title="停止等待协议"></a>停止等待协议</h3><p>每发送完一个分组就停止发送，等待对方的确认。在收到确认后再发送下一个分组。</p>
<p>全双工的双方既是发送方也是接收方。方便起见，A为发送方，B为接收方，仅考虑一侧通信情况</p>
<h4 id="1无差错情况"><a href="#1无差错情况" class="headerlink" title="1无差错情况"></a>1无差错情况</h4><p>A 发送分组 M1，并在缓存中保留M1副本，发完就暂停发送，等待 B 的确认 (ACK)。</p>
<p>B 收到了 M1 向 A 发送 ACK。</p>
<p>A 在收到了对 M1 的确认后，从缓存中删除M1，就再发送下一个分组 M2。</p>
<img src="net/image-20230117152619979.png" alt="image-20230117152619979" style="zoom: 67%;" />

<h4 id="2差错情况"><a href="#2差错情况" class="headerlink" title="2差错情况"></a>2差错情况</h4><p>接收方B会出现两种情况：</p>
<ol>
<li>【分组错误】接收M1时检测出了差错，丢弃M1</li>
<li>【分组丢失】M1在过程中传丢，B什么都不知道哦。</li>
</ol>
<p>此时，B都不发送任何信息。</p>
<p>解决方法：超时重传，A为每个已发送的分组设置独立的超时计时器，超时时间应当比数据平均往返时间更长一些。A只要在超时计时器到期之前收到了相应的确认，就撤销超时计时器，继续发送M2</p>
<img src="net/image-20230117155236370.png" alt="image-20230117155236370" style="zoom:67%;" />

<h4 id="3确认丢失和确认迟到"><a href="#3确认丢失和确认迟到" class="headerlink" title="3确认丢失和确认迟到"></a>3确认丢失和确认迟到</h4><ol>
<li><p>B收到数据，但是发出的对M1的确认丢失了。A不能在设定时间内收到确认，重传M1，导致B收到两个M1。</p>
<p>解决方法：B丢弃重复的M1，并重新发送确认</p>
</li>
<li><p>传输过程中没有出现差错，但B对分组M1的确认迟到了。此时A重传M1，B收到重复的M1又发送了ACK，导致A共收到两个M1的ACK。</p>
<p>解决方法：A丢弃重复的对M1的ACK。</p>
</li>
</ol>
<img src="net/image-20230117155445656.png" alt="image-20230117155445656" style="zoom:67%;" />

<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><ul>
<li><p>发送分组前，必须暂时保留已发送分组的副本，以备重发。</p>
</li>
<li><p>分组和确认都必须编号</p>
</li>
<li><p>通常，A最终总是能收到对所有发出分组的确认。</p>
<p>如果A不断重传，但总收不到确认，就认为通信线路太差，不能通信。</p>
</li>
</ul>
<p>自动重传请求ARQ</p>
<p>automatic repeat re<strong>q</strong>uest</p>
<p>使用停止等待的机制，就可以在不可靠的传输网络上实现可靠的通信。</p>
<p>ARQ，意思是重传的请求是自动进行的，接收方不需要请求发送方重传某个出错的分组（？用户不需要的意思吗</p>
<h4 id="信道利用率-2"><a href="#信道利用率-2" class="headerlink" title="信道利用率"></a>信道利用率</h4><p>停止等待协议的优点是简单，缺点是信道利用率太低。</p>
<img src="net/image-20230117155815423.png" alt="image-20230117155815423" style="zoom:50%;" />

<p>当往返时间RTT远大于分组发送时间TD时，信道利用率就会非常低。若重传，利用率还会进一步降低。</p>
<h3 id="连续ARQ协议"><a href="#连续ARQ协议" class="headerlink" title="连续ARQ协议"></a>连续ARQ协议</h3><p>采用流水线传输，连续发送多个分组，不必发完一个就停下来等待确认。可以使信道上一直有数据不间断地传送。这样可以获得很高的信道利用率。</p>
<img src="net/image-20230118093146977.png" alt="image-20230118093146977" style="zoom: 67%;" />

<p>发送窗口：位于发送窗口内的分组都可以连续发送出去，不需要等待对方的确认。</p>
<p>连续ARQ协议规定，发送方每收到一个确认，就把发送窗口向前滑动一个分组的位置。</p>
<p>假设传送了M1M2M3M4，M2超时了，就重传M2M3M4</p>
<img src="net/image-20230118122149251.png" alt="image-20230118122149251" style="zoom: 67%;" />

<p>累计确认：不对收到的分组逐个确认，而是<strong>对按序到达的最后一个分组发送确认</strong>，表示：到这个分组为止的所有分组都已正确收到。</p>
<p>优点：容易实现，*即使确认丢失也不必重传。（？什么意思）</p>
<p>缺点：不能向发送方反映出接收方已经正确收到的所有分组的信息。</p>
<p>Go-back-N（回退 N）：表示需要再退回来重传已发送过的 N 个分组。v如果发送方发送了前 5 个分组，而中间的第 3 个分组丢失了。这时接收方只能对前两个分组发出确认。发送方无法知道后面三个分组的下落，而只好把后面的三个分组都再重传一次。</p>
<p>当通信线路质量不好时，连续 ARQ 协议会带来负面的影响。疯狂重传一大堆分组</p>
<h3 id="滑动窗口协议"><a href="#滑动窗口协议" class="headerlink" title="滑动窗口协议"></a>滑动窗口协议</h3><img src="net/image-20230118124028667.png" alt="image-20230118124028667" style="zoom:67%;" />

<h2 id="5-6-TCP可靠传输的实现"><a href="#5-6-TCP可靠传输的实现" class="headerlink" title="5.6 TCP可靠传输的实现"></a>5.6 TCP可靠传输的实现</h2><p>通过滑动窗口协议实现。</p>
<img src="net/image-20230118124137302.png" alt="image-20230118124137302" style="zoom:67%;" />

<p>然后抽象的两张图，有一个课后题不是很懂</p>
<img src="/2022/11/22/net/image-20230118155934954.png" class="" title="image-20230118155934954">

<img src="/2022/11/22/net/image-20230118160507944.png" class="" title="image-20230118160507944">

<p>P1P2P3：第一个字节的意思</p>
<img src="/2022/11/22/net/image-20230118160539119.png" class="" title="image-20230118160539119">

<img src="/2022/11/22/net/image-20230118160552293.png" class="" title="image-20230118160552293">

<img src="/2022/11/22/net/image-20230118160602815.png" class="" title="image-20230118160602815">

<img src="/2022/11/22/net/image-20230118160612711.png" class="" title="image-20230118160612711">

<h3 id="发送缓存-amp-接收缓存"><a href="#发送缓存-amp-接收缓存" class="headerlink" title="发送缓存&amp;接收缓存"></a>发送缓存&amp;接收缓存</h3><p>发送缓存用来暂时存放：</p>
<ol>
<li>发送应用程序传送给发送方TCP准备发送的数据；</li>
<li>TCP已发送但尚未收到确认的数据</li>
</ol>
<p>接受缓存用来暂时存放：</p>
<ol>
<li>按序到达的、但尚未被接收应用程序读取的数据；</li>
<li>不按序到达的数据</li>
</ol>
<p>注意：</p>
<ul>
<li>A 的发送窗口并不总是和 B 的接收窗口一样大（因为有一定的时间滞后）。</li>
<li>TCP 标准没有规定对不按序到达的数据应如何处理。操作系统通常是先临时存放在接收窗口中，等到字节流中所缺少的字节收到后，再按序交付上层的应用进程。</li>
<li>TCP 要求接收方必须有累积确认的功能，这样可以减小传输开销。 累计一批/多批数据后发送对最后一个字节数据的确认。</li>
</ul>
<h3 id="接收方发送确认"><a href="#接收方发送确认" class="headerlink" title="接收方发送确认"></a>接收方发送确认</h3><p>接收方可以在合适的时候发送确认，也可以在自己有数据要发送时把确认信息顺便捎带上。</p>
<p>注意：</p>
<p>第一，接收方不应过分推迟发送确认，否则会导致发送方不必要的重传，这反而浪费了网络的资源。</p>
<p>第二，捎带确认实际上并不经常发生，因为大多数应用程序很少同时在两个方向上发送数据。</p>
<h2 id="5-7-TCP的流量控制"><a href="#5-7-TCP的流量控制" class="headerlink" title="5.7 TCP的流量控制"></a>5.7 TCP的流量控制</h2><p>利用滑动窗口实现流量控制</p>
<p>流量控制(flow control)就是让发送方的发送速率不要太快，要让接收方来得及接收。</p>
<img src="/2022/11/22/net/image-20230118162131137.png" class="" title="image-20230118162131137">

<h3 id="零窗口持续计时器"><a href="#零窗口持续计时器" class="headerlink" title="零窗口持续计时器"></a>零窗口持续计时器</h3><p>TCP 为每一个连接设有一个零窗口持续计时器，只要 TCP 连接的一方收到对方的零窗口通知，不能正常发送数据了，就启动持续计时器。</p>
<p>若持续计时器设置的时间到期，就发送一个零窗口探测报文段（仅携带 1 字节的数据，加首部共21B），而对方就在确认这个探测报文段时给出了现在的窗口值。</p>
<p>若窗口仍然是零，则收到这个报文段的一方就重新设置持续计时器。</p>
<p>若窗口不是零，则正常发送数据力</p>
<h3 id="传输时机"><a href="#传输时机" class="headerlink" title="传输时机"></a>传输时机</h3><p>指的是TCP缓存堆堆堆，决定发出的时机</p>
<ol>
<li>TCP 维持一个变量，它等于最大报文段长度 MSS。只要缓存中存放的数据达到 MSS 字节时，就组装成一个 TCP 报文段发送出去。</li>
<li>由发送方的应用进程指明要求发送报文段，即 TCP 支持的紧急URG或推送PSH操作。</li>
<li>发送方设置的一个计时器期限到了，这时就把当前已有的缓存数据装入报文段（但长度不能超过 MSS）发送出去。一个通用机制</li>
</ol>
<h4 id="发送方糊涂窗口综合症"><a href="#发送方糊涂窗口综合症" class="headerlink" title="发送方糊涂窗口综合症"></a>发送方糊涂窗口综合症</h4><p>在发送方上层数据速度慢时，发送方应用进程把数据逐个字节地送到TCP缓存中，并且每接收到上层一字节数据就发送。这样，发送效率很低。解决：使用nagle算法</p>
<h4 id="nagle算法"><a href="#nagle算法" class="headerlink" title="nagle算法"></a>nagle算法</h4><p>发送方把第一个数据字节先发送出去，把后面到达的数据字节都缓存起来。停止等待后面未到的数据。</p>
<p>当发送方收到对第一个数据字符的确认后，再把发送缓存中的所有数据组装成一个报文段发送出去，同时继续对随后到达的数据进行缓存。</p>
<ul>
<li>只有在收到对前一个报文段的确认后才继续发送下一个报文段。</li>
<li>当到达的数据已达到发送窗口大小的一半或已达到报文段的最大长度时，就立即发送一个报文段。满足这一条件时，即便未收到确认也发送。</li>
</ul>
<h4 id="接收方糊涂窗口综合症"><a href="#接收方糊涂窗口综合症" class="headerlink" title="接收方糊涂窗口综合症"></a>接收方糊涂窗口综合症</h4><p>当接收方的 TCP 缓冲区已满，接收方会向发送方发送窗口大小为 0 的报文。</p>
<p>若此时接收方的应用进程以交互方式每次只读取一个字节，于是接收方又发送窗口大小为一个字节的更新报文，发送方应邀发送一个字节的数据（发送的 IP 数据报是 41 字节长），于是接收窗口又满了，如此循环往复。</p>
<p>解决方法：改变发送更新报文时机，让接收方等待一段时间，使得接收缓存已有足够空间容纳一个最长的报文段，或者等到接收缓存已有一半空闲的空间。只要出现这两种情况之一，接收方就发出确认报文，并向发送方通知当前的窗口大小。</p>
<h3 id="超时重传时间的选择"><a href="#超时重传时间的选择" class="headerlink" title="超时重传时间的选择"></a>超时重传时间的选择</h3><p>最重要和最复杂的问题</p>
<p>TCP 每发送一个报文段，就对这个报文段设置一次计时器。只要计时器设置的重传时间到但还没有收到确认，就要重传这一报文段。</p>
<img src="net/image-20230118171818686.png" alt="image-20230118171818686" style="zoom:67%;" />

<p>计算方法：超时重传时间RTO=加权平均往返时间RTTs+4*偏差加权平均往返时间RTTd</p>
<h4 id="加权平均往返时间RTTs"><a href="#加权平均往返时间RTTs" class="headerlink" title="加权平均往返时间RTTs"></a>加权平均往返时间RTTs</h4><img src="net/image-20230118172007254.png" alt="image-20230118172007254" style="zoom: 80%;" />

<h4 id="超时重传时间RTO"><a href="#超时重传时间RTO" class="headerlink" title="超时重传时间RTO"></a>超时重传时间RTO</h4><p>retransmission time-out</p>
<img src="net/image-20230118172036149.png" alt="image-20230118172036149" style="zoom:80%;" />

<img src="net/image-20230118172640725.png" alt="image-20230118172640725" style="zoom:80%;" />

<h4 id="Karn算法"><a href="#Karn算法" class="headerlink" title="Karn算法"></a>Karn算法</h4><p>在计算平均往返时间 RTT 时，只要报文段重传了，就<strong>不采用</strong>其往返时间样本。</p>
<p>这样得出的加权平均平均往返时间 RTTS 和超时重传时间 RTO 就较准确。 </p>
<p><strong>修正的karn算法</strong></p>
<p>报文段每重传一次，就把RTO增大一些</p>
<img src="/2022/11/22/net/image-20230119115838899.png" class="" title="image-20230119115838899">

<p>γ通常取2，即新的RTO变为2倍</p>
<p>当不再发生报文段重传时，才根据报文段的往返时延更新RTT和RTO的数值。缩回正常值。</p>
<h3 id="选择确认SACK"><a href="#选择确认SACK" class="headerlink" title="选择确认SACK"></a>选择确认SACK</h3><p>接收方收到了前面的字节流不连续的两个字节块，如果这些字节块都在接受窗口内，接收方先收下这些数据，然后批量发送对他们的确认。</p>
<img src="net/image-20230119121203436.png" alt="image-20230119121203436" style="zoom:67%;" />

<h2 id="5-8-TCP的拥塞控制"><a href="#5-8-TCP的拥塞控制" class="headerlink" title="5.8 TCP的拥塞控制"></a>5.8 TCP的拥塞控制</h2><p>拥塞congestion：在某段时间，若对网络中某<strong>资源的需求</strong>超过了该资源所能提供的<strong>可用</strong>部分，网络的性能就要变坏，产生拥塞。</p>
<p>若网络中有许多资源同时产生拥塞，网络的性能就要变坏，整个网络的吞吐量将随输入负荷的增大而下降。</p>
<p>增加资源能解决拥塞吗？不能，还可能使网络的性能更坏。必须着眼于系统全局解决问题。</p>
<ol>
<li>增大缓存，但未提高输出链路的容量和处理机的速度，排队等待时间将会大大增加，引起大量超时重传，解决不了网络拥塞；</li>
<li>提高处理机处理的速率会将瓶颈转移到其他地方；</li>
<li>拥塞引起的重传并不会缓解网络的拥塞，反而会加剧网络的拥塞。</li>
</ol>
<img src="net/image-20230124094558669.png" alt="image-20230124094558669" style="zoom:67%;" />

<img src="net/image-20230124094745623.png" alt="image-20230124094745623" style="zoom:67%;" />

<ul>
<li>拥塞控制的前提：网络能够承受现有的网络负荷。</li>
<li>实践证明，拥塞控制是很难设计的，因为它是一个动态问题。</li>
<li>在许多情况下，甚至正是拥塞控制本身成为引起网络拥塞的原因</li>
<li>分组的丢失是网络发生拥塞的结果，而不是原因。</li>
</ul>
<h3 id="开环控制和闭环控制"><a href="#开环控制和闭环控制" class="headerlink" title="开环控制和闭环控制"></a>开环控制和闭环控制</h3><img src="net/image-20230124095002546.png" alt="image-20230124095002546" style="zoom:67%;" />

<p>开环实际并不现实</p>
<p>闭环控制措施：</p>
<ol>
<li>监测：监测网络系统，拥塞在何时何处发生。</li>
<li>传送：将拥塞发生的信息传送到可采取行动的地方。将拥塞发生的信息传送到产生分组的源站，周期性发出探测分组等</li>
<li>调整：调整网络系统的运行以解决出现的问题。选择合适调整周期</li>
</ol>
<h3 id="TCP基于窗口拥塞控制"><a href="#TCP基于窗口拥塞控制" class="headerlink" title="TCP基于窗口拥塞控制"></a>TCP基于窗口拥塞控制</h3><p>属于闭环控制。运输层位于端，不可能详细了解网络核心部分。</p>
<p>发送方维持一个拥塞窗口 cwnd (<strong>c</strong>ongestion <strong>w</strong>i<strong>nd</strong>ow)</p>
<ul>
<li><p>拥塞窗口的大小取决于网络的拥塞程度，并且动态地在变化。</p>
</li>
<li><p>发送端利用拥塞窗口根据网络的拥塞情况调整发送的数据量。</p>
</li>
<li><p>发送窗口大小不仅取决于接收方公告的接收窗口，还取决于网络的拥塞状况，所以真正的发送窗口值为：</p>
<p>真正的发送窗口值 = Min(通知窗口值，拥塞窗口值)</p>
</li>
</ul>
<p>控制拥塞窗口的原则：</p>
<ul>
<li>只要网络没有出现拥塞，拥塞窗口就再增大一些，以便把更多的分组发送出去，这样就可以提高网络的利用率。</li>
<li>但只要网络出现拥塞，拥塞窗口就减小一些，以减少注入到网络中的分组数，以便缓解网络出现的拥塞。</li>
</ul>
<p>判断网络出现拥塞的依据：出现数据超时，即未接收到ACK，虽然原因有很多，但只能认为产生了拥塞。</p>
<h3 id="TCP四种拥塞控制算法"><a href="#TCP四种拥塞控制算法" class="headerlink" title="TCP四种拥塞控制算法"></a>TCP四种拥塞控制算法</h3><h4 id="慢开始"><a href="#慢开始" class="headerlink" title="慢开始"></a>慢开始</h4><p>由小到大逐渐增大拥塞窗口数值。</p>
<p>初始拥塞窗口<strong>cwnd</strong>设置：在刚刚开始发送报文段时，设置为1个发送方的最大报文段SMSS(sender max segment size)</p>
<p>慢开始门限<strong>ssthresh</strong>（slow start thresh）：动态控制变量</p>
<p>在每收到一个对新的报文的确认后，把拥塞窗口增加最多一个SMSS的数值（一个指数增加）</p>
<p>拥塞窗口cwnd每次的增加量 = min (N, SMSS)</p>
<p>其中 <em>N</em> 是原先未被确认的、但现在被刚收到的确认报文段所确认的字节数。不难看出，当 <em>N</em> &lt; SMSS 时，拥塞窗口每次的增加量要小于 SMSS。</p>
<p>传输轮次 (transmission round)：</p>
<ul>
<li>使用慢开始算法后，每经过一个传输轮次，拥塞窗口 cwnd 就加倍。</li>
<li>传输轮次：把拥塞窗口 cwnd 所允许发送的报文段都连续发送出去，并收到了对已发送的最后一个字节的确认。</li>
<li>一个传输轮次所经历的时间约为一个往返时间 RTT。</li>
<li>例如，拥塞窗口 cwnd = 4，这时的往返时间 RTT 就是发送方连续发送 4 个报文段，并收到这 4 个报文段的确认，总共经历的时间。</li>
</ul>
<p>慢开始门限 ssthresh 的用法：cwnd指数增长变为线性</p>
<ul>
<li>当 cwnd &lt; ssthresh 时，使用慢开始算法。</li>
<li>当 cwnd &gt; ssthresh 时，停止使用慢开始算法而改用拥塞避免算法。</li>
<li>当 cwnd = ssthresh 时，既可使用慢开始算法，也可使用拥塞避免算法。</li>
</ul>
<h4 id="拥塞避免"><a href="#拥塞避免" class="headerlink" title="拥塞避免"></a>拥塞避免</h4><p>拥塞避免算法的思路是让拥塞窗口 cwnd 缓慢地增大，即每经过一个往返时间 RTT 就把发送方的拥塞窗口 cwnd 加 1，而不是加倍，使拥塞窗口 cwnd 按线性规律缓慢增长。</p>
<p>在拥塞避免阶段，有“加法增大” (Additive Increase) 的特点。</p>
<p>出现拥塞时（重传计时器超时未接收ACK）：</p>
<ul>
<li>ssthresh = max(cwnd/2，2)</li>
<li>cwnd = 1</li>
<li>执行慢开始算法</li>
</ul>
<p>迅速减少主机发送到网络中的分组数，使得发生拥塞的路由器有足够时间把队列中积压的分组处理完毕。</p>
<img src="net/image-20230124104651957.png" alt="image-20230124104651957" style="zoom:80%;" />

<p><strong>注：</strong></p>
<ul>
<li>“拥塞避免”并非指完全能够避免了拥塞。利用以上的措施要完全避免网络拥塞还是不可能的。</li>
<li>“拥塞避免”是说在拥塞避免阶段把拥塞窗口控制为按线性规律增长，使网络比较不容易出现拥塞。</li>
</ul>
<h4 id="快重传"><a href="#快重传" class="headerlink" title="快重传"></a>快重传</h4><p>可以让发送方尽早知道发生了报文段的丢失。要求接收方不要等待自己发送数据时捎带确认，而是立即确认，即使收到了失序的报文段也是</p>
<p>发送方只要一连收到三个重复确认，就知道接收方确实没有收到报文段，因而应当立即进行重传（即“快重传”），这样就不会出现超时，发送方也不就会误认为出现了网络拥塞。</p>
<p>使用快重传可以使整个网络的吞吐量提高约20%. </p>
<p>不难看出，快重传并非取消重传计时器，而是在某些情况下可更早地重传丢失的报文段。</p>
<img src="net/image-20230124110223245.png" alt="image-20230124110223245" style="zoom:67%;" />

<h4 id="快恢复"><a href="#快恢复" class="headerlink" title="快恢复"></a>快恢复</h4><p>当发送端收到<strong>连续三个重复的确认</strong>时，就执行“乘法减小”算法，把慢开始门限 ssthresh 减半。</p>
<p>由于发送方现在认为网络很可能没有发生拥塞，因此现在不执行慢开始算法，而是：</p>
<ul>
<li>慢开始门限 ssthresh = 当前拥塞窗口 cwnd / 2 ；</li>
<li>新拥塞窗口 cwnd = 慢开始门限 ssthresh ；</li>
<li>开始执行拥塞避免算法，使拥塞窗口缓慢地线性增大。</li>
</ul>
<img src="net/image-20230124110419296.png" alt="image-20230124110419296" style="zoom:67%;" />

<p>发送窗口的上限值：</p>
<p>发送方的发送窗口的上限值应当取为接收方窗口 rwnd 和拥塞窗口 cwnd 这两个变量中较小的一个。</p>
<h4 id="加法增大-amp-乘法减小AIMD"><a href="#加法增大-amp-乘法减小AIMD" class="headerlink" title="加法增大&amp;乘法减小AIMD"></a>加法增大&amp;乘法减小AIMD</h4><p>在拥塞避免阶段，拥塞窗口是按照线性规律增大的。这常称为“加法增大” AI (Additive Increase)。</p>
<p>当出现超时或3个重复的确认时，就要把门限值设置为当前拥塞窗口值的一半，并大大减小拥塞窗口的数值。这常称为“乘法减小”MD (Multiplicative Decrease)。</p>
<p>二者合在一起就是 AIMD 算法。</p>
<img src="net/image-20230124110635995.png" alt="image-20230124110635995" style="zoom:67%;" />

<h3 id="主动队列管理AQM"><a href="#主动队列管理AQM" class="headerlink" title="主动队列管理AQM"></a>主动队列管理AQM</h3><p>？</p>
<p>先进先出FIFO</p>
<p>全局同步</p>
<p>随即早期检测RED</p>
<h2 id="5-9-TCP的运输连接管理"><a href="#5-9-TCP的运输连接管理" class="headerlink" title="5.9 TCP的运输连接管理"></a>5.9 TCP的运输连接管理</h2><p>运输连接的三个阶段：连接建立、数据传送、连接释放</p>
<p>采用客户机/服务器 C/S方式。主动发起者为客户，被动等待为服务器。</p>
<p>用三次握手建立TCP连接</p>
<p>四次挥手释放TCP连接</p>
<p>PPT</p>
<h1 id="Chapter6-应用层"><a href="#Chapter6-应用层" class="headerlink" title="Chapter6.应用层"></a>Chapter6.应用层</h1><ol>
<li>理解域名解析、文件传送、万维网、电子邮件、动态主机配置、网络管理</li>
<li>理解客户服务器与P2P的工作原理</li>
<li>掌握 DNS、FTP、HTTP、 SMTP、DHCP协议的工作原理</li>
<li>理解Chord、SNMP协议</li>
<li>了解POP3、IMAP、MIME</li>
<li>了解Napster、Gnutella、BitTorrent、CAN</li>
</ol>
<p>每个应用层协议都是为了解决某一类应用问题，通常是通过位于不同主机的多个应用进程之间的通信和协同工作来完成的。</p>
<p>应用层的具体内容就是规定应用进程在交互时所遵循的协议。</p>
<p>应用层的许多协议都是基于客户/服务器方式。</p>
<ul>
<li>客户(client)和服务器(server)都是指通信中所涉及的<strong>两个应用进程。</strong></li>
<li>客户/服务器方式所描述的是<strong>进程之间</strong>服务和被服务的关系。</li>
</ul>
<h2 id="6-1-域名系统DNS"><a href="#6-1-域名系统DNS" class="headerlink" title="6.1 域名系统DNS"></a>6.1 域名系统DNS</h2><p>域名系统 DNS (Domain Name System) ：互联网使用的命名系统，用来把人们使用的机器名字（域名）转换为 IP 地址，为互联网的各种网络应用提供了核心服务。使用UDP通信</p>
<p>DNS 是一个<strong>联机分布式数据库系统</strong>，采用客户/服务器方式，域名到 IP 地址的解析是由若干个域名服务器程序共同完成。域名服务器程序在专设的结点上运行，运行该程序的机器称为域名服务器。 </p>
<p>域名解析过程（原理上，但是实际有些区别）</p>
<img src="net/image-20230131162403739.png" alt="image-20230131162403739" style="zoom:67%;" />

<h3 id="互联网的域名结构"><a href="#互联网的域名结构" class="headerlink" title="互联网的域名结构"></a>互联网的域名结构</h3><p>命名方法：层次树状结构方法</p>
<p>域名：任何一个连接在互联网上的主机或路由器，都有一个唯一的层次结构的名字，即域名 (domain name)。</p>
<p>域：名字空间中一个可被管理的划分。可以划分为子域，而子域还可继续划分为子域的子域，这样就形成了顶级域、二级域、三级域，等等。</p>
<p>域名结构：层次结构。由标号 (label) 序列组成，各标号之间用点隔开，各标号分别代表不同级别的域名。</p>
<img src="net/image-20230131163045101.png" alt="image-20230131163045101" style="zoom:67%;" />

<img src="net/image-20230131163421220.png" alt="image-20230131163421220" style="zoom:80%;" />

<img src="net/image-20230131163431167.png" alt="image-20230131163431167" style="zoom:80%;" />

<h3 id="域名服务器"><a href="#域名服务器" class="headerlink" title="域名服务器"></a>域名服务器</h3><p>区：一个能进行域名解析的服务器的解析范围。一个服务器所负责管辖的（或有权限的）范围叫做区(zone)。各单位根据具体情况来划分自己管辖范围的区。但在一个区中的所有节点必须连通。DNS 服务器的管辖范围不以“域”为单位，而是以“区”为单位。</p>
<p>每一个区设置相应的权限域名服务器，用来保存该区中的所有主机的域名到IP地址的映射。</p>
<img src="net/image-20230131164039969.png" alt="image-20230131164039969" style="zoom: 67%;" />

<img src="net/image-20230131164934064.png" alt="image-20230131164934064" style="zoom: 67%;" />

<h4 id="根域名服务器"><a href="#根域名服务器" class="headerlink" title="根域名服务器"></a>根域名服务器</h4><p>最高层次的域名服务器。所有的根域名服务器都知道所有的顶级域名服务器的域名和 IP 地址（知道下面一层）。</p>
<p>Internet上共有13 个不同 IP 地址的根域名服务器，其名字是用一个英文字母命名，从a 一直到 m（前13 个字母）。</p>
<p>根域名服务器共有 13 套装置，不是 13 个机器。采用任播技术，使世界上大部分DNS域名服务器都能就近找到根服务器进行域名解析。</p>
<p>由1主根+12辅根组成，辅根的辅根：镜像，目前很多情况采用镜像。</p>
<p>相应的域名分别是：</p>
<ul>
<li>  a.rootservers.net</li>
<li>  b.rootservers.net</li>
<li>  … </li>
<li>  m.rootservers.net</li>
</ul>
<p>13套根域名服务器中：<br> 1套为主根服务器，放置在美国；<br> 其余12套均为辅根服务器，其中美国9套，欧洲2套，位于英国和瑞典，亚洲1套，位于日本。</p>
<p>2016年，中国主导在全球16个国家完成25台IPv6根服务器架设，事实上形成了13个原有根加25个IPv6根的新格局，中国部署了其中的4套，由1套主根服务器和3台辅根服务器组成，打破了中国过去没有根服务器的困境。 </p>
<p>根域名服务器并不直接把域名直接转换成 IP 地址。在使用迭代查询时，根域名服务器把下一步应当找的顶级域名服务器的 IP 地址告诉本地域名服务器。</p>
<h4 id="顶级域名服务器"><a href="#顶级域名服务器" class="headerlink" title="顶级域名服务器"></a>顶级域名服务器</h4><p>顶级域名服务器（即 TLD 服务器）负责管理在该顶级域名服务器注册的所有二级域名。收到 DNS 查询请求，给出相应的回答（可能是最后的结果，也可能是下一步应当找的域名服务器的 IP 地址）</p>
<p>北京有，负责.cn下的所有域名请求</p>
<h4 id="权限域名服务器"><a href="#权限域名服务器" class="headerlink" title="权限域名服务器"></a>权限域名服务器</h4><p>任何权限域名服务器，若要对互联网上任何一个域名进行解析，只要自己无法解析，就需要求助于根域名服务器。</p>
<p>负责一个区的域名服务器。当一个权限域名服务器还不能给出最后的查询回答时，就会告诉发出查询请求的 DNS 客户，下一步应当找哪一个权限域名服务器。（？</p>
<h4 id="本地域名服务器"><a href="#本地域名服务器" class="headerlink" title="本地域名服务器"></a>本地域名服务器</h4><p>或默认域名服务器</p>
<p>当一个主机发出 DNS 查询请求时，这个查询请求报文就发送给本地域名服务器。每一个互联网服务提供者 ISP，或一个大学，甚至一个大学里的系，都可以拥有一个本地域名服务器。</p>
<h4 id="可靠性"><a href="#可靠性" class="headerlink" title="可靠性"></a>可靠性</h4><p>DNS 域名服务器都把数据复制到几个域名服务器来保存，其中的一个是主域名服务器，其他的是辅助域名服务器。辅助域名服务器只会在主服务器故障时运行服务。当主域名服务器出故障时，辅助域名服务器可以保证 DNS 的查询工作不会中断。</p>
<p>主域名服务器定期把数据复制到辅助域名服务器中，而更改数据只能在主域名服务器中进行。这样就保证了数据的一致性。</p>
<h3 id="域名的解析过程"><a href="#域名的解析过程" class="headerlink" title="域名的解析过程"></a>域名的解析过程</h3><p><strong>主机</strong>向<strong>本地</strong>域名服务器的查询一般都是采用递归查询。<br>如果主机所询问的本地域名服务器不知道被查询域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，向其他根域名服务器继续发出查询请求报文。</p>
<p><strong>本地</strong>域名服务器向<strong>根</strong>域名服务器的查询通常是采用迭代查询。<br>当根域名服务器收到本地域名服务器的迭代查询请求报文时，要么给出所要查询的 IP 地址，要么告诉本地域名服务器：“你下一步应当向哪一个域名服务器进行查询”。然后让本地域名服务器进行后续的查询。</p>
<h4 id="递归查询"><a href="#递归查询" class="headerlink" title="递归查询"></a>递归查询</h4><img src="net/image-20230131173229066.png" alt="image-20230131173229066" style="zoom:80%;" />

<h4 id="迭代查询"><a href="#迭代查询" class="headerlink" title="迭代查询"></a>迭代查询</h4><img src="net/image-20230131173219814.png" alt="image-20230131173219814" style="zoom:80%;" />

<h4 id="高速缓存"><a href="#高速缓存" class="headerlink" title="高速缓存"></a>高速缓存</h4><p>每个域名服务器都维护一个高速缓存，存放最近用过的名字以及从何处获得名字映射信息的记录。可大大减轻根域名服务器的负荷，使互联网上的 DNS 查询请求和回答报文的数量大为减少。</p>
<p>为保持高速缓存中的内容正确，域名服务器应为每项内容设置计时器，并处理超过合理时间的项（例如，每个项目只存放两天）。</p>
<p>当权限域名服务器回答一个查询请求时，在响应中都指明绑定有效存在的时间值。增加此时间值可减少网络开销，而减少此时间值可提高域名转换的准确性。</p>
<h2 id="6-2-文件传输协议FTP"><a href="#6-2-文件传输协议FTP" class="headerlink" title="6.2 文件传输协议FTP"></a>6.2 文件传输协议FTP</h2><p>文件传送协议 FTP (File Transfer Protocol) 是互联网上使用最广泛的文件传送协议。FTP 提供交互式的访问，允许客户指明文件的类型与格式，并允许文件具有存取权限。</p>
<p>文件传送协议 FTP 只提供文件传送的一些基本的服务，它使用 TCP 可靠的运输服务。</p>
<p>FTP 的主要功能是减少或消除不同操作系统处理文件的不兼容性。</p>
<p>FTP 使用客户服务器方式。一个 FTP 服务器进程可同时为多个客户进程提供服务。FTP 的服务器进程由两大部分组成：一个主进程，负责接受新的请求；另外有若干个从属进程，负责处理单个请求。</p>
<p>过程：</p>
<p>很离谱，三页ppt三个说法</p>
<ol>
<li>打开熟知端口（端口号为 21），使客户进程能够连接上。</li>
<li>客户进程发出连接请求，寻找连接服务器进程的熟知端口(21)，同时还要告诉服务器进程自己的另一个端口号码，用于建立数据传送连接。</li>
<li>服务器进程用自己传送数据的熟知端口(20)与客户进程所提供的端口号码建立数据传送连接。启动从属进程来处理客户进程发来的请求。从属进程对客户进程的请求处理完毕后即终止，但从属进程在运行期间根据需要还可能创建其他一些子进程。</li>
<li>回到等待状态，继续接受其他客户进程发来的请求。主进程与从属进程的处理是并发地进行。</li>
</ol>
<p>由于 FTP 使用了两个不同的端口号，所以数据连接与控制连接不会发生混乱。</p>
<p><strong>控制连接</strong>在整个会话期间一直保持打开，FTP 客户发出的传送请求通过控制连接发送给服务器端的控制进程，但控制连接不用来传送文件。</p>
<p>实际用于传输文件的是<strong>数据连接</strong>。服务器端的控制进程在接收到 FTP 客户发送来的文件传输请求后就创建“数据传送进程”和“数据连接”，用来连接客户端和服务器端的数据传送进程。数据传送进程实际完成文件的传送，在传送完毕后关闭“数据传送连接”并结束运行。</p>
<img src="net/image-20230131174428394.png" alt="image-20230131174428394" style="zoom:67%;" />

<img src="/2022/11/22/net/image-20230131174441153.png" class="" title="image-20230131174441153">



<h2 id="6-3-万维网WWW"><a href="#6-3-万维网WWW" class="headerlink" title="6.3 万维网WWW"></a>6.3 万维网WWW</h2><p>万维网是分布式超媒体(hypermedia)系统，它是超文本(hypertext)系统的扩充。</p>
<p>一个超文本由多个信息源链接成。利用一个链接可使用户找到另一个文档。超媒体与超文本的区别是文档内容不同。超文本文档仅包含文本信息，而超媒体文档还包含其他表示方式的信息，如图形、图像、声音、动画，甚至活动视频图像。</p>
<p>万维网以客户/服务器方式工作。</p>
<p>浏览器就是在用户计算机上的万维网客户程序。万维网文档所驻留的计算机则运行服务器程序，因此这个计算机也称为万维网服务器。客户程序向服务器程序发出请求，服务器程序向客户程序送回客户所要的万维网文档。在一个客户程序主窗口上显示出的万维网文档称为页面(page)。</p>
<p>(1) 怎样标志分布在整个互联网上的万维网文档？</p>
<p>使用统一资源定位符 URL (Uniform Resource Locator)来标志万维网上的各种文档。</p>
<p>统一资源定位符 URL 是对可以从互联网上得到的资源的位置和访问方法的一种简洁的表示。大小写无要求</p>
<img src="/2022/11/22/net/image-20230201101211086.png" class="" title="image-20230201101211086">

<p>协议：http可以省略，其他都不能</p>
<p>主机：是存放资源的主机在互联网中的域名，通过DNS查找</p>
<p>端口、路径：可省略，根据协议映射，http-80，ftp-20,21</p>
<p>(2) 用何协议实现万维网上各种超链的链接？ </p>
<p>在万维网客户程序与万维网服务器程序之间进行交互所使用的协议，是超文本传送协议 HTTP (HyperText Transfer Protocol)。</p>
<p>HTTP 是一个应用层协议，它使用 TCP 连接进行可靠的传送。 </p>
<p>(3) 怎样使各种万维网文档都能在互联网上的各种计算机上显示出来，同时使用户清楚地知道在什么地方存在着超链？ </p>
<p>超文本标记语言 HTML (HyperText Markup Language)使得万维网页面的设计者可以很方便地用一个超链从本页面的某处链接到互联网上的任何一个万维网页面，并且能够在自己的计算机屏幕上将这些页面显示出来。</p>
<p>(4) 怎样使用户能够很方便地找到所需的信息？ </p>
<p>为了在万维网上方便地查找信息，用户可使用各种的搜索工具（即搜索引擎）。 </p>
<h3 id="超文本传送协议HTTP"><a href="#超文本传送协议HTTP" class="headerlink" title="超文本传送协议HTTP"></a>超文本传送协议HTTP</h3><p>HTTP 是面向事务的(transaction-oriented)应用层协议，它是万维网上能够可靠地交换文件（包括文本、声音、图像等各种多媒体文件）的重要基础。</p>
<img src="net/image-20230201102221715.png" alt="image-20230201102221715" style="zoom:80%;" />

<p>(1) 浏览器分析超链指向页面的 URL；</p>
<p>(2) 浏览器向 DNS 请求解析 <a target="_blank" rel="noopener" href="http://www.tsinghua.edu.cn/">www.tsinghua.edu.cn</a> 的 IP 地址；</p>
<p>(3) 域名系统 DNS 解析出清华大学服务器的 IP 地址；</p>
<p>(4) 浏览器与服务器建立 TCP 连接；</p>
<p>(5) 浏览器发出取文件命令：GET /chn/yxsz/index.htm；</p>
<p>(6) 服务器给出响应，把文件 index.htm 发给浏览器；</p>
<p>(7) TCP 连接释放；</p>
<p>(8) 浏览器显示“清华大学院系设置”文件 index.htm 中的所有文本。</p>
<h4 id="HTTP报文结构"><a href="#HTTP报文结构" class="headerlink" title="HTTP报文结构"></a>HTTP报文结构</h4><p>由于 HTTP 是面向正文的(text-oriented)，因此在报文中的每一个字段都是一些 ASCII 码串，因而每个字段的长度都是不确定的。协议接近自然语言。</p>
<h5 id="请求报文"><a href="#请求报文" class="headerlink" title="请求报文"></a>请求报文</h5><p>从客户向服务器发送请求报文。</p>
<img src="net/image-20230201102412290.png" alt="image-20230201102412290" style="zoom:80%;" />

<p>方法：是面向对象技术中使用的专门名词。所谓“方法”就是对所请求的对象进行的操作，因此这些方法实际上也就是一些命令。因此，请求报文的类型是由它所采用的方法决定的。</p>
<p>URL：请求资源的URL</p>
<p>版本：HTTP的版本，有1.0    1.1    2.0。版本协议结构大致相同</p>
<h5 id="响应报文"><a href="#响应报文" class="headerlink" title="响应报文"></a>响应报文</h5><p>从服务器到客户的回答。</p>
<img src="net/image-20230201104646056.png" alt="image-20230201104646056" style="zoom:80%;" />

<img src="net/image-20230201104704152.png" alt="image-20230201104704152" style="zoom:80%;" />

<h3 id="HTTP特点"><a href="#HTTP特点" class="headerlink" title="HTTP特点"></a>HTTP特点</h3><ul>
<li><p>HTTP 是面向事务的客户/服务器协议。</p>
</li>
<li><p>HTTP 协议是无状态的(stateless)。</p>
</li>
<li><p>HTTP 协议本身是无连接的，虽然它使用了面向连接的 TCP 向上提供的服务。TCP提供可靠性保障。</p>
<p>无连接，不会记录用户信息；使用cookie记录用户信息</p>
</li>
</ul>
<h3 id="HTTP资源请求工作方式"><a href="#HTTP资源请求工作方式" class="headerlink" title="HTTP资源请求工作方式"></a>HTTP资源请求工作方式</h3><p>1.1版本，可以一次传送多个TCP请求，是n个连接一起发送，不是一个连接</p>
<img src="/2022/11/22/net/image-20230201105530755.png" class="" title="image-20230201105530755">

<img src="/2022/11/22/net/image-20230201105701986.png" class="" title="image-20230201105701986">

<img src="/2022/11/22/net/image-20230201105710856.png" class="" title="image-20230201105710856">

<p>HTTP1.1使用持续连接（persistent connection）：服务器在发送响应后仍然在一段时间内保持这条连接（不释放），使同一个客户（浏览器）和该服务器可以继续在这条连接上传送后续的 HTTP 请求报文和响应报文。只要文档都在同一个服务器上，就可以继续使用该 TCP 连接。</p>
<p>两种工作方式：</p>
<ul>
<li>非流水线方式 (without pipelining)</li>
<li>流水线方式 (with pipelining)。</li>
</ul>
<img src="/2022/11/22/net/image-20230201105936701.png" class="" title="image-20230201105936701">

<img src="/2022/11/22/net/image-20230201105944953.png" class="" title="image-20230201105944953">

<p>HTTP2</p>
<ul>
<li>协议 HTTP/1.1 的升级版本，允许客户复用 TCP 连接进行多个请求。</li>
<li>服务器可以并行发回响应（使用同一个 TCP 连接）。时间间隔更小</li>
<li>把所有的报文都划分为许多较小的二进制编码的帧，并采用了新的压缩算法，<strong>不发送重复的首部字段</strong>，大大减小了首部的开销，提高了传输效率。（重大升级）</li>
<li>向后兼容。兼容1.0   1.1</li>
</ul>
<h3 id="代理服务器"><a href="#代理服务器" class="headerlink" title="代理服务器"></a>代理服务器</h3><p>代理服务器(proxy server)又称为万维网高速缓存(Web cache)，它代表浏览器发出 HTTP 请求。</p>
<img src="net/image-20230201110227942.png" alt="image-20230201110227942" style="zoom:80%;" />

<p>(1) 浏览器访问互联网的服务器时，要先与校园网的高速缓存建立 TCP 连接，并向高速缓存发出 HTTP 请求报文。</p>
<p>(2) 若高速缓存已经存放了所请求的对象，则将此对象放入 HTTP 响应报文中返回给浏览器，不需要根据URL访问。</p>
<p>(3) 否则，高速缓存就代表发出请求的用户浏览器，与互联网上的源点服务器建立 TCP 连接，并发送 HTTP 请求报文。</p>
<p>(4) 源点服务器将所请求的对象放在 HTTP 响应报文中返回给校园网的高速缓存。</p>
<p>(5) 高速缓存收到此对象后，先复制在其本地存储器中（为今后使用），然后再将该对象放在 HTTP 响应报文中，通过已建立的 TCP 连接，返回给请求该对象的浏览器。</p>
<p>此外，高速缓存设置计时器，一定时间后更新显示内容</p>
<p>优点：</p>
<ol>
<li>减少路由器间的流量</li>
<li>NAT，不需要内网IP地址，只需代理服务器地址来访问网络，节省IP</li>
<li>代理服务防火墙，隐藏了主机</li>
</ol>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>万维网站点使用 Cookie 来跟踪用户，Cookie 表示在 HTTP 服务器和客户之间传递的状态信息。</p>
<p>使用 Cookie 的网站服务器为用户产生一个唯一的识别码。利用此识别码，网站就能够跟踪该用户在该网站的活动。 </p>
<img src="/2022/11/22/net/image-20230201110622177.png" class="" title="image-20230201110622177">

<h3 id="信息检索系统"><a href="#信息检索系统" class="headerlink" title="信息检索系统"></a>信息检索系统</h3><p>1.全文检索搜索和分类目录搜索</p>
<p>在万维网中用来进行搜索的程序叫做搜索引擎。</p>
<p>全文检索搜索引擎是一种纯技术型的检索工具。它的工作原理是通过搜索软件到互联网上的各网站收集信息，找到一个网站后可以从这个网站再链接到另一个网站。然后按照一定的规则建立一个很大的在线数据库供用户查询。</p>
<p>用户在查询时只要输入关键词，就从已经建立的索引数据库上进行查询（并不是实时地在互联网上检索到的信息）。</p>
<ul>
<li><p>分类目录搜索引擎</p>
<ul>
<li>并不采集网站的任何信息，而是利用各网站向搜索引擎提交的网站信息时填写的关键词和网站描述等信息，经过人工审核编辑后，如果认为符合网站登录的条件，则输入到分类目录的数据库中，供网上用户查询。分类目录搜索也叫做分类网站搜索。</li>
</ul>
</li>
<li><p>垂直搜索引擎 (Vertical Search Engine)</p>
<ul>
<li>针对某一特定领域、特定人群或某一特定需求提供搜索服务。</li>
<li>垂直搜索也是提供关键字来进行搜索的，但被放到了一个行业知识的上下文中，返回的结果更倾向于信息、消息、条目等。</li>
</ul>
</li>
<li><p>元搜索引擎（META Search Engine）</p>
<ul>
<li>接受用户查询请求后，同时在多个搜索引擎上搜索，并将结果返回给用户。</li>
</ul>
</li>
</ul>
<h2 id="6-4-电子邮件"><a href="#6-4-电子邮件" class="headerlink" title="6.4 电子邮件"></a>6.4 电子邮件</h2><h3 id="电子邮件软件"><a href="#电子邮件软件" class="headerlink" title="电子邮件软件"></a>电子邮件软件</h3><ul>
<li><p>用户代理</p>
<ul>
<li><p>用户代理 UA 就是用户与电子邮件系统的接口，是电子邮件客户端软件。</p>
</li>
<li><p>用户代理的功能：撰写、显示、处理和通信。目前很多网站提供UA功能。专门的电子邮件管理软件可以一起收不同网站的邮箱邮件。</p>
</li>
</ul>
</li>
<li><p>邮件服务器</p>
<ul>
<li>邮件服务器的功能是发送和接收邮件，同时还要向发信人报告邮件传送的情况（已交付、被拒绝、丢失等）。</li>
<li>邮件服务器按照客户服务器方式工作。邮件服务器需要使用发送和读取两个不同的协议。</li>
</ul>
</li>
</ul>
<h3 id="电子邮件的标准"><a href="#电子邮件的标准" class="headerlink" title="电子邮件的标准"></a>电子邮件的标准</h3><p>发送邮件的协议：SMTP+MIME</p>
<p>读取邮件的协议：POP3 和 IMAP</p>
<p>通用互联网邮件扩充： MIME 在其邮件首部中说明了邮件的数据类型(如文本、声音、图像、视像等)，使用 MIME 可在邮件中同时传送多种类型的数据。</p>
<p>注：一个邮件服务器既可以作为客户，也可以作为服务器。例如，当邮件服务器 A 向另一个邮件服务器 B 发送邮件时，邮件服务器 A 就作为 SMTP 客户，而 B 是 SMTP 服务器。当邮件服务器 A 从另一个邮件服务器 B 接收邮件时，邮件服务器 A 就作为 SMTP 服务器，而 B 是 SMTP 客户。</p>
<h3 id="发送接收过程"><a href="#发送接收过程" class="headerlink" title="发送接收过程"></a>发送接收过程</h3><img src="/2022/11/22/net/image-20230201161556073.png" class="" title="image-20230201161556073">

<p>(1) 发信人调用用户代理来编辑要发送的邮件。用户代理用 SMTP 把邮件传送给发送端邮件服务器。</p>
<p>(2) 发送端邮件服务器将邮件放入邮件缓存队列中，等待发送。</p>
<p>(3) 运行在发送端邮件服务器的 SMTP 客户进程，发现在邮件缓存中有待发送的邮件，就向运行在接收端邮件服务器的 SMTP 服务器进程发起 TCP 连接的建立。</p>
<p>(4) TCP 连接建立后，SMTP 客户进程开始向远程的 SMTP 服务器进程发送邮件。当所有的待发送邮件发完了，SMTP 就关闭所建立的 TCP 连接。</p>
<p>(5) 运行在接收端邮件服务器中的 SMTP 服务器进程收到邮件后，将邮件放入收信人的用户邮箱中，等待收信人在方便时进行读取。</p>
<p>(6) 收信人在打算收信时，调用用户代理，使用 POP3或 IMAP协议将自己的邮件从接收端邮件服务器的用户邮箱中的取回（如果邮箱中有来信）。</p>
<h3 id="电子邮件的组成"><a href="#电子邮件的组成" class="headerlink" title="电子邮件的组成"></a>电子邮件的组成</h3><p>电子邮件由信封(envelope)和内容(content)两部分组成。</p>
<p>信封：在邮件的信封上，最重要的就是收件人的地址。</p>
<p>地址：xxx@邮箱所在主机的域名</p>
<p>内容：正文</p>
<p>电子邮件的传输程序根据邮件信封上的信息来传送邮件。用户在从自己的邮箱中读取邮件时才能见到邮件的内容。</p>
<h3 id="简单邮件传送协议SMTP"><a href="#简单邮件传送协议SMTP" class="headerlink" title="简单邮件传送协议SMTP"></a>简单邮件传送协议SMTP</h3><p>SMTP 所规定的就是在两个相互通信的 SMTP 进程之间应如何交换信息，基于<strong>TCP</strong>协议，端口号：25.</p>
<p>SMTP 使用客户/服务器方式，负责发送邮件的 SMTP 进程就是 SMTP 客户，而负责接收邮件的 SMTP 进程就是 SMTP 服务器。</p>
<p>SMTP 规定了 14 条命令和 21 种应答信息。每条命令用 4 个字母组成，而每一种应答信息一般只有一行信息，由一个 3 位数字的代码开始，后面附上简单的文字说明。 </p>
<p>通信的三个阶段</p>
<ol>
<li>连接建立：连接是在发送主机的 SMTP 客户和接收主机的 SMTP 服务器之间建立的。<br> SMTP不使用中间的邮件服务器。  </li>
<li>邮件传送</li>
<li>连接释放：邮件发送完毕后，SMTP 应释放 TCP 连接。</li>
</ol>
<p>SMTP 有以下缺点：通过MIME解决</p>
<ul>
<li>SMTP 不能传送可执行文件或其他的二进制对象。</li>
<li>SMTP 限于传送 7 位的 ASCII 码。许多其他非英语国家的文字（如中文、俄文，甚至带重音符号的法文或德文）就无法传送。</li>
<li>SMTP 服务器会拒绝超过一定长度的邮件。</li>
<li>某些 SMTP 的实现并没有完全按照[RFC 821]的 SMTP 标准。 </li>
</ul>
<h3 id="邮件读取协议POP3-IMAP"><a href="#邮件读取协议POP3-IMAP" class="headerlink" title="邮件读取协议POP3 IMAP"></a>邮件读取协议POP3 IMAP</h3><p>POP3</p>
<p>邮局协议 POP 是一个非常简单、但功能有限的邮件读取协议，现在使用的是它的第三个版本 POP3。POP 也使用客户/服务器的工作方式。在接收邮件的用户 PC 机中必须运行 POP 客户程序，而在用户所连接的 ISP 的邮件服务器中则运行 POP 服务器程序。  </p>
<p>最重要的特点：用户从邮件服务器上下载邮件后，只能本地查看邮件内容，在接收服务器中已经删除</p>
<p>IMAP</p>
<p>解决了POP3离线的问题，用户可以在不同的地方使用不同的计算机随时上网阅读和处理自己的邮件。</p>
<p>IMAP 还允许收件人只读取邮件中的某一个部分。例如，收到了一个带有视像附件（此文件可能很大）的邮件。为了节省时间，可以先下载邮件的正文部分，待以后有时间再读取或下载这个很长的附件。</p>
<p>IMAP 的缺点是如果用户没有将邮件复制到自己的 PC 机上，则邮件一直是存放在 IMAP 服务器上。因此用户需要经常与 IMAP 服务器建立连接</p>
<h3 id="万维网电子邮件"><a href="#万维网电子邮件" class="headerlink" title="万维网电子邮件"></a>万维网电子邮件</h3><p>用户代理 (UA) 的缺点：必须在计算机中安装用户代理软件。</p>
<p>万维网电子邮件优点：需要在计算机中再安装用户代理软件。只要能联网，就能方便地收发电子邮件。界面非常友好。</p>
<img src="/2022/11/22/net/image-20230201165234465.png" class="" title="image-20230201165234465">

<p>电子邮件从 发送方A 发送到发送方邮件服务器使用 HTTP 协议。</p>
<p>两个邮件服务器之间的传送使用 SMTP。</p>
<p>邮件从接收方邮件服务器传送到接收方B 使用 HTTP 协议。</p>
<h3 id="通用互联网邮件扩充MIME"><a href="#通用互联网邮件扩充MIME" class="headerlink" title="通用互联网邮件扩充MIME"></a>通用互联网邮件扩充MIME</h3><p>MIME 并没有改动 SMTP 或取代SMTP。增加了邮件主体的结构，并定义了传送非 ASCII 码的编码规则。 </p>
<img src="/2022/11/22/net/image-20230201165411313.png" class="" title="image-20230201165411313">

<ol>
<li><p>5 个新的邮件首部字段，它们可包含在[RFC 822]首部中。这些字段提供了有关邮件主体的信息。</p>
<img src="/2022/11/22/net/image-20230201170225499.png" class="" title="image-20230201170225499"></li>
<li><p>定义了传送编码，可对任何内容格式进行转换，而不会被邮件系统改变。</p>
<img src="/2022/11/22/net/image-20230201170233519.png" class="" title="image-20230201170233519">

<p>quoted-printable编码</p>
<img src="/2022/11/22/net/image-20230201170317709.png" class="" title="image-20230201170317709">

<p>base64编码，适合任意长度的二进制数据</p>
<img src="/2022/11/22/net/image-20230201170418889.png" class="" title="image-20230201170418889">

<img src="/2022/11/22/net/image-20230201170428524.png" class="" title="image-20230201170428524"></li>
<li><p>定义了许多邮件内容的格式，对多媒体电子邮件的表示方法进行了标准化。</p>
</li>
</ol>
<img src="/2022/11/22/net/image-20230201170501664.png" class="" title="image-20230201170501664">

<h2 id="6-5-动态主机配置协议DHCP"><a href="#6-5-动态主机配置协议DHCP" class="headerlink" title="6.5 动态主机配置协议DHCP"></a>6.5 动态主机配置协议DHCP</h2><p>配置的项目</p>
<p> (1) IP 地址</p>
<p> (2) 子网掩码</p>
<p> (3) 默认路由器的 IP 地址</p>
<p> (4) 域名服务器的 IP 地址</p>
<p>这些信息通常存储在一个配置文件中，计算机在引导过程中可以对这个文件进行存取。</p>
<p>DHCP 提供了即插即用连网(plug-and-play networking)的机制，这种机制允许一台计算机加入新的网络和获取IP地址而不用手工参与。 </p>
<p>DHCP 使用客户/服务器方式，基于UDP，工作流程包括6阶段。</p>
<h3 id="DHCP工作流程"><a href="#DHCP工作流程" class="headerlink" title="DHCP工作流程"></a>DHCP工作流程</h3><p>前四个阶段都是广播，后面两个是单播。全部都是UDP</p>
<h4 id="1发现阶段"><a href="#1发现阶段" class="headerlink" title="1发现阶段"></a>1发现阶段</h4><p>即：DHCP客户机寻找DHCP服务器的阶段。</p>
<p>（服务器要求：标准主机；拥有一组IP地址，已配置或能够自行配置掩码、网关等参数）</p>
<p>DHCP客户机以广播方式发送DHCP discover发现信息来寻找DHCP服务器，该广播包中的源IP地址为0.0.0.0（不知道自己IP，所以填”我”），目标IP地址为255.255.255.255（全1广播）</p>
<p>网络上每一台安装了TCP/IP协议的主机都会接收到这种广播信息，但只有DHCP服务器才会做出响应。</p>
<h4 id="2提供阶段"><a href="#2提供阶段" class="headerlink" title="2提供阶段"></a>2提供阶段</h4><p>即DHCP服务器提供IP地址的阶段。</p>
<p>在网络中接收到DHCP discover发现信息的DHCP服务器做出响应；</p>
<p>从尚未出租的IP地址中挑选一个分配给DHCP客户机；</p>
<p>向DHCP客户机发送一个DHCP offer提供信息广播包。该广播包的源IP地址为DCHP服务器IP，目标IP地址为255.255.255.255，包中还包含提供的IP地址、子网掩码及租期等信息。</p>
<h4 id="3选择阶段"><a href="#3选择阶段" class="headerlink" title="3选择阶段"></a>3选择阶段</h4><p>即DHCP客户机选择某台DHCP服务器提供的IP地址的阶段。</p>
<p>如果有多台DHCP服务器向DHCP客户机发来的DHCP offer提供信息，则DHCP客户机只接受第一个收到的DHCP offer提供信息，然后它就以广播方式回答一个DHCP request请求信息，该信息中包含向它所选定的DHCP服务器请求IP地址的内容。发出的广播，源地址全0，目的地址全1。</p>
<p>之所以要以广播方式回答，是为了通知所有的DHCP服务器，他将选择某台DHCP服务器所提供的IP地址。</p>
<h4 id="4确认阶段"><a href="#4确认阶段" class="headerlink" title="4确认阶段"></a>4确认阶段</h4><p>即DHCP服务器确认所提供的IP地址的阶段。</p>
<p>当DHCP服务器收到客户机的DHCP request请求信息之后，便向DHCP客户机<strong>广播</strong>一个包含它所提供的IP地址和其他设置的DHCP ACK确认信息，告诉DHCP客户机可以使用它所提供的IP地址。</p>
<p>然后DHCP客户机便将其TCP/IP协议与网卡绑定。</p>
<p>除DHCP客户机选中的服务器外，其他的DHCP服务器都将收回曾提供的IP地址。</p>
<h4 id="5重新登录"><a href="#5重新登录" class="headerlink" title="5重新登录"></a>5重新登录</h4><p>以后DHCP客户机每次重新登录网络时，就不需要再发送DHCP discover发现信息了，而是直接发送包含前一次所分配的IP地址的DHCP request请求信息。</p>
<p>当DHCP服务器收到这一信息后，它会尝试让DHCP客户机继续使用原来的IP地址，并回答一个DHCP ACK确认信息。</p>
<p>如果此IP地址已无法再分配给原来的DHCP客户机使用时，则DHCP服务器给DHCP客户机回答一个DHCP NACK否认信息。</p>
<p>当原来的DHCP客户机收到此DHCP NACK否认信息后，它就必须重新发送DHCP discover发现信息来请求新的IP地址。回到1发现阶段</p>
<h4 id="6更新租约"><a href="#6更新租约" class="headerlink" title="6更新租约"></a>6更新租约</h4><p>DHCP服务器向DHCP客户机出租的IP地址一般都有一个租借期限，期满后DHCP服务器便会收回出租的IP地址。</p>
<p>如果DHCP客户机要延长其IP租约，必须更新其IP租约。</p>
<p>DHCP客户机启动时和IP租约期限过一半时，DHCP客户机都会自动向DHCP服务器发送更新其IP租约的信息。若服务器同意，则延长租约；不同意，到期后客户机重新1发现阶段广播。</p>
<h3 id="DHCP中继代理"><a href="#DHCP中继代理" class="headerlink" title="DHCP中继代理"></a>DHCP中继代理</h3><p>并不是每个网络上都有 DHCP 服务器，这样会使 DHCP 服务器的数量太多。现在是每一个网络至少有一个 DHCP 中继代理，它配置了 DHCP 服务器的 IP 地址信息。</p>
<p>当 DHCP 中继代理收到主机发送的发现报文后，就以单播方式向 DHCP 服务器转发此报文，并等待其回答。收到 DHCP 服务器回答的提供报文后，DHCP 中继代理再将此提供报文发回给主机。</p>
<img src="/2022/11/22/net/image-20230201173125701.png" class="" title="image-20230201173125701">



<h2 id="6-6-简单网络管理协议-SNMP"><a href="#6-6-简单网络管理协议-SNMP" class="headerlink" title="6.6 简单网络管理协议 SNMP"></a>6.6 简单网络管理协议 SNMP</h2><p>一 点 也 不 简 单</p>
<p>网络管理包括对硬件、软件和人力的使用、综合与协调，以便对网络资源进行监视、测试、配置、分析、评价和控制，这样就能以合理的价格满足网络的一些需求，如实时运行性能，服务质量等。</p>
<p>网络管理常简称为网管。网络管理并不是指对网络进行行政上的管理。</p>
<img src="/2022/11/22/net/image-20230201173259704.png" class="" title="image-20230201173259704">

<p>不想粘了，看ppt吧</p>
<h2 id="6-7-P2P文件系统"><a href="#6-7-P2P文件系统" class="headerlink" title="6.7 P2P文件系统"></a>6.7 P2P文件系统</h2><h3 id="工作方式概述"><a href="#工作方式概述" class="headerlink" title="工作方式概述"></a>工作方式概述</h3><p>自从互联网能够提供音频/视频服务后，用户数也急剧增长。很多用户使用宽带接入的目的就是为了更快地下载音频/视频文件。</p>
<p>P2P 方式受到广泛欢迎，因为它解决了集中式媒体服务器可能出现的瓶颈问题。</p>
<p>在P2P工作方式下，所有音频/视频文件都在普通的互联网用户之间传输。这相当于有很多分散在各地的媒体服务器向其他用户提供所需要下载的音频/视频文件。</p>
<p>在互联网流量中，P2P工作方式下的文件分发已占据了最大的份额，比万维网应用所占的比例大得多。 </p>
<h3 id="Napster"><a href="#Napster" class="headerlink" title="Napster"></a>Napster</h3><p>集中目录服务器的P2P</p>
<p>第一代P2P系统，提供音乐检索功能。将所有的音乐文件地址集中存放在一个 Napster 目录服务器中，用户要及时向 Napster 的目录服务器报告自己存有的音乐文件。</p>
<p>当用户想下载某个 MP3 文件时，就向目录服务器发出询问。目录服务器检索出结果后向用户返回存放此文件的 PC 机的 IP 地址，用户即可到存放资源的站点下载到所需要的 MP3 文件。</p>
<img src="/2022/11/22/net/image-20230201174027244.png" class="" title="image-20230201174027244">

<p>Napster 的文件传输是分散的，但文件的定位是集中的。</p>
<p>这种集中式目录服务器的优点是：协议简单，查询速度快；<br> 但缺点是：中央服务器易成为单一故障点和性能瓶颈，可靠性和扩展性差。</p>
<p>Napster 被判决属于“间接侵害版权”，因此在 2000 年 7 月底 Napster 网站就被迫关闭了。</p>
<p>Snocap，尝试资源合法化，但免费共享是当时互联网的核心理念。</p>
<h3 id="Gnutella"><a href="#Gnutella" class="headerlink" title="Gnutella"></a>Gnutella</h3><p>全分布式结构的P2P</p>
<img src="/2022/11/22/net/image-20230201174721321.png" class="" title="image-20230201174721321">

<img src="/2022/11/22/net/image-20230201174728332.png" class="" title="image-20230201174728332">

<h3 id="BitTorrent"><a href="#BitTorrent" class="headerlink" title="BitTorrent"></a>BitTorrent</h3><p>2001年，Brahm Cohen开发的第三代P2P程序，混合结构。</p>
<p>参与某个文件分发的所有对等方集合称为一个洪流 (torrent) 。</p>
<p>每个洪流都有一个基础设施结点，叫做追踪器 (Tracer)，当一个对等方加入洪流时，必须向Tracer登记，并且周期的通知Tracer它仍在洪流中。因此， Tracer跟踪了所有的对等方，对所有对等方的信息进行维护。</p>
<p>当一个新的对等方 A 加入洪流时， Tracer就随机地从参与的对等方集合中选择若干个（例如，30 个），并把这些对等方的 IP 地址告诉 A。于是 A 就和这些对等方建立了 TCP 连接。所有与 A 建立了 TCP 连接的对等方为“相邻对等方”(neighboring peers)。</p>
<p>文件发布者生成一个. Torrent文件，即：种子文件（文本文件），包含：Tracer信息（Tracer的地址）和文件相关信息。</p>
<p>下载者B首先需得到种子文件，然后根据种子文件得到Tracer的地址；</p>
<p>B基于TCP与Tracer连接，注册，提供自己的信息，获取其他对等方信息，并且保持与Tracer进行通信，通知自己的在线情况。</p>
<p>B与所获得的其他对等方连接，交互文件片段。并且监听某端口，等待其他对等方与其建立连接，提供文件。</p>
<h3 id="分布式散列表DHT"><a href="#分布式散列表DHT" class="headerlink" title="分布式散列表DHT"></a>分布式散列表DHT</h3><p>有结构的P2P系统</p>
<img src="/2022/11/22/net/image-20230201174852246.png" class="" title="image-20230201174852246">

<img src="/2022/11/22/net/image-20230201174859758.png" class="" title="image-20230201174859758">

<h4 id="Chord算法"><a href="#Chord算法" class="headerlink" title="Chord算法"></a>Chord算法</h4><img src="/2022/11/22/net/image-20230202104842248.png" class="" title="image-20230202104842248">

<p>哈希函数：一般哈希函数，在Chord中使用SHA-1来进行哈希计算。</p>
<p>节点ID：NID（node identifier），一个m位的数字，表示一个对等方，（m要足够大以保证不同节点的NID相同的几率小的可以忽略不计），由节点机器的IP地址和端口号通过哈希得到。</p>
<p>资源ID：KID（key identifiers），一个m位的数字，表示一个资源，（m要足够大以保证不同资源的KID相同的几率足够小），由Key（如：资源名）通过哈希得到。</p>
<p>Chord环：NID和KID被分配到一个大小为2m的环上，用于节点分布和资源分配（分给某一个节点），以及资源定位（注：在这个环上的ID为0–2m-1）。</p>
<p>资源分配：资源被分配到第一个NID&gt;=KID的节点上，这个节点成为k的后继节点，是环上从k起顺时针方向的第一个节点，记为successor(k)。而节点分布则顺时针将节点NID由大到小放在这个环上。</p>
<p>每个节点需维护自己的资源信息、前驱节点指针、后继节点指针。</p>
<img src="/2022/11/22/net/image-20230202110112905.png" class="" title="image-20230202110112905">

<p>节点加入：将部分资源信息移至新节点，更新前驱指针，其原前驱更新后继指针。</p>
<p>资源加入：直接写入对应的节点即可。</p>
<p>节点移出：将资源信息移至后继节点，移除节点的原前驱更新后继指针，原后继更新前驱指针。</p>
<p>资源移出：在原节点删除记录即可。</p>
<h4 id="Chord资源定位"><a href="#Chord资源定位" class="headerlink" title="Chord资源定位"></a>Chord资源定位</h4><img src="/2022/11/22/net/image-20230202110712893.png" class="" title="image-20230202110712893">

<img src="/2022/11/22/net/image-20230202110718446.png" class="" title="image-20230202110718446">

<img src="/2022/11/22/net/image-20230202110725820.png" class="" title="image-20230202110725820">

<ul>
<li>结构化的P2P算法，巧妙分配，快速定位资源。</li>
<li>特征：去中心，有结构，高可用，高伸缩性，负载平衡。</li>
<li>应用广泛：全球文件系统、命名服务、数据库请求处理、互联网级别的数据结构、通信服务、事件通知、文件共享。</li>
<li>作为一种DHT，只能精确匹配。</li>
</ul>
<h4 id="CAN"><a href="#CAN" class="headerlink" title="CAN"></a>CAN</h4><img src="/2022/11/22/net/image-20230202110803146.png" class="" title="image-20230202110803146">

<p>每个节点维护：自己所对应的坐标空间、存放的资源信息、路由表，维系邻居之间的在线情况。</p>
<p>节点的路由表（coordinate routing table），储存坐标空间中相邻节点的IP 地址及所对应的空间信息。</p>
<p>当保存（key, value）时，使用哈希函数将资源key（如：文件名）映射为坐标空间的点P（坐标），将value保存到点P所在区域的节点上。</p>
<p>节点加入：首先，新加入的节点随机的选择系统中的一个节点，并向它发送加入消息；被选择到的节点收到加入消息时，将自己的坐标空间一分为二，分给新节点一半，将value数据库（档案）也分离对应的记录给新节点。</p>
<p>节点离开：将档案交给邻居，和邻居合并为一个大区域，或交给区域最小的邻居。</p>
<p>CAN 利用每个节点所拥有的路由表来搜寻文件。当需要文件查询时，先利用哈希函数计算出此文件所对应的坐标，然后从系统中任意选择一个节点，并将文件所对应的坐标发送给被选择的节点。被选择的节点收到坐标信息后，先查询档案数据是否存在节点中，如果存在，则返回文件信息（地址）；如果不存在，则节点会根据其路由表，按照贪婪算法（找出一个与文件坐标最接近的邻居节点，并转送此查询讯息），依此方式直到找到档案为止。</p>
<p>项目独特之处：采用多维的标识符空间来实现分布式散列算法。 CAN将所有结点映射到一个n维的笛卡尔空间中，并为每个结点尽可能均匀的分配一块区域。无中心、有结构、基于DHT，且具有良好可扩展性。</p>

      </section>

      
      
        <nav class="article-nav">
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2022/11/27/oraclesql/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">oracle数据库</h2>
        </a>
      
      <div class="card-text--row">Newer</div>
    </div>
  </article>
</div>
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
    <div class="card-text">
      
        <a href="/2022/06/26/cscomposition/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">寄组成原理</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="/img/avator.png" class="soft-size--round soft-style--box" alt="STERNE">
    
    
      <h2>STERNE</h2>
    
    
      <p>SDUer，大一入门，大二入土，大三老东西！</p>
    

    <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>59</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        1
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        21
      </div>
    </div>
  </div>
</section>

      

      
<section class="widet-notice widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-notice" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 945.02305225v28.15620663a24.27259221 24.27259221 0 0 1-24.27259221 24.27259335H394.0352a48.54518557 48.54518557 0 0 1-41.74885888-23.78714112l-110.68302222-184.47170332a132.04290333 132.04290333 0 0 1-17.47626667-48.54518557h118.4502511a200.97706667 200.97706667 0 0 1 76.21594113 14.56355556l20.38897777 133.49925888a48.54518557 48.54518557 0 0 0 36.40888888 27.67075555l16.01991111 2.91271112a24.27259221 24.27259221 0 0 1 20.38897778 25.72894889zM997.45185223 463.45481443a194.18074112 194.18074112 0 0 1-38.8361489 116.50844445 24.75804445 24.75804445 0 0 1-36.4088889 0l-34.95253333-34.95253333a24.27259221 24.27259221 0 0 1-2.91271111-30.58346667 97.09036999 97.09036999 0 0 0 0-106.79940665 24.27259221 24.27259221 0 0 1 2.91271111-30.58346666l34.95253333-34.95253334a24.75804445 24.75804445 0 0 1 18.93262223-7.28177777 26.2144 26.2144 0 0 1 17.47626667 9.70903665A194.18074112 194.18074112 0 0 1 997.45185223 463.45481443z m-194.18074112-388.36148111v776.72296335a48.54518557 48.54518557 0 0 1-48.54518556 48.54518443h-28.64165888a48.54518557 48.54518557 0 0 1-33.98163001-14.07810332l-145.63555556-143.20829668A291.27111111 291.27111111 0 0 0 342.57730333 657.63555556H172.18370333a145.63555556 145.63555556 0 0 1-145.63555556-145.63555556v-97.09036999a145.63555556 145.63555556 0 0 1 145.63555556-145.63555556h170.3936a291.27111111 291.27111111 0 0 0 206.31703779-85.43952668l145.63555555-143.20829554a48.54518557 48.54518557 0 0 1 33.98162888-14.07810446H754.72592555a48.54518557 48.54518557 0 0 1 48.54518556 48.54518555z" fill="currentColor"></path>
</svg>
    <span>NOTICE</span>
  </div>
  <div class="widget-body">
    <p>这里还什么都没有呢喵~</p>
  </div>
</section>


      <section class="widget-categorys widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
    <span>CATEGORYS</span>
  </div>
  <div class="widget-body">
    <ul class="categorys-list">
      
        <li class="categorys-list-item">
          <a href="/categories/%E5%B8%AE%E5%8A%A9%E6%96%87%E6%A1%A3/">
            帮助文档 (5)
          </a>
        </li>
      
    </ul>
  </div>
</section>

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>TAGS</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      <a href="/tags/ACM/" style="font-size: 14.44px;" class="tags-cloud-4">ACM</a> <a href="/tags/Arc/" style="font-size: 11.11px;" class="tags-cloud-1">Arc</a> <a href="/tags/CCPC/" style="font-size: 13.33px;" class="tags-cloud-3">CCPC</a> <a href="/tags/HPC/" style="font-size: 10px;" class="tags-cloud-0">HPC</a> <a href="/tags/bot/" style="font-size: 10px;" class="tags-cloud-0">bot</a> <a href="/tags/c/" style="font-size: 12.22px;" class="tags-cloud-2">c</a> <a href="/tags/cpp/" style="font-size: 20px;" class="tags-cloud-10">cpp</a> <a href="/tags/deeplearning/" style="font-size: 15.56px;" class="tags-cloud-6">deeplearning</a> <a href="/tags/games/" style="font-size: 12.22px;" class="tags-cloud-2">games</a> <a href="/tags/hexo/" style="font-size: 11.11px;" class="tags-cloud-1">hexo</a> <a href="/tags/java/" style="font-size: 11.11px;" class="tags-cloud-1">java</a> <a href="/tags/maths/" style="font-size: 10px;" class="tags-cloud-0">maths</a> <a href="/tags/note/" style="font-size: 11.11px;" class="tags-cloud-1">note</a> <a href="/tags/pyqt/" style="font-size: 10px;" class="tags-cloud-0">pyqt</a> <a href="/tags/python/" style="font-size: 17.78px;" class="tags-cloud-8">python</a> <a href="/tags/qt/" style="font-size: 10px;" class="tags-cloud-0">qt</a> <a href="/tags/recommends/" style="font-size: 10px;" class="tags-cloud-0">recommends</a> <a href="/tags/review/" style="font-size: 16.67px;" class="tags-cloud-7">review</a> <a href="/tags/sql/" style="font-size: 18.89px;" class="tags-cloud-9">sql</a> <a href="/tags/srtp/" style="font-size: 10px;" class="tags-cloud-0">srtp</a> <a href="/tags/test/" style="font-size: 10px;" class="tags-cloud-0">test</a>
    </div>
  </div>
</section>
    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
      
        
      
        
      
        
      
        
          <a href="https://github.com/sterne012" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
          <a href="https://twitter.com/sterne012" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-twitter" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M962.285714 233.142857q-38.285714 56-92.571429 95.428571 0.571429 8 0.571429 24 0 74.285714-21.714286 148.285714t-66 142-105.428571 120.285714-147.428571 83.428571-184.571429 31.142857q-154.857143 0-283.428571-82.857143 20 2.285714 44.571429 2.285714 128.571429 0 229.142857-78.857143-60-1.142857-107.428571-36.857143t-65.142857-91.142857q18.857143 2.857143 34.857143 2.857143 24.571429 0 48.571429-6.285714-64-13.142857-106-63.714286t-42-117.428571l0-2.285714q38.857143 21.714286 83.428571 23.428571-37.714286-25.142857-60-65.714286t-22.285714-88q0-50.285714 25.142857-93.142857 69.142857 85.142857 168.285714 136.285714t212.285714 56.857143q-4.571429-21.714286-4.571429-42.285714 0-76.571429 54-130.571429t130.571429-54q80 0 134.857143 58.285714 62.285714-12 117.142857-44.571429-21.142857 65.714286-81.142857 101.714286 53.142857-5.714286 106.285714-28.571429z"></path>
</svg>
          </a>
        
      
    </div>
     
    <p>&copy; 2023 <a href="/" target="_blank">sterne</a></p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">🌞 浅色</a>
      <a href="javascript:;" id="theme-dark">🌛 深色</a>
      <a href="javascript:;" id="theme-auto">🤖️ 自动</a>
    </p>
  </div>
</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
      <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
      <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
    </svg>
  </div>

  
  <!-- aplayer -->


<!-- dplayer -->




  


  


  




<script src="/js/script.js"></script>


  
  <!-- 尾部用户自定义相关内容 -->
</body>
</html>